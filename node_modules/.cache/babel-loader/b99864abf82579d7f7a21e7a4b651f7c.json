{"ast":null,"code":"/*\r\n * xpath.js\r\n *\r\n * An XPath 1.0 library for JavaScript.\r\n *\r\n * Cameron McCormack <cam (at) mcc.id.au>\r\n *\r\n * This work is licensed under the MIT License.\r\n *\r\n * Revision 20: April 26, 2011\r\n *   Fixed a typo resulting in FIRST_ORDERED_NODE_TYPE results being wrong,\r\n *   thanks to <shi_a009 (at) hotmail.com>.\r\n *\r\n * Revision 19: November 29, 2005\r\n *   Nodesets now store their nodes in a height balanced tree, increasing\r\n *   performance for the common case of selecting nodes in document order,\r\n *   thanks to S閎astien Cramatte <contact (at) zeninteractif.com>.\r\n *   AVL tree code adapted from Raimund Neumann <rnova (at) gmx.net>.\r\n *\r\n * Revision 18: October 27, 2005\r\n *   DOM 3 XPath support.  Caveats:\r\n *     - namespace prefixes aren't resolved in XPathEvaluator.createExpression,\r\n *       but in XPathExpression.evaluate.\r\n *     - XPathResult.invalidIteratorState is not implemented.\r\n *\r\n * Revision 17: October 25, 2005\r\n *   Some core XPath function fixes and a patch to avoid crashing certain\r\n *   versions of MSXML in PathExpr.prototype.getOwnerElement, thanks to\r\n *   S閎astien Cramatte <contact (at) zeninteractif.com>.\r\n *\r\n * Revision 16: September 22, 2005\r\n *   Workarounds for some IE 5.5 deficiencies.\r\n *   Fixed problem with prefix node tests on attribute nodes.\r\n *\r\n * Revision 15: May 21, 2005\r\n *   Fixed problem with QName node tests on elements with an xmlns=\"...\".\r\n *\r\n * Revision 14: May 19, 2005\r\n *   Fixed QName node tests on attribute node regression.\r\n *\r\n * Revision 13: May 3, 2005\r\n *   Node tests are case insensitive now if working in an HTML DOM.\r\n *\r\n * Revision 12: April 26, 2005\r\n *   Updated licence.  Slight code changes to enable use of Dean\r\n *   Edwards' script compression, http://dean.edwards.name/packer/ .\r\n *\r\n * Revision 11: April 23, 2005\r\n *   Fixed bug with 'and' and 'or' operators, fix thanks to\r\n *   Sandy McArthur <sandy (at) mcarthur.org>.\r\n *\r\n * Revision 10: April 15, 2005\r\n *   Added support for a virtual root node, supposedly helpful for\r\n *   implementing XForms.  Fixed problem with QName node tests and\r\n *   the parent axis.\r\n *\r\n * Revision 9: March 17, 2005\r\n *   Namespace resolver tweaked so using the document node as the context\r\n *   for namespace lookups is equivalent to using the document element.\r\n *\r\n * Revision 8: February 13, 2005\r\n *   Handle implicit declaration of 'xmlns' namespace prefix.\r\n *   Fixed bug when comparing nodesets.\r\n *   Instance data can now be associated with a FunctionResolver, and\r\n *     workaround for MSXML not supporting 'localName' and 'getElementById',\r\n *     thanks to Grant Gongaware.\r\n *   Fix a few problems when the context node is the root node.\r\n *\r\n * Revision 7: February 11, 2005\r\n *   Default namespace resolver fix from Grant Gongaware\r\n *   <grant (at) gongaware.com>.\r\n *\r\n * Revision 6: February 10, 2005\r\n *   Fixed bug in 'number' function.\r\n *\r\n * Revision 5: February 9, 2005\r\n *   Fixed bug where text nodes not getting converted to string values.\r\n *\r\n * Revision 4: January 21, 2005\r\n *   Bug in 'name' function, fix thanks to Bill Edney.\r\n *   Fixed incorrect processing of namespace nodes.\r\n *   Fixed NamespaceResolver to resolve 'xml' namespace.\r\n *   Implemented union '|' operator.\r\n *\r\n * Revision 3: January 14, 2005\r\n *   Fixed bug with nodeset comparisons, bug lexing < and >.\r\n *\r\n * Revision 2: October 26, 2004\r\n *   QName node test namespace handling fixed.  Few other bug fixes.\r\n *\r\n * Revision 1: August 13, 2004\r\n *   Bug fixes from William J. Edney <bedney (at) technicalpursuit.com>.\r\n *   Added minimal licence.\r\n *\r\n * Initial version: June 14, 2004\r\n */\n// non-node wrapper\nvar xpath = typeof exports === 'undefined' ? {} : exports;\n\n(function (exports) {\n  \"use strict\"; // functional helpers\n\n  function curry(func) {\n    var slice = Array.prototype.slice,\n        totalargs = func.length,\n        partial = function partial(args, fn) {\n      return function () {\n        return fn.apply(this, args.concat(slice.call(arguments)));\n      };\n    },\n        fn = function fn() {\n      var args = slice.call(arguments);\n      return args.length < totalargs ? partial(args, fn) : func.apply(this, slice.apply(arguments, [0, totalargs]));\n    };\n\n    return fn;\n  }\n\n  var forEach = curry(function (f, xs) {\n    for (var i = 0; i < xs.length; i += 1) {\n      f(xs[i], i, xs);\n    }\n  });\n  var reduce = curry(function (f, seed, xs) {\n    var acc = seed;\n    forEach(function (x, i) {\n      acc = f(acc, x, i);\n    }, xs);\n    return acc;\n  });\n  var map = curry(function (f, xs) {\n    var mapped = new Array(xs.length);\n    forEach(function (x, i) {\n      mapped[i] = f(x);\n    }, xs);\n    return mapped;\n  });\n  var filter = curry(function (f, xs) {\n    var filtered = [];\n    forEach(function (x, i) {\n      if (f(x, i)) {\n        filtered.push(x);\n      }\n    }, xs);\n    return filtered;\n  });\n\n  function compose() {\n    if (arguments.length === 0) {\n      throw new Error('compose requires at least one argument');\n    }\n\n    var funcs = Array.prototype.slice.call(arguments).reverse();\n    var f0 = funcs[0];\n    var fRem = funcs.slice(1);\n    return function () {\n      return reduce(function (acc, next) {\n        return next(acc);\n      }, f0.apply(null, arguments), fRem);\n    };\n  }\n\n  var includes = curry(function (values, value) {\n    for (var i = 0; i < values.length; i += 1) {\n      if (values[i] === value) {\n        return true;\n      }\n    }\n\n    return false;\n  });\n\n  function always(value) {\n    return function () {\n      return value;\n    };\n  }\n\n  var prop = curry(function (name, obj) {\n    return obj[name];\n  });\n\n  function toString(x) {\n    return x.toString();\n  }\n\n  var join = curry(function (s, xs) {\n    return xs.join(s);\n  });\n  var wrap = curry(function (pref, suf, str) {\n    return pref + str + suf;\n  });\n\n  function assign(target) {\n    // .length of function is 2\n    var to = Object(target);\n\n    for (var index = 1; index < arguments.length; index++) {\n      var nextSource = arguments[index];\n\n      if (nextSource != null) {\n        // Skip over if undefined or null\n        for (var nextKey in nextSource) {\n          // Avoid bugs when hasOwnProperty is shadowed\n          if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\n            to[nextKey] = nextSource[nextKey];\n          }\n        }\n      }\n    }\n\n    return to;\n  } // XPathParser ///////////////////////////////////////////////////////////////\n\n\n  XPathParser.prototype = new Object();\n  XPathParser.prototype.constructor = XPathParser;\n  XPathParser.superclass = Object.prototype;\n\n  function XPathParser() {\n    this.init();\n  }\n\n  XPathParser.prototype.init = function () {\n    this.reduceActions = [];\n\n    this.reduceActions[3] = function (rhs) {\n      return new OrOperation(rhs[0], rhs[2]);\n    };\n\n    this.reduceActions[5] = function (rhs) {\n      return new AndOperation(rhs[0], rhs[2]);\n    };\n\n    this.reduceActions[7] = function (rhs) {\n      return new EqualsOperation(rhs[0], rhs[2]);\n    };\n\n    this.reduceActions[8] = function (rhs) {\n      return new NotEqualOperation(rhs[0], rhs[2]);\n    };\n\n    this.reduceActions[10] = function (rhs) {\n      return new LessThanOperation(rhs[0], rhs[2]);\n    };\n\n    this.reduceActions[11] = function (rhs) {\n      return new GreaterThanOperation(rhs[0], rhs[2]);\n    };\n\n    this.reduceActions[12] = function (rhs) {\n      return new LessThanOrEqualOperation(rhs[0], rhs[2]);\n    };\n\n    this.reduceActions[13] = function (rhs) {\n      return new GreaterThanOrEqualOperation(rhs[0], rhs[2]);\n    };\n\n    this.reduceActions[15] = function (rhs) {\n      return new PlusOperation(rhs[0], rhs[2]);\n    };\n\n    this.reduceActions[16] = function (rhs) {\n      return new MinusOperation(rhs[0], rhs[2]);\n    };\n\n    this.reduceActions[18] = function (rhs) {\n      return new MultiplyOperation(rhs[0], rhs[2]);\n    };\n\n    this.reduceActions[19] = function (rhs) {\n      return new DivOperation(rhs[0], rhs[2]);\n    };\n\n    this.reduceActions[20] = function (rhs) {\n      return new ModOperation(rhs[0], rhs[2]);\n    };\n\n    this.reduceActions[22] = function (rhs) {\n      return new UnaryMinusOperation(rhs[1]);\n    };\n\n    this.reduceActions[24] = function (rhs) {\n      return new BarOperation(rhs[0], rhs[2]);\n    };\n\n    this.reduceActions[25] = function (rhs) {\n      return new PathExpr(undefined, undefined, rhs[0]);\n    };\n\n    this.reduceActions[27] = function (rhs) {\n      rhs[0].locationPath = rhs[2];\n      return rhs[0];\n    };\n\n    this.reduceActions[28] = function (rhs) {\n      rhs[0].locationPath = rhs[2];\n      rhs[0].locationPath.steps.unshift(new Step(Step.DESCENDANTORSELF, NodeTest.nodeTest, []));\n      return rhs[0];\n    };\n\n    this.reduceActions[29] = function (rhs) {\n      return new PathExpr(rhs[0], [], undefined);\n    };\n\n    this.reduceActions[30] = function (rhs) {\n      if (Utilities.instance_of(rhs[0], PathExpr)) {\n        if (rhs[0].filterPredicates == undefined) {\n          rhs[0].filterPredicates = [];\n        }\n\n        rhs[0].filterPredicates.push(rhs[1]);\n        return rhs[0];\n      } else {\n        return new PathExpr(rhs[0], [rhs[1]], undefined);\n      }\n    };\n\n    this.reduceActions[32] = function (rhs) {\n      return rhs[1];\n    };\n\n    this.reduceActions[33] = function (rhs) {\n      return new XString(rhs[0]);\n    };\n\n    this.reduceActions[34] = function (rhs) {\n      return new XNumber(rhs[0]);\n    };\n\n    this.reduceActions[36] = function (rhs) {\n      return new FunctionCall(rhs[0], []);\n    };\n\n    this.reduceActions[37] = function (rhs) {\n      return new FunctionCall(rhs[0], rhs[2]);\n    };\n\n    this.reduceActions[38] = function (rhs) {\n      return [rhs[0]];\n    };\n\n    this.reduceActions[39] = function (rhs) {\n      rhs[2].unshift(rhs[0]);\n      return rhs[2];\n    };\n\n    this.reduceActions[43] = function (rhs) {\n      return new LocationPath(true, []);\n    };\n\n    this.reduceActions[44] = function (rhs) {\n      rhs[1].absolute = true;\n      return rhs[1];\n    };\n\n    this.reduceActions[46] = function (rhs) {\n      return new LocationPath(false, [rhs[0]]);\n    };\n\n    this.reduceActions[47] = function (rhs) {\n      rhs[0].steps.push(rhs[2]);\n      return rhs[0];\n    };\n\n    this.reduceActions[49] = function (rhs) {\n      return new Step(rhs[0], rhs[1], []);\n    };\n\n    this.reduceActions[50] = function (rhs) {\n      return new Step(Step.CHILD, rhs[0], []);\n    };\n\n    this.reduceActions[51] = function (rhs) {\n      return new Step(rhs[0], rhs[1], rhs[2]);\n    };\n\n    this.reduceActions[52] = function (rhs) {\n      return new Step(Step.CHILD, rhs[0], rhs[1]);\n    };\n\n    this.reduceActions[54] = function (rhs) {\n      return [rhs[0]];\n    };\n\n    this.reduceActions[55] = function (rhs) {\n      rhs[1].unshift(rhs[0]);\n      return rhs[1];\n    };\n\n    this.reduceActions[56] = function (rhs) {\n      if (rhs[0] == \"ancestor\") {\n        return Step.ANCESTOR;\n      } else if (rhs[0] == \"ancestor-or-self\") {\n        return Step.ANCESTORORSELF;\n      } else if (rhs[0] == \"attribute\") {\n        return Step.ATTRIBUTE;\n      } else if (rhs[0] == \"child\") {\n        return Step.CHILD;\n      } else if (rhs[0] == \"descendant\") {\n        return Step.DESCENDANT;\n      } else if (rhs[0] == \"descendant-or-self\") {\n        return Step.DESCENDANTORSELF;\n      } else if (rhs[0] == \"following\") {\n        return Step.FOLLOWING;\n      } else if (rhs[0] == \"following-sibling\") {\n        return Step.FOLLOWINGSIBLING;\n      } else if (rhs[0] == \"namespace\") {\n        return Step.NAMESPACE;\n      } else if (rhs[0] == \"parent\") {\n        return Step.PARENT;\n      } else if (rhs[0] == \"preceding\") {\n        return Step.PRECEDING;\n      } else if (rhs[0] == \"preceding-sibling\") {\n        return Step.PRECEDINGSIBLING;\n      } else if (rhs[0] == \"self\") {\n        return Step.SELF;\n      }\n\n      return -1;\n    };\n\n    this.reduceActions[57] = function (rhs) {\n      return Step.ATTRIBUTE;\n    };\n\n    this.reduceActions[59] = function (rhs) {\n      if (rhs[0] == \"comment\") {\n        return NodeTest.commentTest;\n      } else if (rhs[0] == \"text\") {\n        return NodeTest.textTest;\n      } else if (rhs[0] == \"processing-instruction\") {\n        return NodeTest.anyPiTest;\n      } else if (rhs[0] == \"node\") {\n        return NodeTest.nodeTest;\n      }\n\n      return new NodeTest(-1, undefined);\n    };\n\n    this.reduceActions[60] = function (rhs) {\n      return new NodeTest.PITest(rhs[2]);\n    };\n\n    this.reduceActions[61] = function (rhs) {\n      return rhs[1];\n    };\n\n    this.reduceActions[63] = function (rhs) {\n      rhs[1].absolute = true;\n      rhs[1].steps.unshift(new Step(Step.DESCENDANTORSELF, NodeTest.nodeTest, []));\n      return rhs[1];\n    };\n\n    this.reduceActions[64] = function (rhs) {\n      rhs[0].steps.push(new Step(Step.DESCENDANTORSELF, NodeTest.nodeTest, []));\n      rhs[0].steps.push(rhs[2]);\n      return rhs[0];\n    };\n\n    this.reduceActions[65] = function (rhs) {\n      return new Step(Step.SELF, NodeTest.nodeTest, []);\n    };\n\n    this.reduceActions[66] = function (rhs) {\n      return new Step(Step.PARENT, NodeTest.nodeTest, []);\n    };\n\n    this.reduceActions[67] = function (rhs) {\n      return new VariableReference(rhs[1]);\n    };\n\n    this.reduceActions[68] = function (rhs) {\n      return NodeTest.nameTestAny;\n    };\n\n    this.reduceActions[69] = function (rhs) {\n      return new NodeTest.NameTestPrefixAny(rhs[0].split(':')[0]);\n    };\n\n    this.reduceActions[70] = function (rhs) {\n      return new NodeTest.NameTestQName(rhs[0]);\n    };\n  };\n\n  XPathParser.actionTable = [\" s s        sssssssss    s ss  s  ss\", \"                 s                  \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"                rrrrr               \", \" s s        sssssssss    s ss  s  ss\", \"rs  rrrrrrrr s  sssssrrrrrr  rrs rs \", \" s s        sssssssss    s ss  s  ss\", \"                            s       \", \"                            s       \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"  s                                 \", \"                            s       \", \" s           s  sssss          s  s \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"a                                   \", \"r       s                    rr  r  \", \"r      sr                    rr  r  \", \"r   s  rr            s       rr  r  \", \"r   rssrr            rss     rr  r  \", \"r   rrrrr            rrrss   rr  r  \", \"r   rrrrrsss         rrrrr   rr  r  \", \"r   rrrrrrrr         rrrrr   rr  r  \", \"r   rrrrrrrr         rrrrrs  rr  r  \", \"r   rrrrrrrr         rrrrrr  rr  r  \", \"r   rrrrrrrr         rrrrrr  rr  r  \", \"r  srrrrrrrr         rrrrrrs rr sr  \", \"r  srrrrrrrr         rrrrrrs rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r   rrrrrrrr         rrrrrr  rr  r  \", \"r   rrrrrrrr         rrrrrr  rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"                sssss               \", \"r  rrrrrrrrr         rrrrrrr rr sr  \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"                             s      \", \"r  srrrrrrrr         rrrrrrs rr  r  \", \"r   rrrrrrrr         rrrrr   rr  r  \", \"              s                     \", \"                             s      \", \"                rrrrr               \", \" s s        sssssssss    s sss s  ss\", \"r  srrrrrrrr         rrrrrrs rr  r  \", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s s        sssssssss      ss  s  ss\", \" s s        sssssssss    s ss  s  ss\", \" s           s  sssss          s  s \", \" s           s  sssss          s  s \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \" s           s  sssss          s  s \", \" s           s  sssss          s  s \", \"r  rrrrrrrrr         rrrrrrr rr sr  \", \"r  rrrrrrrrr         rrrrrrr rr sr  \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"                             s      \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"                             rr     \", \"                             s      \", \"                             rs     \", \"r      sr                    rr  r  \", \"r   s  rr            s       rr  r  \", \"r   rssrr            rss     rr  r  \", \"r   rssrr            rss     rr  r  \", \"r   rrrrr            rrrss   rr  r  \", \"r   rrrrr            rrrss   rr  r  \", \"r   rrrrr            rrrss   rr  r  \", \"r   rrrrr            rrrss   rr  r  \", \"r   rrrrrsss         rrrrr   rr  r  \", \"r   rrrrrsss         rrrrr   rr  r  \", \"r   rrrrrrrr         rrrrr   rr  r  \", \"r   rrrrrrrr         rrrrr   rr  r  \", \"r   rrrrrrrr         rrrrr   rr  r  \", \"r   rrrrrrrr         rrrrrr  rr  r  \", \"                                 r  \", \"                                 s  \", \"r  srrrrrrrr         rrrrrrs rr  r  \", \"r  srrrrrrrr         rrrrrrs rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr  r  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \" s s        sssssssss    s ss  s  ss\", \"r  rrrrrrrrr         rrrrrrr rr rr  \", \"                             r      \"];\n  XPathParser.actionTableNumber = [\" 1 0        /.-,+*)('    & %$  #  \\\"!\", \"                 J                  \", \"a  aaaaaaaaa         aaaaaaa aa  a  \", \"                YYYYY               \", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \"K1  KKKKKKKK .  +*)('KKKKKK  KK# K\\\" \", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \"                            N       \", \"                            O       \", \"e  eeeeeeeee         eeeeeee ee ee  \", \"f  fffffffff         fffffff ff ff  \", \"d  ddddddddd         ddddddd dd dd  \", \"B  BBBBBBBBB         BBBBBBB BB BB  \", \"A  AAAAAAAAA         AAAAAAA AA AA  \", \"  P                                 \", \"                            Q       \", \" 1           .  +*)('          #  \\\" \", \"b  bbbbbbbbb         bbbbbbb bb  b  \", \"                                    \", \"!       S                    !!  !  \", \"\\\"      T\\\"                    \\\"\\\"  \\\"  \", \"$   V  $$            U       $$  $  \", \"&   &ZY&&            &XW     &&  &  \", \")   )))))            )))\\\\[   ))  )  \", \".   ....._^]         .....   ..  .  \", \"1   11111111         11111   11  1  \", \"5   55555555         55555`  55  5  \", \"7   77777777         777777  77  7  \", \"9   99999999         999999  99  9  \", \":  c::::::::         ::::::b :: a:  \", \"I  fIIIIIIII         IIIIIIe II  I  \", \"=  =========         ======= == ==  \", \"?  ?????????         ??????? ?? ??  \", \"C  CCCCCCCCC         CCCCCCC CC CC  \", \"J   JJJJJJJJ         JJJJJJ  JJ  J  \", \"M   MMMMMMMM         MMMMMM  MM  M  \", \"N  NNNNNNNNN         NNNNNNN NN  N  \", \"P  PPPPPPPPP         PPPPPPP PP  P  \", \"                +*)('               \", \"R  RRRRRRRRR         RRRRRRR RR aR  \", \"U  UUUUUUUUU         UUUUUUU UU  U  \", \"Z  ZZZZZZZZZ         ZZZZZZZ ZZ ZZ  \", \"c  ccccccccc         ccccccc cc cc  \", \"                             j      \", \"L  fLLLLLLLL         LLLLLLe LL  L  \", \"6   66666666         66666   66  6  \", \"              k                     \", \"                             l      \", \"                XXXXX               \", \" 1 0        /.-,+*)('    & %$m #  \\\"!\", \"_  f________         ______e __  _  \", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1 0        /.-,+*)('      %$  #  \\\"!\", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \" 1           .  +*)('          #  \\\" \", \" 1           .  +*)('          #  \\\" \", \">  >>>>>>>>>         >>>>>>> >> >>  \", \" 1           .  +*)('          #  \\\" \", \" 1           .  +*)('          #  \\\" \", \"Q  QQQQQQQQQ         QQQQQQQ QQ aQ  \", \"V  VVVVVVVVV         VVVVVVV VV aV  \", \"T  TTTTTTTTT         TTTTTTT TT  T  \", \"@  @@@@@@@@@         @@@@@@@ @@ @@  \", \"                             \\x87      \", \"[  [[[[[[[[[         [[[[[[[ [[ [[  \", \"D  DDDDDDDDD         DDDDDDD DD DD  \", \"                             HH     \", \"                             \\x88      \", \"                             F\\x89     \", \"#      T#                    ##  #  \", \"%   V  %%            U       %%  %  \", \"'   'ZY''            'XW     ''  '  \", \"(   (ZY((            (XW     ((  (  \", \"+   +++++            +++\\\\[   ++  +  \", \"*   *****            ***\\\\[   **  *  \", \"-   -----            ---\\\\[   --  -  \", \",   ,,,,,            ,,,\\\\[   ,,  ,  \", \"0   00000_^]         00000   00  0  \", \"/   /////_^]         /////   //  /  \", \"2   22222222         22222   22  2  \", \"3   33333333         33333   33  3  \", \"4   44444444         44444   44  4  \", \"8   88888888         888888  88  8  \", \"                                 ^  \", \"                                 \\x8a  \", \";  f;;;;;;;;         ;;;;;;e ;;  ;  \", \"<  f<<<<<<<<         <<<<<<e <<  <  \", \"O  OOOOOOOOO         OOOOOOO OO  O  \", \"`  `````````         ``````` ``  `  \", \"S  SSSSSSSSS         SSSSSSS SS  S  \", \"W  WWWWWWWWW         WWWWWWW WW  W  \", \"\\\\  \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\         \\\\\\\\\\\\\\\\\\\\\\\\\\\\ \\\\\\\\ \\\\\\\\  \", \"E  EEEEEEEEE         EEEEEEE EE EE  \", \" 1 0        /.-,+*)('    & %$  #  \\\"!\", \"]  ]]]]]]]]]         ]]]]]]] ]] ]]  \", \"                             G      \"];\n  XPathParser.gotoTable = [\"3456789:;<=>?@ AB  CDEFGH IJ \", \"                             \", \"                             \", \"                             \", \"L456789:;<=>?@ AB  CDEFGH IJ \", \"            M        EFGH IJ \", \"       N;<=>?@ AB  CDEFGH IJ \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"            S        EFGH IJ \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"              e              \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                        h  J \", \"              i          j   \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"o456789:;<=>?@ ABpqCDEFGH IJ \", \"                             \", \"  r6789:;<=>?@ AB  CDEFGH IJ \", \"   s789:;<=>?@ AB  CDEFGH IJ \", \"    t89:;<=>?@ AB  CDEFGH IJ \", \"    u89:;<=>?@ AB  CDEFGH IJ \", \"     v9:;<=>?@ AB  CDEFGH IJ \", \"     w9:;<=>?@ AB  CDEFGH IJ \", \"     x9:;<=>?@ AB  CDEFGH IJ \", \"     y9:;<=>?@ AB  CDEFGH IJ \", \"      z:;<=>?@ AB  CDEFGH IJ \", \"      {:;<=>?@ AB  CDEFGH IJ \", \"       |;<=>?@ AB  CDEFGH IJ \", \"       };<=>?@ AB  CDEFGH IJ \", \"       ~;<=>?@ AB  CDEFGH IJ \", \"         \\x7f=>?@ AB  CDEFGH IJ \", \"\\x80456789:;<=>?@ AB  CDEFGH IJ\\x81\", \"            \\x82        EFGH IJ \", \"            \\x83        EFGH IJ \", \"                             \", \"                     \\x84 GH IJ \", \"                     \\x85 GH IJ \", \"              i          \\x86   \", \"              i          \\x87   \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"                             \", \"o456789:;<=>?@ AB\\x8cqCDEFGH IJ \", \"                             \", \"                             \"];\n  XPathParser.productions = [[1, 1, 2], [2, 1, 3], [3, 1, 4], [3, 3, 3, -9, 4], [4, 1, 5], [4, 3, 4, -8, 5], [5, 1, 6], [5, 3, 5, -22, 6], [5, 3, 5, -5, 6], [6, 1, 7], [6, 3, 6, -23, 7], [6, 3, 6, -24, 7], [6, 3, 6, -6, 7], [6, 3, 6, -7, 7], [7, 1, 8], [7, 3, 7, -25, 8], [7, 3, 7, -26, 8], [8, 1, 9], [8, 3, 8, -12, 9], [8, 3, 8, -11, 9], [8, 3, 8, -10, 9], [9, 1, 10], [9, 2, -26, 9], [10, 1, 11], [10, 3, 10, -27, 11], [11, 1, 12], [11, 1, 13], [11, 3, 13, -28, 14], [11, 3, 13, -4, 14], [13, 1, 15], [13, 2, 13, 16], [15, 1, 17], [15, 3, -29, 2, -30], [15, 1, -15], [15, 1, -16], [15, 1, 18], [18, 3, -13, -29, -30], [18, 4, -13, -29, 19, -30], [19, 1, 20], [19, 3, 20, -31, 19], [20, 1, 2], [12, 1, 14], [12, 1, 21], [21, 1, -28], [21, 2, -28, 14], [21, 1, 22], [14, 1, 23], [14, 3, 14, -28, 23], [14, 1, 24], [23, 2, 25, 26], [23, 1, 26], [23, 3, 25, 26, 27], [23, 2, 26, 27], [23, 1, 28], [27, 1, 16], [27, 2, 16, 27], [25, 2, -14, -3], [25, 1, -32], [26, 1, 29], [26, 3, -20, -29, -30], [26, 4, -21, -29, -15, -30], [16, 3, -33, 30, -34], [30, 1, 2], [22, 2, -4, 14], [24, 3, 14, -4, 23], [28, 1, -35], [28, 1, -2], [17, 2, -36, -18], [29, 1, -17], [29, 1, -19], [29, 1, -18]];\n  XPathParser.DOUBLEDOT = 2;\n  XPathParser.DOUBLECOLON = 3;\n  XPathParser.DOUBLESLASH = 4;\n  XPathParser.NOTEQUAL = 5;\n  XPathParser.LESSTHANOREQUAL = 6;\n  XPathParser.GREATERTHANOREQUAL = 7;\n  XPathParser.AND = 8;\n  XPathParser.OR = 9;\n  XPathParser.MOD = 10;\n  XPathParser.DIV = 11;\n  XPathParser.MULTIPLYOPERATOR = 12;\n  XPathParser.FUNCTIONNAME = 13;\n  XPathParser.AXISNAME = 14;\n  XPathParser.LITERAL = 15;\n  XPathParser.NUMBER = 16;\n  XPathParser.ASTERISKNAMETEST = 17;\n  XPathParser.QNAME = 18;\n  XPathParser.NCNAMECOLONASTERISK = 19;\n  XPathParser.NODETYPE = 20;\n  XPathParser.PROCESSINGINSTRUCTIONWITHLITERAL = 21;\n  XPathParser.EQUALS = 22;\n  XPathParser.LESSTHAN = 23;\n  XPathParser.GREATERTHAN = 24;\n  XPathParser.PLUS = 25;\n  XPathParser.MINUS = 26;\n  XPathParser.BAR = 27;\n  XPathParser.SLASH = 28;\n  XPathParser.LEFTPARENTHESIS = 29;\n  XPathParser.RIGHTPARENTHESIS = 30;\n  XPathParser.COMMA = 31;\n  XPathParser.AT = 32;\n  XPathParser.LEFTBRACKET = 33;\n  XPathParser.RIGHTBRACKET = 34;\n  XPathParser.DOT = 35;\n  XPathParser.DOLLAR = 36;\n\n  XPathParser.prototype.tokenize = function (s1) {\n    var types = [];\n    var values = [];\n    var s = s1 + '\\0';\n    var pos = 0;\n    var c = s.charAt(pos++);\n\n    while (1) {\n      while (c == ' ' || c == '\\t' || c == '\\r' || c == '\\n') {\n        c = s.charAt(pos++);\n      }\n\n      if (c == '\\0' || pos >= s.length) {\n        break;\n      }\n\n      if (c == '(') {\n        types.push(XPathParser.LEFTPARENTHESIS);\n        values.push(c);\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      if (c == ')') {\n        types.push(XPathParser.RIGHTPARENTHESIS);\n        values.push(c);\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      if (c == '[') {\n        types.push(XPathParser.LEFTBRACKET);\n        values.push(c);\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      if (c == ']') {\n        types.push(XPathParser.RIGHTBRACKET);\n        values.push(c);\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      if (c == '@') {\n        types.push(XPathParser.AT);\n        values.push(c);\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      if (c == ',') {\n        types.push(XPathParser.COMMA);\n        values.push(c);\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      if (c == '|') {\n        types.push(XPathParser.BAR);\n        values.push(c);\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      if (c == '+') {\n        types.push(XPathParser.PLUS);\n        values.push(c);\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      if (c == '-') {\n        types.push(XPathParser.MINUS);\n        values.push(c);\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      if (c == '=') {\n        types.push(XPathParser.EQUALS);\n        values.push(c);\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      if (c == '$') {\n        types.push(XPathParser.DOLLAR);\n        values.push(c);\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      if (c == '.') {\n        c = s.charAt(pos++);\n\n        if (c == '.') {\n          types.push(XPathParser.DOUBLEDOT);\n          values.push(\"..\");\n          c = s.charAt(pos++);\n          continue;\n        }\n\n        if (c >= '0' && c <= '9') {\n          var number = \".\" + c;\n          c = s.charAt(pos++);\n\n          while (c >= '0' && c <= '9') {\n            number += c;\n            c = s.charAt(pos++);\n          }\n\n          types.push(XPathParser.NUMBER);\n          values.push(number);\n          continue;\n        }\n\n        types.push(XPathParser.DOT);\n        values.push('.');\n        continue;\n      }\n\n      if (c == '\\'' || c == '\"') {\n        var delimiter = c;\n        var literal = \"\";\n\n        while (pos < s.length && (c = s.charAt(pos)) !== delimiter) {\n          literal += c;\n          pos += 1;\n        }\n\n        if (c !== delimiter) {\n          throw XPathException.fromMessage(\"Unterminated string literal: \" + delimiter + literal);\n        }\n\n        pos += 1;\n        types.push(XPathParser.LITERAL);\n        values.push(literal);\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      if (c >= '0' && c <= '9') {\n        var number = c;\n        c = s.charAt(pos++);\n\n        while (c >= '0' && c <= '9') {\n          number += c;\n          c = s.charAt(pos++);\n        }\n\n        if (c == '.') {\n          if (s.charAt(pos) >= '0' && s.charAt(pos) <= '9') {\n            number += c;\n            number += s.charAt(pos++);\n            c = s.charAt(pos++);\n\n            while (c >= '0' && c <= '9') {\n              number += c;\n              c = s.charAt(pos++);\n            }\n          }\n        }\n\n        types.push(XPathParser.NUMBER);\n        values.push(number);\n        continue;\n      }\n\n      if (c == '*') {\n        if (types.length > 0) {\n          var last = types[types.length - 1];\n\n          if (last != XPathParser.AT && last != XPathParser.DOUBLECOLON && last != XPathParser.LEFTPARENTHESIS && last != XPathParser.LEFTBRACKET && last != XPathParser.AND && last != XPathParser.OR && last != XPathParser.MOD && last != XPathParser.DIV && last != XPathParser.MULTIPLYOPERATOR && last != XPathParser.SLASH && last != XPathParser.DOUBLESLASH && last != XPathParser.BAR && last != XPathParser.PLUS && last != XPathParser.MINUS && last != XPathParser.EQUALS && last != XPathParser.NOTEQUAL && last != XPathParser.LESSTHAN && last != XPathParser.LESSTHANOREQUAL && last != XPathParser.GREATERTHAN && last != XPathParser.GREATERTHANOREQUAL) {\n            types.push(XPathParser.MULTIPLYOPERATOR);\n            values.push(c);\n            c = s.charAt(pos++);\n            continue;\n          }\n        }\n\n        types.push(XPathParser.ASTERISKNAMETEST);\n        values.push(c);\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      if (c == ':') {\n        if (s.charAt(pos) == ':') {\n          types.push(XPathParser.DOUBLECOLON);\n          values.push(\"::\");\n          pos++;\n          c = s.charAt(pos++);\n          continue;\n        }\n      }\n\n      if (c == '/') {\n        c = s.charAt(pos++);\n\n        if (c == '/') {\n          types.push(XPathParser.DOUBLESLASH);\n          values.push(\"//\");\n          c = s.charAt(pos++);\n          continue;\n        }\n\n        types.push(XPathParser.SLASH);\n        values.push('/');\n        continue;\n      }\n\n      if (c == '!') {\n        if (s.charAt(pos) == '=') {\n          types.push(XPathParser.NOTEQUAL);\n          values.push(\"!=\");\n          pos++;\n          c = s.charAt(pos++);\n          continue;\n        }\n      }\n\n      if (c == '<') {\n        if (s.charAt(pos) == '=') {\n          types.push(XPathParser.LESSTHANOREQUAL);\n          values.push(\"<=\");\n          pos++;\n          c = s.charAt(pos++);\n          continue;\n        }\n\n        types.push(XPathParser.LESSTHAN);\n        values.push('<');\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      if (c == '>') {\n        if (s.charAt(pos) == '=') {\n          types.push(XPathParser.GREATERTHANOREQUAL);\n          values.push(\">=\");\n          pos++;\n          c = s.charAt(pos++);\n          continue;\n        }\n\n        types.push(XPathParser.GREATERTHAN);\n        values.push('>');\n        c = s.charAt(pos++);\n        continue;\n      }\n\n      if (c == '_' || Utilities.isLetter(c.charCodeAt(0))) {\n        var name = c;\n        c = s.charAt(pos++);\n\n        while (Utilities.isNCNameChar(c.charCodeAt(0))) {\n          name += c;\n          c = s.charAt(pos++);\n        }\n\n        if (types.length > 0) {\n          var last = types[types.length - 1];\n\n          if (last != XPathParser.AT && last != XPathParser.DOUBLECOLON && last != XPathParser.LEFTPARENTHESIS && last != XPathParser.LEFTBRACKET && last != XPathParser.AND && last != XPathParser.OR && last != XPathParser.MOD && last != XPathParser.DIV && last != XPathParser.MULTIPLYOPERATOR && last != XPathParser.SLASH && last != XPathParser.DOUBLESLASH && last != XPathParser.BAR && last != XPathParser.PLUS && last != XPathParser.MINUS && last != XPathParser.EQUALS && last != XPathParser.NOTEQUAL && last != XPathParser.LESSTHAN && last != XPathParser.LESSTHANOREQUAL && last != XPathParser.GREATERTHAN && last != XPathParser.GREATERTHANOREQUAL) {\n            if (name == \"and\") {\n              types.push(XPathParser.AND);\n              values.push(name);\n              continue;\n            }\n\n            if (name == \"or\") {\n              types.push(XPathParser.OR);\n              values.push(name);\n              continue;\n            }\n\n            if (name == \"mod\") {\n              types.push(XPathParser.MOD);\n              values.push(name);\n              continue;\n            }\n\n            if (name == \"div\") {\n              types.push(XPathParser.DIV);\n              values.push(name);\n              continue;\n            }\n          }\n        }\n\n        if (c == ':') {\n          if (s.charAt(pos) == '*') {\n            types.push(XPathParser.NCNAMECOLONASTERISK);\n            values.push(name + \":*\");\n            pos++;\n            c = s.charAt(pos++);\n            continue;\n          }\n\n          if (s.charAt(pos) == '_' || Utilities.isLetter(s.charCodeAt(pos))) {\n            name += ':';\n            c = s.charAt(pos++);\n\n            while (Utilities.isNCNameChar(c.charCodeAt(0))) {\n              name += c;\n              c = s.charAt(pos++);\n            }\n\n            if (c == '(') {\n              types.push(XPathParser.FUNCTIONNAME);\n              values.push(name);\n              continue;\n            }\n\n            types.push(XPathParser.QNAME);\n            values.push(name);\n            continue;\n          }\n\n          if (s.charAt(pos) == ':') {\n            types.push(XPathParser.AXISNAME);\n            values.push(name);\n            continue;\n          }\n        }\n\n        if (c == '(') {\n          if (name == \"comment\" || name == \"text\" || name == \"node\") {\n            types.push(XPathParser.NODETYPE);\n            values.push(name);\n            continue;\n          }\n\n          if (name == \"processing-instruction\") {\n            if (s.charAt(pos) == ')') {\n              types.push(XPathParser.NODETYPE);\n            } else {\n              types.push(XPathParser.PROCESSINGINSTRUCTIONWITHLITERAL);\n            }\n\n            values.push(name);\n            continue;\n          }\n\n          types.push(XPathParser.FUNCTIONNAME);\n          values.push(name);\n          continue;\n        }\n\n        types.push(XPathParser.QNAME);\n        values.push(name);\n        continue;\n      }\n\n      throw new Error(\"Unexpected character \" + c);\n    }\n\n    types.push(1);\n    values.push(\"[EOF]\");\n    return [types, values];\n  };\n\n  XPathParser.SHIFT = 's';\n  XPathParser.REDUCE = 'r';\n  XPathParser.ACCEPT = 'a';\n\n  XPathParser.prototype.parse = function (s) {\n    var types;\n    var values;\n    var res = this.tokenize(s);\n\n    if (res == undefined) {\n      return undefined;\n    }\n\n    types = res[0];\n    values = res[1];\n    var tokenPos = 0;\n    var state = [];\n    var tokenType = [];\n    var tokenValue = [];\n    var s;\n    var a;\n    var t;\n    state.push(0);\n    tokenType.push(1);\n    tokenValue.push(\"_S\");\n    a = types[tokenPos];\n    t = values[tokenPos++];\n\n    while (1) {\n      s = state[state.length - 1];\n\n      switch (XPathParser.actionTable[s].charAt(a - 1)) {\n        case XPathParser.SHIFT:\n          tokenType.push(-a);\n          tokenValue.push(t);\n          state.push(XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32);\n          a = types[tokenPos];\n          t = values[tokenPos++];\n          break;\n\n        case XPathParser.REDUCE:\n          var num = XPathParser.productions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32][1];\n          var rhs = [];\n\n          for (var i = 0; i < num; i++) {\n            tokenType.pop();\n            rhs.unshift(tokenValue.pop());\n            state.pop();\n          }\n\n          var s_ = state[state.length - 1];\n          tokenType.push(XPathParser.productions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32][0]);\n\n          if (this.reduceActions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32] == undefined) {\n            tokenValue.push(rhs[0]);\n          } else {\n            tokenValue.push(this.reduceActions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32](rhs));\n          }\n\n          state.push(XPathParser.gotoTable[s_].charCodeAt(XPathParser.productions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32][0] - 2) - 33);\n          break;\n\n        case XPathParser.ACCEPT:\n          return new XPath(tokenValue.pop());\n\n        default:\n          throw new Error(\"XPath parse error\");\n      }\n    }\n  }; // XPath /////////////////////////////////////////////////////////////////////\n\n\n  XPath.prototype = new Object();\n  XPath.prototype.constructor = XPath;\n  XPath.superclass = Object.prototype;\n\n  function XPath(e) {\n    this.expression = e;\n  }\n\n  XPath.prototype.toString = function () {\n    return this.expression.toString();\n  };\n\n  function setIfUnset(obj, prop, value) {\n    if (!(prop in obj)) {\n      obj[prop] = value;\n    }\n  }\n\n  XPath.prototype.evaluate = function (c) {\n    c.contextNode = c.expressionContextNode;\n    c.contextSize = 1;\n    c.contextPosition = 1; // [2017-11-25] Removed usage of .implementation.hasFeature() since it does\n    //              not reliably detect HTML DOMs (always returns false in xmldom and true in browsers)\n\n    if (c.isHtml) {\n      setIfUnset(c, 'caseInsensitive', true);\n      setIfUnset(c, 'allowAnyNamespaceForNoPrefix', true);\n    }\n\n    setIfUnset(c, 'caseInsensitive', false);\n    return this.expression.evaluate(c);\n  };\n\n  XPath.XML_NAMESPACE_URI = \"http://www.w3.org/XML/1998/namespace\";\n  XPath.XMLNS_NAMESPACE_URI = \"http://www.w3.org/2000/xmlns/\"; // Expression ////////////////////////////////////////////////////////////////\n\n  Expression.prototype = new Object();\n  Expression.prototype.constructor = Expression;\n  Expression.superclass = Object.prototype;\n\n  function Expression() {}\n\n  Expression.prototype.init = function () {};\n\n  Expression.prototype.toString = function () {\n    return \"<Expression>\";\n  };\n\n  Expression.prototype.evaluate = function (c) {\n    throw new Error(\"Could not evaluate expression.\");\n  }; // UnaryOperation ////////////////////////////////////////////////////////////\n\n\n  UnaryOperation.prototype = new Expression();\n  UnaryOperation.prototype.constructor = UnaryOperation;\n  UnaryOperation.superclass = Expression.prototype;\n\n  function UnaryOperation(rhs) {\n    if (arguments.length > 0) {\n      this.init(rhs);\n    }\n  }\n\n  UnaryOperation.prototype.init = function (rhs) {\n    this.rhs = rhs;\n  }; // UnaryMinusOperation ///////////////////////////////////////////////////////\n\n\n  UnaryMinusOperation.prototype = new UnaryOperation();\n  UnaryMinusOperation.prototype.constructor = UnaryMinusOperation;\n  UnaryMinusOperation.superclass = UnaryOperation.prototype;\n\n  function UnaryMinusOperation(rhs) {\n    if (arguments.length > 0) {\n      this.init(rhs);\n    }\n  }\n\n  UnaryMinusOperation.prototype.init = function (rhs) {\n    UnaryMinusOperation.superclass.init.call(this, rhs);\n  };\n\n  UnaryMinusOperation.prototype.evaluate = function (c) {\n    return this.rhs.evaluate(c).number().negate();\n  };\n\n  UnaryMinusOperation.prototype.toString = function () {\n    return \"-\" + this.rhs.toString();\n  }; // BinaryOperation ///////////////////////////////////////////////////////////\n\n\n  BinaryOperation.prototype = new Expression();\n  BinaryOperation.prototype.constructor = BinaryOperation;\n  BinaryOperation.superclass = Expression.prototype;\n\n  function BinaryOperation(lhs, rhs) {\n    if (arguments.length > 0) {\n      this.init(lhs, rhs);\n    }\n  }\n\n  BinaryOperation.prototype.init = function (lhs, rhs) {\n    this.lhs = lhs;\n    this.rhs = rhs;\n  }; // OrOperation ///////////////////////////////////////////////////////////////\n\n\n  OrOperation.prototype = new BinaryOperation();\n  OrOperation.prototype.constructor = OrOperation;\n  OrOperation.superclass = BinaryOperation.prototype;\n\n  function OrOperation(lhs, rhs) {\n    if (arguments.length > 0) {\n      this.init(lhs, rhs);\n    }\n  }\n\n  OrOperation.prototype.init = function (lhs, rhs) {\n    OrOperation.superclass.init.call(this, lhs, rhs);\n  };\n\n  OrOperation.prototype.toString = function () {\n    return \"(\" + this.lhs.toString() + \" or \" + this.rhs.toString() + \")\";\n  };\n\n  OrOperation.prototype.evaluate = function (c) {\n    var b = this.lhs.evaluate(c).bool();\n\n    if (b.booleanValue()) {\n      return b;\n    }\n\n    return this.rhs.evaluate(c).bool();\n  }; // AndOperation //////////////////////////////////////////////////////////////\n\n\n  AndOperation.prototype = new BinaryOperation();\n  AndOperation.prototype.constructor = AndOperation;\n  AndOperation.superclass = BinaryOperation.prototype;\n\n  function AndOperation(lhs, rhs) {\n    if (arguments.length > 0) {\n      this.init(lhs, rhs);\n    }\n  }\n\n  AndOperation.prototype.init = function (lhs, rhs) {\n    AndOperation.superclass.init.call(this, lhs, rhs);\n  };\n\n  AndOperation.prototype.toString = function () {\n    return \"(\" + this.lhs.toString() + \" and \" + this.rhs.toString() + \")\";\n  };\n\n  AndOperation.prototype.evaluate = function (c) {\n    var b = this.lhs.evaluate(c).bool();\n\n    if (!b.booleanValue()) {\n      return b;\n    }\n\n    return this.rhs.evaluate(c).bool();\n  }; // EqualsOperation ///////////////////////////////////////////////////////////\n\n\n  EqualsOperation.prototype = new BinaryOperation();\n  EqualsOperation.prototype.constructor = EqualsOperation;\n  EqualsOperation.superclass = BinaryOperation.prototype;\n\n  function EqualsOperation(lhs, rhs) {\n    if (arguments.length > 0) {\n      this.init(lhs, rhs);\n    }\n  }\n\n  EqualsOperation.prototype.init = function (lhs, rhs) {\n    EqualsOperation.superclass.init.call(this, lhs, rhs);\n  };\n\n  EqualsOperation.prototype.toString = function () {\n    return \"(\" + this.lhs.toString() + \" = \" + this.rhs.toString() + \")\";\n  };\n\n  EqualsOperation.prototype.evaluate = function (c) {\n    return this.lhs.evaluate(c).equals(this.rhs.evaluate(c));\n  }; // NotEqualOperation /////////////////////////////////////////////////////////\n\n\n  NotEqualOperation.prototype = new BinaryOperation();\n  NotEqualOperation.prototype.constructor = NotEqualOperation;\n  NotEqualOperation.superclass = BinaryOperation.prototype;\n\n  function NotEqualOperation(lhs, rhs) {\n    if (arguments.length > 0) {\n      this.init(lhs, rhs);\n    }\n  }\n\n  NotEqualOperation.prototype.init = function (lhs, rhs) {\n    NotEqualOperation.superclass.init.call(this, lhs, rhs);\n  };\n\n  NotEqualOperation.prototype.toString = function () {\n    return \"(\" + this.lhs.toString() + \" != \" + this.rhs.toString() + \")\";\n  };\n\n  NotEqualOperation.prototype.evaluate = function (c) {\n    return this.lhs.evaluate(c).notequal(this.rhs.evaluate(c));\n  }; // LessThanOperation /////////////////////////////////////////////////////////\n\n\n  LessThanOperation.prototype = new BinaryOperation();\n  LessThanOperation.prototype.constructor = LessThanOperation;\n  LessThanOperation.superclass = BinaryOperation.prototype;\n\n  function LessThanOperation(lhs, rhs) {\n    if (arguments.length > 0) {\n      this.init(lhs, rhs);\n    }\n  }\n\n  LessThanOperation.prototype.init = function (lhs, rhs) {\n    LessThanOperation.superclass.init.call(this, lhs, rhs);\n  };\n\n  LessThanOperation.prototype.evaluate = function (c) {\n    return this.lhs.evaluate(c).lessthan(this.rhs.evaluate(c));\n  };\n\n  LessThanOperation.prototype.toString = function () {\n    return \"(\" + this.lhs.toString() + \" < \" + this.rhs.toString() + \")\";\n  }; // GreaterThanOperation //////////////////////////////////////////////////////\n\n\n  GreaterThanOperation.prototype = new BinaryOperation();\n  GreaterThanOperation.prototype.constructor = GreaterThanOperation;\n  GreaterThanOperation.superclass = BinaryOperation.prototype;\n\n  function GreaterThanOperation(lhs, rhs) {\n    if (arguments.length > 0) {\n      this.init(lhs, rhs);\n    }\n  }\n\n  GreaterThanOperation.prototype.init = function (lhs, rhs) {\n    GreaterThanOperation.superclass.init.call(this, lhs, rhs);\n  };\n\n  GreaterThanOperation.prototype.evaluate = function (c) {\n    return this.lhs.evaluate(c).greaterthan(this.rhs.evaluate(c));\n  };\n\n  GreaterThanOperation.prototype.toString = function () {\n    return \"(\" + this.lhs.toString() + \" > \" + this.rhs.toString() + \")\";\n  }; // LessThanOrEqualOperation //////////////////////////////////////////////////\n\n\n  LessThanOrEqualOperation.prototype = new BinaryOperation();\n  LessThanOrEqualOperation.prototype.constructor = LessThanOrEqualOperation;\n  LessThanOrEqualOperation.superclass = BinaryOperation.prototype;\n\n  function LessThanOrEqualOperation(lhs, rhs) {\n    if (arguments.length > 0) {\n      this.init(lhs, rhs);\n    }\n  }\n\n  LessThanOrEqualOperation.prototype.init = function (lhs, rhs) {\n    LessThanOrEqualOperation.superclass.init.call(this, lhs, rhs);\n  };\n\n  LessThanOrEqualOperation.prototype.evaluate = function (c) {\n    return this.lhs.evaluate(c).lessthanorequal(this.rhs.evaluate(c));\n  };\n\n  LessThanOrEqualOperation.prototype.toString = function () {\n    return \"(\" + this.lhs.toString() + \" <= \" + this.rhs.toString() + \")\";\n  }; // GreaterThanOrEqualOperation ///////////////////////////////////////////////\n\n\n  GreaterThanOrEqualOperation.prototype = new BinaryOperation();\n  GreaterThanOrEqualOperation.prototype.constructor = GreaterThanOrEqualOperation;\n  GreaterThanOrEqualOperation.superclass = BinaryOperation.prototype;\n\n  function GreaterThanOrEqualOperation(lhs, rhs) {\n    if (arguments.length > 0) {\n      this.init(lhs, rhs);\n    }\n  }\n\n  GreaterThanOrEqualOperation.prototype.init = function (lhs, rhs) {\n    GreaterThanOrEqualOperation.superclass.init.call(this, lhs, rhs);\n  };\n\n  GreaterThanOrEqualOperation.prototype.evaluate = function (c) {\n    return this.lhs.evaluate(c).greaterthanorequal(this.rhs.evaluate(c));\n  };\n\n  GreaterThanOrEqualOperation.prototype.toString = function () {\n    return \"(\" + this.lhs.toString() + \" >= \" + this.rhs.toString() + \")\";\n  }; // PlusOperation /////////////////////////////////////////////////////////////\n\n\n  PlusOperation.prototype = new BinaryOperation();\n  PlusOperation.prototype.constructor = PlusOperation;\n  PlusOperation.superclass = BinaryOperation.prototype;\n\n  function PlusOperation(lhs, rhs) {\n    if (arguments.length > 0) {\n      this.init(lhs, rhs);\n    }\n  }\n\n  PlusOperation.prototype.init = function (lhs, rhs) {\n    PlusOperation.superclass.init.call(this, lhs, rhs);\n  };\n\n  PlusOperation.prototype.evaluate = function (c) {\n    return this.lhs.evaluate(c).number().plus(this.rhs.evaluate(c).number());\n  };\n\n  PlusOperation.prototype.toString = function () {\n    return \"(\" + this.lhs.toString() + \" + \" + this.rhs.toString() + \")\";\n  }; // MinusOperation ////////////////////////////////////////////////////////////\n\n\n  MinusOperation.prototype = new BinaryOperation();\n  MinusOperation.prototype.constructor = MinusOperation;\n  MinusOperation.superclass = BinaryOperation.prototype;\n\n  function MinusOperation(lhs, rhs) {\n    if (arguments.length > 0) {\n      this.init(lhs, rhs);\n    }\n  }\n\n  MinusOperation.prototype.init = function (lhs, rhs) {\n    MinusOperation.superclass.init.call(this, lhs, rhs);\n  };\n\n  MinusOperation.prototype.evaluate = function (c) {\n    return this.lhs.evaluate(c).number().minus(this.rhs.evaluate(c).number());\n  };\n\n  MinusOperation.prototype.toString = function () {\n    return \"(\" + this.lhs.toString() + \" - \" + this.rhs.toString() + \")\";\n  }; // MultiplyOperation /////////////////////////////////////////////////////////\n\n\n  MultiplyOperation.prototype = new BinaryOperation();\n  MultiplyOperation.prototype.constructor = MultiplyOperation;\n  MultiplyOperation.superclass = BinaryOperation.prototype;\n\n  function MultiplyOperation(lhs, rhs) {\n    if (arguments.length > 0) {\n      this.init(lhs, rhs);\n    }\n  }\n\n  MultiplyOperation.prototype.init = function (lhs, rhs) {\n    MultiplyOperation.superclass.init.call(this, lhs, rhs);\n  };\n\n  MultiplyOperation.prototype.evaluate = function (c) {\n    return this.lhs.evaluate(c).number().multiply(this.rhs.evaluate(c).number());\n  };\n\n  MultiplyOperation.prototype.toString = function () {\n    return \"(\" + this.lhs.toString() + \" * \" + this.rhs.toString() + \")\";\n  }; // DivOperation //////////////////////////////////////////////////////////////\n\n\n  DivOperation.prototype = new BinaryOperation();\n  DivOperation.prototype.constructor = DivOperation;\n  DivOperation.superclass = BinaryOperation.prototype;\n\n  function DivOperation(lhs, rhs) {\n    if (arguments.length > 0) {\n      this.init(lhs, rhs);\n    }\n  }\n\n  DivOperation.prototype.init = function (lhs, rhs) {\n    DivOperation.superclass.init.call(this, lhs, rhs);\n  };\n\n  DivOperation.prototype.evaluate = function (c) {\n    return this.lhs.evaluate(c).number().div(this.rhs.evaluate(c).number());\n  };\n\n  DivOperation.prototype.toString = function () {\n    return \"(\" + this.lhs.toString() + \" div \" + this.rhs.toString() + \")\";\n  }; // ModOperation //////////////////////////////////////////////////////////////\n\n\n  ModOperation.prototype = new BinaryOperation();\n  ModOperation.prototype.constructor = ModOperation;\n  ModOperation.superclass = BinaryOperation.prototype;\n\n  function ModOperation(lhs, rhs) {\n    if (arguments.length > 0) {\n      this.init(lhs, rhs);\n    }\n  }\n\n  ModOperation.prototype.init = function (lhs, rhs) {\n    ModOperation.superclass.init.call(this, lhs, rhs);\n  };\n\n  ModOperation.prototype.evaluate = function (c) {\n    return this.lhs.evaluate(c).number().mod(this.rhs.evaluate(c).number());\n  };\n\n  ModOperation.prototype.toString = function () {\n    return \"(\" + this.lhs.toString() + \" mod \" + this.rhs.toString() + \")\";\n  }; // BarOperation //////////////////////////////////////////////////////////////\n\n\n  BarOperation.prototype = new BinaryOperation();\n  BarOperation.prototype.constructor = BarOperation;\n  BarOperation.superclass = BinaryOperation.prototype;\n\n  function BarOperation(lhs, rhs) {\n    if (arguments.length > 0) {\n      this.init(lhs, rhs);\n    }\n  }\n\n  BarOperation.prototype.init = function (lhs, rhs) {\n    BarOperation.superclass.init.call(this, lhs, rhs);\n  };\n\n  BarOperation.prototype.evaluate = function (c) {\n    return this.lhs.evaluate(c).nodeset().union(this.rhs.evaluate(c).nodeset());\n  };\n\n  BarOperation.prototype.toString = function () {\n    return map(toString, [this.lhs, this.rhs]).join(' | ');\n  }; // PathExpr //////////////////////////////////////////////////////////////////\n\n\n  PathExpr.prototype = new Expression();\n  PathExpr.prototype.constructor = PathExpr;\n  PathExpr.superclass = Expression.prototype;\n\n  function PathExpr(filter, filterPreds, locpath) {\n    if (arguments.length > 0) {\n      this.init(filter, filterPreds, locpath);\n    }\n  }\n\n  PathExpr.prototype.init = function (filter, filterPreds, locpath) {\n    PathExpr.superclass.init.call(this);\n    this.filter = filter;\n    this.filterPredicates = filterPreds;\n    this.locationPath = locpath;\n  };\n  /**\r\n   * Returns the topmost node of the tree containing node\r\n   */\n\n\n  function findRoot(node) {\n    while (node && node.parentNode) {\n      node = node.parentNode;\n    }\n\n    return node;\n  }\n\n  PathExpr.applyPredicates = function (predicates, c, nodes) {\n    return reduce(function (inNodes, pred) {\n      var ctx = c.extend({\n        contextSize: inNodes.length\n      });\n      return filter(function (node, i) {\n        return PathExpr.predicateMatches(pred, ctx.extend({\n          contextNode: node,\n          contextPosition: i + 1\n        }));\n      }, inNodes);\n    }, nodes, predicates);\n  };\n\n  PathExpr.getRoot = function (xpc, nodes) {\n    var firstNode = nodes[0];\n\n    if (firstNode.nodeType === 9\n    /*Node.DOCUMENT_NODE*/\n    ) {\n        return firstNode;\n      }\n\n    if (xpc.virtualRoot) {\n      return xpc.virtualRoot;\n    }\n\n    var ownerDoc = firstNode.ownerDocument;\n\n    if (ownerDoc) {\n      return ownerDoc;\n    } // IE 5.5 doesn't have ownerDocument?\n\n\n    var n = firstNode;\n\n    while (n.parentNode != null) {\n      n = n.parentNode;\n    }\n\n    return n;\n  };\n\n  PathExpr.applyStep = function (step, xpc, node) {\n    var self = this;\n    var newNodes = [];\n    xpc.contextNode = node;\n\n    switch (step.axis) {\n      case Step.ANCESTOR:\n        // look at all the ancestor nodes\n        if (xpc.contextNode === xpc.virtualRoot) {\n          break;\n        }\n\n        var m;\n\n        if (xpc.contextNode.nodeType == 2\n        /*Node.ATTRIBUTE_NODE*/\n        ) {\n            m = PathExpr.getOwnerElement(xpc.contextNode);\n          } else {\n          m = xpc.contextNode.parentNode;\n        }\n\n        while (m != null) {\n          if (step.nodeTest.matches(m, xpc)) {\n            newNodes.push(m);\n          }\n\n          if (m === xpc.virtualRoot) {\n            break;\n          }\n\n          m = m.parentNode;\n        }\n\n        break;\n\n      case Step.ANCESTORORSELF:\n        // look at all the ancestor nodes and the current node\n        for (var m = xpc.contextNode; m != null; m = m.nodeType == 2\n        /*Node.ATTRIBUTE_NODE*/\n        ? PathExpr.getOwnerElement(m) : m.parentNode) {\n          if (step.nodeTest.matches(m, xpc)) {\n            newNodes.push(m);\n          }\n\n          if (m === xpc.virtualRoot) {\n            break;\n          }\n        }\n\n        break;\n\n      case Step.ATTRIBUTE:\n        // look at the attributes\n        var nnm = xpc.contextNode.attributes;\n\n        if (nnm != null) {\n          for (var k = 0; k < nnm.length; k++) {\n            var m = nnm.item(k);\n\n            if (step.nodeTest.matches(m, xpc)) {\n              newNodes.push(m);\n            }\n          }\n        }\n\n        break;\n\n      case Step.CHILD:\n        // look at all child elements\n        for (var m = xpc.contextNode.firstChild; m != null; m = m.nextSibling) {\n          if (step.nodeTest.matches(m, xpc)) {\n            newNodes.push(m);\n          }\n        }\n\n        break;\n\n      case Step.DESCENDANT:\n        // look at all descendant nodes\n        var st = [xpc.contextNode.firstChild];\n\n        while (st.length > 0) {\n          for (var m = st.pop(); m != null;) {\n            if (step.nodeTest.matches(m, xpc)) {\n              newNodes.push(m);\n            }\n\n            if (m.firstChild != null) {\n              st.push(m.nextSibling);\n              m = m.firstChild;\n            } else {\n              m = m.nextSibling;\n            }\n          }\n        }\n\n        break;\n\n      case Step.DESCENDANTORSELF:\n        // look at self\n        if (step.nodeTest.matches(xpc.contextNode, xpc)) {\n          newNodes.push(xpc.contextNode);\n        } // look at all descendant nodes\n\n\n        var st = [xpc.contextNode.firstChild];\n\n        while (st.length > 0) {\n          for (var m = st.pop(); m != null;) {\n            if (step.nodeTest.matches(m, xpc)) {\n              newNodes.push(m);\n            }\n\n            if (m.firstChild != null) {\n              st.push(m.nextSibling);\n              m = m.firstChild;\n            } else {\n              m = m.nextSibling;\n            }\n          }\n        }\n\n        break;\n\n      case Step.FOLLOWING:\n        if (xpc.contextNode === xpc.virtualRoot) {\n          break;\n        }\n\n        var st = [];\n\n        if (xpc.contextNode.firstChild != null) {\n          st.unshift(xpc.contextNode.firstChild);\n        } else {\n          st.unshift(xpc.contextNode.nextSibling);\n        }\n\n        for (var m = xpc.contextNode.parentNode; m != null && m.nodeType != 9\n        /*Node.DOCUMENT_NODE*/\n        && m !== xpc.virtualRoot; m = m.parentNode) {\n          st.unshift(m.nextSibling);\n        }\n\n        do {\n          for (var m = st.pop(); m != null;) {\n            if (step.nodeTest.matches(m, xpc)) {\n              newNodes.push(m);\n            }\n\n            if (m.firstChild != null) {\n              st.push(m.nextSibling);\n              m = m.firstChild;\n            } else {\n              m = m.nextSibling;\n            }\n          }\n        } while (st.length > 0);\n\n        break;\n\n      case Step.FOLLOWINGSIBLING:\n        if (xpc.contextNode === xpc.virtualRoot) {\n          break;\n        }\n\n        for (var m = xpc.contextNode.nextSibling; m != null; m = m.nextSibling) {\n          if (step.nodeTest.matches(m, xpc)) {\n            newNodes.push(m);\n          }\n        }\n\n        break;\n\n      case Step.NAMESPACE:\n        var n = {};\n\n        if (xpc.contextNode.nodeType == 1\n        /*Node.ELEMENT_NODE*/\n        ) {\n            n[\"xml\"] = XPath.XML_NAMESPACE_URI;\n            n[\"xmlns\"] = XPath.XMLNS_NAMESPACE_URI;\n\n            for (var m = xpc.contextNode; m != null && m.nodeType == 1\n            /*Node.ELEMENT_NODE*/\n            ; m = m.parentNode) {\n              for (var k = 0; k < m.attributes.length; k++) {\n                var attr = m.attributes.item(k);\n                var nm = String(attr.name);\n\n                if (nm == \"xmlns\") {\n                  if (n[\"\"] == undefined) {\n                    n[\"\"] = attr.value;\n                  }\n                } else if (nm.length > 6 && nm.substring(0, 6) == \"xmlns:\") {\n                  var pre = nm.substring(6, nm.length);\n\n                  if (n[pre] == undefined) {\n                    n[pre] = attr.value;\n                  }\n                }\n              }\n            }\n\n            for (var pre in n) {\n              var nsn = new XPathNamespace(pre, n[pre], xpc.contextNode);\n\n              if (step.nodeTest.matches(nsn, xpc)) {\n                newNodes.push(nsn);\n              }\n            }\n          }\n\n        break;\n\n      case Step.PARENT:\n        m = null;\n\n        if (xpc.contextNode !== xpc.virtualRoot) {\n          if (xpc.contextNode.nodeType == 2\n          /*Node.ATTRIBUTE_NODE*/\n          ) {\n              m = PathExpr.getOwnerElement(xpc.contextNode);\n            } else {\n            m = xpc.contextNode.parentNode;\n          }\n        }\n\n        if (m != null && step.nodeTest.matches(m, xpc)) {\n          newNodes.push(m);\n        }\n\n        break;\n\n      case Step.PRECEDING:\n        var st;\n\n        if (xpc.virtualRoot != null) {\n          st = [xpc.virtualRoot];\n        } else {\n          // cannot rely on .ownerDocument because the node may be in a document fragment\n          st = [findRoot(xpc.contextNode)];\n        }\n\n        outer: while (st.length > 0) {\n          for (var m = st.pop(); m != null;) {\n            if (m == xpc.contextNode) {\n              break outer;\n            }\n\n            if (step.nodeTest.matches(m, xpc)) {\n              newNodes.unshift(m);\n            }\n\n            if (m.firstChild != null) {\n              st.push(m.nextSibling);\n              m = m.firstChild;\n            } else {\n              m = m.nextSibling;\n            }\n          }\n        }\n\n        break;\n\n      case Step.PRECEDINGSIBLING:\n        if (xpc.contextNode === xpc.virtualRoot) {\n          break;\n        }\n\n        for (var m = xpc.contextNode.previousSibling; m != null; m = m.previousSibling) {\n          if (step.nodeTest.matches(m, xpc)) {\n            newNodes.push(m);\n          }\n        }\n\n        break;\n\n      case Step.SELF:\n        if (step.nodeTest.matches(xpc.contextNode, xpc)) {\n          newNodes.push(xpc.contextNode);\n        }\n\n        break;\n\n      default:\n    }\n\n    return newNodes;\n  };\n\n  PathExpr.applySteps = function (steps, xpc, nodes) {\n    return reduce(function (inNodes, step) {\n      return [].concat.apply([], map(function (node) {\n        return PathExpr.applyPredicates(step.predicates, xpc, PathExpr.applyStep(step, xpc, node));\n      }, inNodes));\n    }, nodes, steps);\n  };\n\n  PathExpr.prototype.applyFilter = function (c, xpc) {\n    if (!this.filter) {\n      return {\n        nodes: [c.contextNode]\n      };\n    }\n\n    var ns = this.filter.evaluate(c);\n\n    if (!Utilities.instance_of(ns, XNodeSet)) {\n      if (this.filterPredicates != null && this.filterPredicates.length > 0 || this.locationPath != null) {\n        throw new Error(\"Path expression filter must evaluate to a nodeset if predicates or location path are used\");\n      }\n\n      return {\n        nonNodes: ns\n      };\n    }\n\n    return {\n      nodes: PathExpr.applyPredicates(this.filterPredicates || [], xpc, ns.toUnsortedArray())\n    };\n  };\n\n  PathExpr.applyLocationPath = function (locationPath, xpc, nodes) {\n    if (!locationPath) {\n      return nodes;\n    }\n\n    var startNodes = locationPath.absolute ? [PathExpr.getRoot(xpc, nodes)] : nodes;\n    return PathExpr.applySteps(locationPath.steps, xpc, startNodes);\n  };\n\n  PathExpr.prototype.evaluate = function (c) {\n    var xpc = assign(new XPathContext(), c);\n    var filterResult = this.applyFilter(c, xpc);\n\n    if ('nonNodes' in filterResult) {\n      return filterResult.nonNodes;\n    }\n\n    var ns = new XNodeSet();\n    ns.addArray(PathExpr.applyLocationPath(this.locationPath, xpc, filterResult.nodes));\n    return ns;\n  };\n\n  PathExpr.predicateMatches = function (pred, c) {\n    var res = pred.evaluate(c);\n    return Utilities.instance_of(res, XNumber) ? c.contextPosition == res.numberValue() : res.booleanValue();\n  };\n\n  PathExpr.predicateString = compose(wrap('[', ']'), toString);\n  PathExpr.predicatesString = compose(join(''), map(PathExpr.predicateString));\n\n  PathExpr.prototype.toString = function () {\n    if (this.filter != undefined) {\n      var filterStr = toString(this.filter);\n\n      if (Utilities.instance_of(this.filter, XString)) {\n        return wrap(\"'\", \"'\", filterStr);\n      }\n\n      if (this.filterPredicates != undefined && this.filterPredicates.length) {\n        return wrap('(', ')', filterStr) + PathExpr.predicatesString(this.filterPredicates);\n      }\n\n      if (this.locationPath != undefined) {\n        return filterStr + (this.locationPath.absolute ? '' : '/') + toString(this.locationPath);\n      }\n\n      return filterStr;\n    }\n\n    return toString(this.locationPath);\n  };\n\n  PathExpr.getOwnerElement = function (n) {\n    // DOM 2 has ownerElement\n    if (n.ownerElement) {\n      return n.ownerElement;\n    } // DOM 1 Internet Explorer can use selectSingleNode (ironically)\n\n\n    try {\n      if (n.selectSingleNode) {\n        return n.selectSingleNode(\"..\");\n      }\n    } catch (e) {} // Other DOM 1 implementations must use this egregious search\n\n\n    var doc = n.nodeType == 9\n    /*Node.DOCUMENT_NODE*/\n    ? n : n.ownerDocument;\n    var elts = doc.getElementsByTagName(\"*\");\n\n    for (var i = 0; i < elts.length; i++) {\n      var elt = elts.item(i);\n      var nnm = elt.attributes;\n\n      for (var j = 0; j < nnm.length; j++) {\n        var an = nnm.item(j);\n\n        if (an === n) {\n          return elt;\n        }\n      }\n    }\n\n    return null;\n  }; // LocationPath //////////////////////////////////////////////////////////////\n\n\n  LocationPath.prototype = new Object();\n  LocationPath.prototype.constructor = LocationPath;\n  LocationPath.superclass = Object.prototype;\n\n  function LocationPath(abs, steps) {\n    if (arguments.length > 0) {\n      this.init(abs, steps);\n    }\n  }\n\n  LocationPath.prototype.init = function (abs, steps) {\n    this.absolute = abs;\n    this.steps = steps;\n  };\n\n  LocationPath.prototype.toString = function () {\n    return (this.absolute ? '/' : '') + map(toString, this.steps).join('/');\n  }; // Step //////////////////////////////////////////////////////////////////////\n\n\n  Step.prototype = new Object();\n  Step.prototype.constructor = Step;\n  Step.superclass = Object.prototype;\n\n  function Step(axis, nodetest, preds) {\n    if (arguments.length > 0) {\n      this.init(axis, nodetest, preds);\n    }\n  }\n\n  Step.prototype.init = function (axis, nodetest, preds) {\n    this.axis = axis;\n    this.nodeTest = nodetest;\n    this.predicates = preds;\n  };\n\n  Step.prototype.toString = function () {\n    return Step.STEPNAMES[this.axis] + \"::\" + this.nodeTest.toString() + PathExpr.predicatesString(this.predicates);\n  };\n\n  Step.ANCESTOR = 0;\n  Step.ANCESTORORSELF = 1;\n  Step.ATTRIBUTE = 2;\n  Step.CHILD = 3;\n  Step.DESCENDANT = 4;\n  Step.DESCENDANTORSELF = 5;\n  Step.FOLLOWING = 6;\n  Step.FOLLOWINGSIBLING = 7;\n  Step.NAMESPACE = 8;\n  Step.PARENT = 9;\n  Step.PRECEDING = 10;\n  Step.PRECEDINGSIBLING = 11;\n  Step.SELF = 12;\n  Step.STEPNAMES = reduce(function (acc, x) {\n    return acc[x[0]] = x[1], acc;\n  }, {}, [[Step.ANCESTOR, 'ancestor'], [Step.ANCESTORORSELF, 'ancestor-or-self'], [Step.ATTRIBUTE, 'attribute'], [Step.CHILD, 'child'], [Step.DESCENDANT, 'descendant'], [Step.DESCENDANTORSELF, 'descendant-or-self'], [Step.FOLLOWING, 'following'], [Step.FOLLOWINGSIBLING, 'following-sibling'], [Step.NAMESPACE, 'namespace'], [Step.PARENT, 'parent'], [Step.PRECEDING, 'preceding'], [Step.PRECEDINGSIBLING, 'preceding-sibling'], [Step.SELF, 'self']]); // NodeTest //////////////////////////////////////////////////////////////////\n\n  NodeTest.prototype = new Object();\n  NodeTest.prototype.constructor = NodeTest;\n  NodeTest.superclass = Object.prototype;\n\n  function NodeTest(type, value) {\n    if (arguments.length > 0) {\n      this.init(type, value);\n    }\n  }\n\n  NodeTest.prototype.init = function (type, value) {\n    this.type = type;\n    this.value = value;\n  };\n\n  NodeTest.prototype.toString = function () {\n    return \"<unknown nodetest type>\";\n  };\n\n  NodeTest.prototype.matches = function (n, xpc) {\n    console.warn('unknown node test type');\n  };\n\n  NodeTest.NAMETESTANY = 0;\n  NodeTest.NAMETESTPREFIXANY = 1;\n  NodeTest.NAMETESTQNAME = 2;\n  NodeTest.COMMENT = 3;\n  NodeTest.TEXT = 4;\n  NodeTest.PI = 5;\n  NodeTest.NODE = 6;\n\n  NodeTest.isNodeType = function (types) {\n    return compose(includes(types), prop('nodeType'));\n  };\n\n  NodeTest.makeNodeTestType = function (type, members, ctor) {\n    var newType = ctor || function () {};\n\n    newType.prototype = new NodeTest(members.type);\n    newType.prototype.constructor = type;\n\n    for (var key in members) {\n      newType.prototype[key] = members[key];\n    }\n\n    return newType;\n  }; // create invariant node test for certain node types\n\n\n  NodeTest.makeNodeTypeTest = function (type, nodeTypes, stringVal) {\n    return new (NodeTest.makeNodeTestType(type, {\n      matches: NodeTest.isNodeType(nodeTypes),\n      toString: always(stringVal)\n    }))();\n  };\n\n  NodeTest.hasPrefix = function (node) {\n    return node.prefix || (node.nodeName || node.tagName).indexOf(':') !== -1;\n  };\n\n  NodeTest.isElementOrAttribute = NodeTest.isNodeType([1, 2]);\n\n  NodeTest.nameSpaceMatches = function (prefix, xpc, n) {\n    var nNamespace = n.namespaceURI || '';\n\n    if (!prefix) {\n      return !nNamespace || xpc.allowAnyNamespaceForNoPrefix && !NodeTest.hasPrefix(n);\n    }\n\n    var ns = xpc.namespaceResolver.getNamespace(prefix, xpc.expressionContextNode);\n\n    if (ns == null) {\n      throw new Error(\"Cannot resolve QName \" + prefix);\n    }\n\n    return ns === nNamespace;\n  };\n\n  NodeTest.localNameMatches = function (localName, xpc, n) {\n    var nLocalName = n.localName || n.nodeName;\n    return xpc.caseInsensitive ? localName.toLowerCase() === nLocalName.toLowerCase() : localName === nLocalName;\n  };\n\n  NodeTest.NameTestPrefixAny = NodeTest.makeNodeTestType(NodeTest.NAMETESTPREFIXANY, {\n    matches: function matches(n, xpc) {\n      return NodeTest.isElementOrAttribute(n) && NodeTest.nameSpaceMatches(this.prefix, xpc, n);\n    },\n    toString: function toString() {\n      return this.prefix + \":*\";\n    }\n  }, function (prefix) {\n    this.prefix = prefix;\n  });\n  NodeTest.NameTestQName = NodeTest.makeNodeTestType(NodeTest.NAMETESTQNAME, {\n    matches: function matches(n, xpc) {\n      return NodeTest.isNodeType([1, 2, XPathNamespace.XPATH_NAMESPACE_NODE])(n) && NodeTest.nameSpaceMatches(this.prefix, xpc, n) && NodeTest.localNameMatches(this.localName, xpc, n);\n    },\n    toString: function toString() {\n      return this.name;\n    }\n  }, function (name) {\n    var nameParts = name.split(':');\n    this.name = name;\n    this.prefix = nameParts.length > 1 ? nameParts[0] : null;\n    this.localName = nameParts[nameParts.length > 1 ? 1 : 0];\n  });\n  NodeTest.PITest = NodeTest.makeNodeTestType(NodeTest.PI, {\n    matches: function matches(n, xpc) {\n      return NodeTest.isNodeType([7])(n) && (n.target || n.nodeName) === this.name;\n    },\n    toString: function toString() {\n      return wrap('processing-instruction(\"', '\")', this.name);\n    }\n  }, function (name) {\n    this.name = name;\n  }); // singletons\n  // elements, attributes, namespaces\n\n  NodeTest.nameTestAny = NodeTest.makeNodeTypeTest(NodeTest.NAMETESTANY, [1, 2, XPathNamespace.XPATH_NAMESPACE_NODE], '*'); // text, cdata\n\n  NodeTest.textTest = NodeTest.makeNodeTypeTest(NodeTest.TEXT, [3, 4], 'text()');\n  NodeTest.commentTest = NodeTest.makeNodeTypeTest(NodeTest.COMMENT, [8], 'comment()'); // elements, attributes, text, cdata, PIs, comments, document nodes\n\n  NodeTest.nodeTest = NodeTest.makeNodeTypeTest(NodeTest.NODE, [1, 2, 3, 4, 7, 8, 9], 'node()');\n  NodeTest.anyPiTest = NodeTest.makeNodeTypeTest(NodeTest.PI, [7], 'processing-instruction()'); // VariableReference /////////////////////////////////////////////////////////\n\n  VariableReference.prototype = new Expression();\n  VariableReference.prototype.constructor = VariableReference;\n  VariableReference.superclass = Expression.prototype;\n\n  function VariableReference(v) {\n    if (arguments.length > 0) {\n      this.init(v);\n    }\n  }\n\n  VariableReference.prototype.init = function (v) {\n    this.variable = v;\n  };\n\n  VariableReference.prototype.toString = function () {\n    return \"$\" + this.variable;\n  };\n\n  VariableReference.prototype.evaluate = function (c) {\n    var parts = Utilities.resolveQName(this.variable, c.namespaceResolver, c.contextNode, false);\n\n    if (parts[0] == null) {\n      throw new Error(\"Cannot resolve QName \" + fn);\n    }\n\n    var result = c.variableResolver.getVariable(parts[1], parts[0]);\n\n    if (!result) {\n      throw XPathException.fromMessage(\"Undeclared variable: \" + this.toString());\n    }\n\n    return result;\n  }; // FunctionCall //////////////////////////////////////////////////////////////\n\n\n  FunctionCall.prototype = new Expression();\n  FunctionCall.prototype.constructor = FunctionCall;\n  FunctionCall.superclass = Expression.prototype;\n\n  function FunctionCall(fn, args) {\n    if (arguments.length > 0) {\n      this.init(fn, args);\n    }\n  }\n\n  FunctionCall.prototype.init = function (fn, args) {\n    this.functionName = fn;\n    this.arguments = args;\n  };\n\n  FunctionCall.prototype.toString = function () {\n    var s = this.functionName + \"(\";\n\n    for (var i = 0; i < this.arguments.length; i++) {\n      if (i > 0) {\n        s += \", \";\n      }\n\n      s += this.arguments[i].toString();\n    }\n\n    return s + \")\";\n  };\n\n  FunctionCall.prototype.evaluate = function (c) {\n    var f = FunctionResolver.getFunctionFromContext(this.functionName, c);\n\n    if (!f) {\n      throw new Error(\"Unknown function \" + this.functionName);\n    }\n\n    var a = [c].concat(this.arguments);\n    return f.apply(c.functionResolver.thisArg, a);\n  }; // Operators /////////////////////////////////////////////////////////////////\n\n\n  var Operators = new Object();\n\n  Operators.equals = function (l, r) {\n    return l.equals(r);\n  };\n\n  Operators.notequal = function (l, r) {\n    return l.notequal(r);\n  };\n\n  Operators.lessthan = function (l, r) {\n    return l.lessthan(r);\n  };\n\n  Operators.greaterthan = function (l, r) {\n    return l.greaterthan(r);\n  };\n\n  Operators.lessthanorequal = function (l, r) {\n    return l.lessthanorequal(r);\n  };\n\n  Operators.greaterthanorequal = function (l, r) {\n    return l.greaterthanorequal(r);\n  }; // XString ///////////////////////////////////////////////////////////////////\n\n\n  XString.prototype = new Expression();\n  XString.prototype.constructor = XString;\n  XString.superclass = Expression.prototype;\n\n  function XString(s) {\n    if (arguments.length > 0) {\n      this.init(s);\n    }\n  }\n\n  XString.prototype.init = function (s) {\n    this.str = String(s);\n  };\n\n  XString.prototype.toString = function () {\n    return this.str;\n  };\n\n  XString.prototype.evaluate = function (c) {\n    return this;\n  };\n\n  XString.prototype.string = function () {\n    return this;\n  };\n\n  XString.prototype.number = function () {\n    return new XNumber(this.str);\n  };\n\n  XString.prototype.bool = function () {\n    return new XBoolean(this.str);\n  };\n\n  XString.prototype.nodeset = function () {\n    throw new Error(\"Cannot convert string to nodeset\");\n  };\n\n  XString.prototype.stringValue = function () {\n    return this.str;\n  };\n\n  XString.prototype.numberValue = function () {\n    return this.number().numberValue();\n  };\n\n  XString.prototype.booleanValue = function () {\n    return this.bool().booleanValue();\n  };\n\n  XString.prototype.equals = function (r) {\n    if (Utilities.instance_of(r, XBoolean)) {\n      return this.bool().equals(r);\n    }\n\n    if (Utilities.instance_of(r, XNumber)) {\n      return this.number().equals(r);\n    }\n\n    if (Utilities.instance_of(r, XNodeSet)) {\n      return r.compareWithString(this, Operators.equals);\n    }\n\n    return new XBoolean(this.str == r.str);\n  };\n\n  XString.prototype.notequal = function (r) {\n    if (Utilities.instance_of(r, XBoolean)) {\n      return this.bool().notequal(r);\n    }\n\n    if (Utilities.instance_of(r, XNumber)) {\n      return this.number().notequal(r);\n    }\n\n    if (Utilities.instance_of(r, XNodeSet)) {\n      return r.compareWithString(this, Operators.notequal);\n    }\n\n    return new XBoolean(this.str != r.str);\n  };\n\n  XString.prototype.lessthan = function (r) {\n    return this.number().lessthan(r);\n  };\n\n  XString.prototype.greaterthan = function (r) {\n    return this.number().greaterthan(r);\n  };\n\n  XString.prototype.lessthanorequal = function (r) {\n    return this.number().lessthanorequal(r);\n  };\n\n  XString.prototype.greaterthanorequal = function (r) {\n    return this.number().greaterthanorequal(r);\n  }; // XNumber ///////////////////////////////////////////////////////////////////\n\n\n  XNumber.prototype = new Expression();\n  XNumber.prototype.constructor = XNumber;\n  XNumber.superclass = Expression.prototype;\n\n  function XNumber(n) {\n    if (arguments.length > 0) {\n      this.init(n);\n    }\n  }\n\n  XNumber.prototype.init = function (n) {\n    this.num = typeof n === \"string\" ? this.parse(n) : Number(n);\n  };\n\n  XNumber.prototype.numberFormat = /^\\s*-?[0-9]*\\.?[0-9]+\\s*$/;\n\n  XNumber.prototype.parse = function (s) {\n    // XPath representation of numbers is more restrictive than what Number() or parseFloat() allow\n    return this.numberFormat.test(s) ? parseFloat(s) : Number.NaN;\n  };\n\n  function padSmallNumber(numberStr) {\n    var parts = numberStr.split('e-');\n    var base = parts[0].replace('.', '');\n    var exponent = Number(parts[1]);\n\n    for (var i = 0; i < exponent - 1; i += 1) {\n      base = '0' + base;\n    }\n\n    return '0.' + base;\n  }\n\n  function padLargeNumber(numberStr) {\n    var parts = numberStr.split('e');\n    var base = parts[0].replace('.', '');\n    var exponent = Number(parts[1]);\n    var zerosToAppend = exponent + 1 - base.length;\n\n    for (var i = 0; i < zerosToAppend; i += 1) {\n      base += '0';\n    }\n\n    return base;\n  }\n\n  XNumber.prototype.toString = function () {\n    var strValue = this.num.toString();\n\n    if (strValue.indexOf('e-') !== -1) {\n      return padSmallNumber(strValue);\n    }\n\n    if (strValue.indexOf('e') !== -1) {\n      return padLargeNumber(strValue);\n    }\n\n    return strValue;\n  };\n\n  XNumber.prototype.evaluate = function (c) {\n    return this;\n  };\n\n  XNumber.prototype.string = function () {\n    return new XString(this.toString());\n  };\n\n  XNumber.prototype.number = function () {\n    return this;\n  };\n\n  XNumber.prototype.bool = function () {\n    return new XBoolean(this.num);\n  };\n\n  XNumber.prototype.nodeset = function () {\n    throw new Error(\"Cannot convert number to nodeset\");\n  };\n\n  XNumber.prototype.stringValue = function () {\n    return this.string().stringValue();\n  };\n\n  XNumber.prototype.numberValue = function () {\n    return this.num;\n  };\n\n  XNumber.prototype.booleanValue = function () {\n    return this.bool().booleanValue();\n  };\n\n  XNumber.prototype.negate = function () {\n    return new XNumber(-this.num);\n  };\n\n  XNumber.prototype.equals = function (r) {\n    if (Utilities.instance_of(r, XBoolean)) {\n      return this.bool().equals(r);\n    }\n\n    if (Utilities.instance_of(r, XString)) {\n      return this.equals(r.number());\n    }\n\n    if (Utilities.instance_of(r, XNodeSet)) {\n      return r.compareWithNumber(this, Operators.equals);\n    }\n\n    return new XBoolean(this.num == r.num);\n  };\n\n  XNumber.prototype.notequal = function (r) {\n    if (Utilities.instance_of(r, XBoolean)) {\n      return this.bool().notequal(r);\n    }\n\n    if (Utilities.instance_of(r, XString)) {\n      return this.notequal(r.number());\n    }\n\n    if (Utilities.instance_of(r, XNodeSet)) {\n      return r.compareWithNumber(this, Operators.notequal);\n    }\n\n    return new XBoolean(this.num != r.num);\n  };\n\n  XNumber.prototype.lessthan = function (r) {\n    if (Utilities.instance_of(r, XNodeSet)) {\n      return r.compareWithNumber(this, Operators.greaterthan);\n    }\n\n    if (Utilities.instance_of(r, XBoolean) || Utilities.instance_of(r, XString)) {\n      return this.lessthan(r.number());\n    }\n\n    return new XBoolean(this.num < r.num);\n  };\n\n  XNumber.prototype.greaterthan = function (r) {\n    if (Utilities.instance_of(r, XNodeSet)) {\n      return r.compareWithNumber(this, Operators.lessthan);\n    }\n\n    if (Utilities.instance_of(r, XBoolean) || Utilities.instance_of(r, XString)) {\n      return this.greaterthan(r.number());\n    }\n\n    return new XBoolean(this.num > r.num);\n  };\n\n  XNumber.prototype.lessthanorequal = function (r) {\n    if (Utilities.instance_of(r, XNodeSet)) {\n      return r.compareWithNumber(this, Operators.greaterthanorequal);\n    }\n\n    if (Utilities.instance_of(r, XBoolean) || Utilities.instance_of(r, XString)) {\n      return this.lessthanorequal(r.number());\n    }\n\n    return new XBoolean(this.num <= r.num);\n  };\n\n  XNumber.prototype.greaterthanorequal = function (r) {\n    if (Utilities.instance_of(r, XNodeSet)) {\n      return r.compareWithNumber(this, Operators.lessthanorequal);\n    }\n\n    if (Utilities.instance_of(r, XBoolean) || Utilities.instance_of(r, XString)) {\n      return this.greaterthanorequal(r.number());\n    }\n\n    return new XBoolean(this.num >= r.num);\n  };\n\n  XNumber.prototype.plus = function (r) {\n    return new XNumber(this.num + r.num);\n  };\n\n  XNumber.prototype.minus = function (r) {\n    return new XNumber(this.num - r.num);\n  };\n\n  XNumber.prototype.multiply = function (r) {\n    return new XNumber(this.num * r.num);\n  };\n\n  XNumber.prototype.div = function (r) {\n    return new XNumber(this.num / r.num);\n  };\n\n  XNumber.prototype.mod = function (r) {\n    return new XNumber(this.num % r.num);\n  }; // XBoolean //////////////////////////////////////////////////////////////////\n\n\n  XBoolean.prototype = new Expression();\n  XBoolean.prototype.constructor = XBoolean;\n  XBoolean.superclass = Expression.prototype;\n\n  function XBoolean(b) {\n    if (arguments.length > 0) {\n      this.init(b);\n    }\n  }\n\n  XBoolean.prototype.init = function (b) {\n    this.b = Boolean(b);\n  };\n\n  XBoolean.prototype.toString = function () {\n    return this.b.toString();\n  };\n\n  XBoolean.prototype.evaluate = function (c) {\n    return this;\n  };\n\n  XBoolean.prototype.string = function () {\n    return new XString(this.b);\n  };\n\n  XBoolean.prototype.number = function () {\n    return new XNumber(this.b);\n  };\n\n  XBoolean.prototype.bool = function () {\n    return this;\n  };\n\n  XBoolean.prototype.nodeset = function () {\n    throw new Error(\"Cannot convert boolean to nodeset\");\n  };\n\n  XBoolean.prototype.stringValue = function () {\n    return this.string().stringValue();\n  };\n\n  XBoolean.prototype.numberValue = function () {\n    return this.number().numberValue();\n  };\n\n  XBoolean.prototype.booleanValue = function () {\n    return this.b;\n  };\n\n  XBoolean.prototype.not = function () {\n    return new XBoolean(!this.b);\n  };\n\n  XBoolean.prototype.equals = function (r) {\n    if (Utilities.instance_of(r, XString) || Utilities.instance_of(r, XNumber)) {\n      return this.equals(r.bool());\n    }\n\n    if (Utilities.instance_of(r, XNodeSet)) {\n      return r.compareWithBoolean(this, Operators.equals);\n    }\n\n    return new XBoolean(this.b == r.b);\n  };\n\n  XBoolean.prototype.notequal = function (r) {\n    if (Utilities.instance_of(r, XString) || Utilities.instance_of(r, XNumber)) {\n      return this.notequal(r.bool());\n    }\n\n    if (Utilities.instance_of(r, XNodeSet)) {\n      return r.compareWithBoolean(this, Operators.notequal);\n    }\n\n    return new XBoolean(this.b != r.b);\n  };\n\n  XBoolean.prototype.lessthan = function (r) {\n    return this.number().lessthan(r);\n  };\n\n  XBoolean.prototype.greaterthan = function (r) {\n    return this.number().greaterthan(r);\n  };\n\n  XBoolean.prototype.lessthanorequal = function (r) {\n    return this.number().lessthanorequal(r);\n  };\n\n  XBoolean.prototype.greaterthanorequal = function (r) {\n    return this.number().greaterthanorequal(r);\n  };\n\n  XBoolean.true_ = new XBoolean(true);\n  XBoolean.false_ = new XBoolean(false); // AVLTree ///////////////////////////////////////////////////////////////////\n\n  AVLTree.prototype = new Object();\n  AVLTree.prototype.constructor = AVLTree;\n  AVLTree.superclass = Object.prototype;\n\n  function AVLTree(n) {\n    this.init(n);\n  }\n\n  AVLTree.prototype.init = function (n) {\n    this.left = null;\n    this.right = null;\n    this.node = n;\n    this.depth = 1;\n  };\n\n  AVLTree.prototype.balance = function () {\n    var ldepth = this.left == null ? 0 : this.left.depth;\n    var rdepth = this.right == null ? 0 : this.right.depth;\n\n    if (ldepth > rdepth + 1) {\n      // LR or LL rotation\n      var lldepth = this.left.left == null ? 0 : this.left.left.depth;\n      var lrdepth = this.left.right == null ? 0 : this.left.right.depth;\n\n      if (lldepth < lrdepth) {\n        // LR rotation consists of a RR rotation of the left child\n        this.left.rotateRR(); // plus a LL rotation of this node, which happens anyway\n      }\n\n      this.rotateLL();\n    } else if (ldepth + 1 < rdepth) {\n      // RR or RL rorarion\n      var rrdepth = this.right.right == null ? 0 : this.right.right.depth;\n      var rldepth = this.right.left == null ? 0 : this.right.left.depth;\n\n      if (rldepth > rrdepth) {\n        // RR rotation consists of a LL rotation of the right child\n        this.right.rotateLL(); // plus a RR rotation of this node, which happens anyway\n      }\n\n      this.rotateRR();\n    }\n  };\n\n  AVLTree.prototype.rotateLL = function () {\n    // the left side is too long => rotate from the left (_not_ leftwards)\n    var nodeBefore = this.node;\n    var rightBefore = this.right;\n    this.node = this.left.node;\n    this.right = this.left;\n    this.left = this.left.left;\n    this.right.left = this.right.right;\n    this.right.right = rightBefore;\n    this.right.node = nodeBefore;\n    this.right.updateInNewLocation();\n    this.updateInNewLocation();\n  };\n\n  AVLTree.prototype.rotateRR = function () {\n    // the right side is too long => rotate from the right (_not_ rightwards)\n    var nodeBefore = this.node;\n    var leftBefore = this.left;\n    this.node = this.right.node;\n    this.left = this.right;\n    this.right = this.right.right;\n    this.left.right = this.left.left;\n    this.left.left = leftBefore;\n    this.left.node = nodeBefore;\n    this.left.updateInNewLocation();\n    this.updateInNewLocation();\n  };\n\n  AVLTree.prototype.updateInNewLocation = function () {\n    this.getDepthFromChildren();\n  };\n\n  AVLTree.prototype.getDepthFromChildren = function () {\n    this.depth = this.node == null ? 0 : 1;\n\n    if (this.left != null) {\n      this.depth = this.left.depth + 1;\n    }\n\n    if (this.right != null && this.depth <= this.right.depth) {\n      this.depth = this.right.depth + 1;\n    }\n  };\n\n  function nodeOrder(n1, n2) {\n    if (n1 === n2) {\n      return 0;\n    }\n\n    if (n1.compareDocumentPosition) {\n      var cpos = n1.compareDocumentPosition(n2);\n\n      if (cpos & 0x01) {\n        // not in the same document; return an arbitrary result (is there a better way to do this)\n        return 1;\n      }\n\n      if (cpos & 0x0A) {\n        // n2 precedes or contains n1\n        return 1;\n      }\n\n      if (cpos & 0x14) {\n        // n2 follows or is contained by n1\n        return -1;\n      }\n\n      return 0;\n    }\n\n    var d1 = 0,\n        d2 = 0;\n\n    for (var m1 = n1; m1 != null; m1 = m1.parentNode || m1.ownerElement) {\n      d1++;\n    }\n\n    for (var m2 = n2; m2 != null; m2 = m2.parentNode || m2.ownerElement) {\n      d2++;\n    } // step up to same depth\n\n\n    if (d1 > d2) {\n      while (d1 > d2) {\n        n1 = n1.parentNode || n1.ownerElement;\n        d1--;\n      }\n\n      if (n1 === n2) {\n        return 1;\n      }\n    } else if (d2 > d1) {\n      while (d2 > d1) {\n        n2 = n2.parentNode || n2.ownerElement;\n        d2--;\n      }\n\n      if (n1 === n2) {\n        return -1;\n      }\n    }\n\n    var n1Par = n1.parentNode || n1.ownerElement,\n        n2Par = n2.parentNode || n2.ownerElement; // find common parent\n\n    while (n1Par !== n2Par) {\n      n1 = n1Par;\n      n2 = n2Par;\n      n1Par = n1.parentNode || n1.ownerElement;\n      n2Par = n2.parentNode || n2.ownerElement;\n    }\n\n    var n1isAttr = Utilities.isAttribute(n1);\n    var n2isAttr = Utilities.isAttribute(n2);\n\n    if (n1isAttr && !n2isAttr) {\n      return -1;\n    }\n\n    if (!n1isAttr && n2isAttr) {\n      return 1;\n    }\n\n    if (n1Par) {\n      var cn = n1isAttr ? n1Par.attributes : n1Par.childNodes,\n          len = cn.length;\n\n      for (var i = 0; i < len; i += 1) {\n        var n = cn[i];\n\n        if (n === n1) {\n          return -1;\n        }\n\n        if (n === n2) {\n          return 1;\n        }\n      }\n    }\n\n    throw new Error('Unexpected: could not determine node order');\n  }\n\n  AVLTree.prototype.add = function (n) {\n    if (n === this.node) {\n      return false;\n    }\n\n    var o = nodeOrder(n, this.node);\n    var ret = false;\n\n    if (o == -1) {\n      if (this.left == null) {\n        this.left = new AVLTree(n);\n        ret = true;\n      } else {\n        ret = this.left.add(n);\n\n        if (ret) {\n          this.balance();\n        }\n      }\n    } else if (o == 1) {\n      if (this.right == null) {\n        this.right = new AVLTree(n);\n        ret = true;\n      } else {\n        ret = this.right.add(n);\n\n        if (ret) {\n          this.balance();\n        }\n      }\n    }\n\n    if (ret) {\n      this.getDepthFromChildren();\n    }\n\n    return ret;\n  }; // XNodeSet //////////////////////////////////////////////////////////////////\n\n\n  XNodeSet.prototype = new Expression();\n  XNodeSet.prototype.constructor = XNodeSet;\n  XNodeSet.superclass = Expression.prototype;\n\n  function XNodeSet() {\n    this.init();\n  }\n\n  XNodeSet.prototype.init = function () {\n    this.tree = null;\n    this.nodes = [];\n    this.size = 0;\n  };\n\n  XNodeSet.prototype.toString = function () {\n    var p = this.first();\n\n    if (p == null) {\n      return \"\";\n    }\n\n    return this.stringForNode(p);\n  };\n\n  XNodeSet.prototype.evaluate = function (c) {\n    return this;\n  };\n\n  XNodeSet.prototype.string = function () {\n    return new XString(this.toString());\n  };\n\n  XNodeSet.prototype.stringValue = function () {\n    return this.toString();\n  };\n\n  XNodeSet.prototype.number = function () {\n    return new XNumber(this.string());\n  };\n\n  XNodeSet.prototype.numberValue = function () {\n    return Number(this.string());\n  };\n\n  XNodeSet.prototype.bool = function () {\n    return new XBoolean(this.booleanValue());\n  };\n\n  XNodeSet.prototype.booleanValue = function () {\n    return !!this.size;\n  };\n\n  XNodeSet.prototype.nodeset = function () {\n    return this;\n  };\n\n  XNodeSet.prototype.stringForNode = function (n) {\n    if (n.nodeType == 9\n    /*Node.DOCUMENT_NODE*/\n    || n.nodeType == 1\n    /*Node.ELEMENT_NODE */\n    || n.nodeType === 11\n    /*Node.DOCUMENT_FRAGMENT*/\n    ) {\n        return this.stringForContainerNode(n);\n      }\n\n    if (n.nodeType === 2\n    /* Node.ATTRIBUTE_NODE */\n    ) {\n        return n.value || n.nodeValue;\n      }\n\n    if (n.isNamespaceNode) {\n      return n.namespace;\n    }\n\n    return n.nodeValue;\n  };\n\n  XNodeSet.prototype.stringForContainerNode = function (n) {\n    var s = \"\";\n\n    for (var n2 = n.firstChild; n2 != null; n2 = n2.nextSibling) {\n      var nt = n2.nodeType; //  Element,    Text,       CDATA,      Document,   Document Fragment\n\n      if (nt === 1 || nt === 3 || nt === 4 || nt === 9 || nt === 11) {\n        s += this.stringForNode(n2);\n      }\n    }\n\n    return s;\n  };\n\n  XNodeSet.prototype.buildTree = function () {\n    if (!this.tree && this.nodes.length) {\n      this.tree = new AVLTree(this.nodes[0]);\n\n      for (var i = 1; i < this.nodes.length; i += 1) {\n        this.tree.add(this.nodes[i]);\n      }\n    }\n\n    return this.tree;\n  };\n\n  XNodeSet.prototype.first = function () {\n    var p = this.buildTree();\n\n    if (p == null) {\n      return null;\n    }\n\n    while (p.left != null) {\n      p = p.left;\n    }\n\n    return p.node;\n  };\n\n  XNodeSet.prototype.add = function (n) {\n    for (var i = 0; i < this.nodes.length; i += 1) {\n      if (n === this.nodes[i]) {\n        return;\n      }\n    }\n\n    this.tree = null;\n    this.nodes.push(n);\n    this.size += 1;\n  };\n\n  XNodeSet.prototype.addArray = function (ns) {\n    var self = this;\n    forEach(function (x) {\n      self.add(x);\n    }, ns);\n  };\n  /**\r\n   * Returns an array of the node set's contents in document order\r\n   */\n\n\n  XNodeSet.prototype.toArray = function () {\n    var a = [];\n    this.toArrayRec(this.buildTree(), a);\n    return a;\n  };\n\n  XNodeSet.prototype.toArrayRec = function (t, a) {\n    if (t != null) {\n      this.toArrayRec(t.left, a);\n      a.push(t.node);\n      this.toArrayRec(t.right, a);\n    }\n  };\n  /**\r\n   * Returns an array of the node set's contents in arbitrary order\r\n   */\n\n\n  XNodeSet.prototype.toUnsortedArray = function () {\n    return this.nodes.slice();\n  };\n\n  XNodeSet.prototype.compareWithString = function (r, o) {\n    var a = this.toUnsortedArray();\n\n    for (var i = 0; i < a.length; i++) {\n      var n = a[i];\n      var l = new XString(this.stringForNode(n));\n      var res = o(l, r);\n\n      if (res.booleanValue()) {\n        return res;\n      }\n    }\n\n    return new XBoolean(false);\n  };\n\n  XNodeSet.prototype.compareWithNumber = function (r, o) {\n    var a = this.toUnsortedArray();\n\n    for (var i = 0; i < a.length; i++) {\n      var n = a[i];\n      var l = new XNumber(this.stringForNode(n));\n      var res = o(l, r);\n\n      if (res.booleanValue()) {\n        return res;\n      }\n    }\n\n    return new XBoolean(false);\n  };\n\n  XNodeSet.prototype.compareWithBoolean = function (r, o) {\n    return o(this.bool(), r);\n  };\n\n  XNodeSet.prototype.compareWithNodeSet = function (r, o) {\n    var arr = this.toUnsortedArray();\n\n    var oInvert = function oInvert(lop, rop) {\n      return o(rop, lop);\n    };\n\n    for (var i = 0; i < arr.length; i++) {\n      var l = new XString(this.stringForNode(arr[i]));\n      var res = r.compareWithString(l, oInvert);\n\n      if (res.booleanValue()) {\n        return res;\n      }\n    }\n\n    return new XBoolean(false);\n  };\n\n  XNodeSet.compareWith = curry(function (o, r) {\n    if (Utilities.instance_of(r, XString)) {\n      return this.compareWithString(r, o);\n    }\n\n    if (Utilities.instance_of(r, XNumber)) {\n      return this.compareWithNumber(r, o);\n    }\n\n    if (Utilities.instance_of(r, XBoolean)) {\n      return this.compareWithBoolean(r, o);\n    }\n\n    return this.compareWithNodeSet(r, o);\n  });\n  XNodeSet.prototype.equals = XNodeSet.compareWith(Operators.equals);\n  XNodeSet.prototype.notequal = XNodeSet.compareWith(Operators.notequal);\n  XNodeSet.prototype.lessthan = XNodeSet.compareWith(Operators.lessthan);\n  XNodeSet.prototype.greaterthan = XNodeSet.compareWith(Operators.greaterthan);\n  XNodeSet.prototype.lessthanorequal = XNodeSet.compareWith(Operators.lessthanorequal);\n  XNodeSet.prototype.greaterthanorequal = XNodeSet.compareWith(Operators.greaterthanorequal);\n\n  XNodeSet.prototype.union = function (r) {\n    var ns = new XNodeSet();\n    ns.addArray(this.toUnsortedArray());\n    ns.addArray(r.toUnsortedArray());\n    return ns;\n  }; // XPathNamespace ////////////////////////////////////////////////////////////\n\n\n  XPathNamespace.prototype = new Object();\n  XPathNamespace.prototype.constructor = XPathNamespace;\n  XPathNamespace.superclass = Object.prototype;\n\n  function XPathNamespace(pre, ns, p) {\n    this.isXPathNamespace = true;\n    this.ownerDocument = p.ownerDocument;\n    this.nodeName = \"#namespace\";\n    this.prefix = pre;\n    this.localName = pre;\n    this.namespaceURI = ns;\n    this.nodeValue = ns;\n    this.ownerElement = p;\n    this.nodeType = XPathNamespace.XPATH_NAMESPACE_NODE;\n  }\n\n  XPathNamespace.prototype.toString = function () {\n    return \"{ \\\"\" + this.prefix + \"\\\", \\\"\" + this.namespaceURI + \"\\\" }\";\n  }; // XPathContext //////////////////////////////////////////////////////////////\n\n\n  XPathContext.prototype = new Object();\n  XPathContext.prototype.constructor = XPathContext;\n  XPathContext.superclass = Object.prototype;\n\n  function XPathContext(vr, nr, fr) {\n    this.variableResolver = vr != null ? vr : new VariableResolver();\n    this.namespaceResolver = nr != null ? nr : new NamespaceResolver();\n    this.functionResolver = fr != null ? fr : new FunctionResolver();\n  }\n\n  XPathContext.prototype.extend = function (newProps) {\n    return assign(new XPathContext(), this, newProps);\n  }; // VariableResolver //////////////////////////////////////////////////////////\n\n\n  VariableResolver.prototype = new Object();\n  VariableResolver.prototype.constructor = VariableResolver;\n  VariableResolver.superclass = Object.prototype;\n\n  function VariableResolver() {}\n\n  VariableResolver.prototype.getVariable = function (ln, ns) {\n    return null;\n  }; // FunctionResolver //////////////////////////////////////////////////////////\n\n\n  FunctionResolver.prototype = new Object();\n  FunctionResolver.prototype.constructor = FunctionResolver;\n  FunctionResolver.superclass = Object.prototype;\n\n  function FunctionResolver(thisArg) {\n    this.thisArg = thisArg != null ? thisArg : Functions;\n    this.functions = new Object();\n    this.addStandardFunctions();\n  }\n\n  FunctionResolver.prototype.addStandardFunctions = function () {\n    this.functions[\"{}last\"] = Functions.last;\n    this.functions[\"{}position\"] = Functions.position;\n    this.functions[\"{}count\"] = Functions.count;\n    this.functions[\"{}id\"] = Functions.id;\n    this.functions[\"{}local-name\"] = Functions.localName;\n    this.functions[\"{}namespace-uri\"] = Functions.namespaceURI;\n    this.functions[\"{}name\"] = Functions.name;\n    this.functions[\"{}string\"] = Functions.string;\n    this.functions[\"{}concat\"] = Functions.concat;\n    this.functions[\"{}starts-with\"] = Functions.startsWith;\n    this.functions[\"{}contains\"] = Functions.contains;\n    this.functions[\"{}substring-before\"] = Functions.substringBefore;\n    this.functions[\"{}substring-after\"] = Functions.substringAfter;\n    this.functions[\"{}substring\"] = Functions.substring;\n    this.functions[\"{}string-length\"] = Functions.stringLength;\n    this.functions[\"{}normalize-space\"] = Functions.normalizeSpace;\n    this.functions[\"{}translate\"] = Functions.translate;\n    this.functions[\"{}boolean\"] = Functions.boolean_;\n    this.functions[\"{}not\"] = Functions.not;\n    this.functions[\"{}true\"] = Functions.true_;\n    this.functions[\"{}false\"] = Functions.false_;\n    this.functions[\"{}lang\"] = Functions.lang;\n    this.functions[\"{}number\"] = Functions.number;\n    this.functions[\"{}sum\"] = Functions.sum;\n    this.functions[\"{}floor\"] = Functions.floor;\n    this.functions[\"{}ceiling\"] = Functions.ceiling;\n    this.functions[\"{}round\"] = Functions.round;\n  };\n\n  FunctionResolver.prototype.addFunction = function (ns, ln, f) {\n    this.functions[\"{\" + ns + \"}\" + ln] = f;\n  };\n\n  FunctionResolver.getFunctionFromContext = function (qName, context) {\n    var parts = Utilities.resolveQName(qName, context.namespaceResolver, context.contextNode, false);\n\n    if (parts[0] === null) {\n      throw new Error(\"Cannot resolve QName \" + name);\n    }\n\n    return context.functionResolver.getFunction(parts[1], parts[0]);\n  };\n\n  FunctionResolver.prototype.getFunction = function (localName, namespace) {\n    return this.functions[\"{\" + namespace + \"}\" + localName];\n  }; // NamespaceResolver /////////////////////////////////////////////////////////\n\n\n  NamespaceResolver.prototype = new Object();\n  NamespaceResolver.prototype.constructor = NamespaceResolver;\n  NamespaceResolver.superclass = Object.prototype;\n\n  function NamespaceResolver() {}\n\n  NamespaceResolver.prototype.getNamespace = function (prefix, n) {\n    if (prefix == \"xml\") {\n      return XPath.XML_NAMESPACE_URI;\n    } else if (prefix == \"xmlns\") {\n      return XPath.XMLNS_NAMESPACE_URI;\n    }\n\n    if (n.nodeType == 9\n    /*Node.DOCUMENT_NODE*/\n    ) {\n        n = n.documentElement;\n      } else if (n.nodeType == 2\n    /*Node.ATTRIBUTE_NODE*/\n    ) {\n        n = PathExpr.getOwnerElement(n);\n      } else if (n.nodeType != 1\n    /*Node.ELEMENT_NODE*/\n    ) {\n        n = n.parentNode;\n      }\n\n    while (n != null && n.nodeType == 1\n    /*Node.ELEMENT_NODE*/\n    ) {\n      var nnm = n.attributes;\n\n      for (var i = 0; i < nnm.length; i++) {\n        var a = nnm.item(i);\n        var aname = a.name || a.nodeName;\n\n        if (aname === \"xmlns\" && prefix === \"\" || aname === \"xmlns:\" + prefix) {\n          return String(a.value || a.nodeValue);\n        }\n      }\n\n      n = n.parentNode;\n    }\n\n    return null;\n  }; // Functions /////////////////////////////////////////////////////////////////\n\n\n  var Functions = new Object();\n\n  Functions.last = function (c) {\n    if (arguments.length != 1) {\n      throw new Error(\"Function last expects ()\");\n    }\n\n    return new XNumber(c.contextSize);\n  };\n\n  Functions.position = function (c) {\n    if (arguments.length != 1) {\n      throw new Error(\"Function position expects ()\");\n    }\n\n    return new XNumber(c.contextPosition);\n  };\n\n  Functions.count = function () {\n    var c = arguments[0];\n    var ns;\n\n    if (arguments.length != 2 || !Utilities.instance_of(ns = arguments[1].evaluate(c), XNodeSet)) {\n      throw new Error(\"Function count expects (node-set)\");\n    }\n\n    return new XNumber(ns.size);\n  };\n\n  Functions.id = function () {\n    var c = arguments[0];\n    var id;\n\n    if (arguments.length != 2) {\n      throw new Error(\"Function id expects (object)\");\n    }\n\n    id = arguments[1].evaluate(c);\n\n    if (Utilities.instance_of(id, XNodeSet)) {\n      id = id.toArray().join(\" \");\n    } else {\n      id = id.stringValue();\n    }\n\n    var ids = id.split(/[\\x0d\\x0a\\x09\\x20]+/);\n    var count = 0;\n    var ns = new XNodeSet();\n    var doc = c.contextNode.nodeType == 9\n    /*Node.DOCUMENT_NODE*/\n    ? c.contextNode : c.contextNode.ownerDocument;\n\n    for (var i = 0; i < ids.length; i++) {\n      var n;\n\n      if (doc.getElementById) {\n        n = doc.getElementById(ids[i]);\n      } else {\n        n = Utilities.getElementById(doc, ids[i]);\n      }\n\n      if (n != null) {\n        ns.add(n);\n        count++;\n      }\n    }\n\n    return ns;\n  };\n\n  Functions.localName = function (c, eNode) {\n    var n;\n\n    if (arguments.length == 1) {\n      n = c.contextNode;\n    } else if (arguments.length == 2) {\n      n = eNode.evaluate(c).first();\n    } else {\n      throw new Error(\"Function local-name expects (node-set?)\");\n    }\n\n    if (n == null) {\n      return new XString(\"\");\n    }\n\n    return new XString(n.localName || //  standard elements and attributes\n    n.baseName || //  IE\n    n.target || //  processing instructions\n    n.nodeName || //  DOM1 elements\n    \"\"); //  fallback\n  };\n\n  Functions.namespaceURI = function () {\n    var c = arguments[0];\n    var n;\n\n    if (arguments.length == 1) {\n      n = c.contextNode;\n    } else if (arguments.length == 2) {\n      n = arguments[1].evaluate(c).first();\n    } else {\n      throw new Error(\"Function namespace-uri expects (node-set?)\");\n    }\n\n    if (n == null) {\n      return new XString(\"\");\n    }\n\n    return new XString(n.namespaceURI);\n  };\n\n  Functions.name = function () {\n    var c = arguments[0];\n    var n;\n\n    if (arguments.length == 1) {\n      n = c.contextNode;\n    } else if (arguments.length == 2) {\n      n = arguments[1].evaluate(c).first();\n    } else {\n      throw new Error(\"Function name expects (node-set?)\");\n    }\n\n    if (n == null) {\n      return new XString(\"\");\n    }\n\n    if (n.nodeType == 1\n    /*Node.ELEMENT_NODE*/\n    ) {\n        return new XString(n.nodeName);\n      } else if (n.nodeType == 2\n    /*Node.ATTRIBUTE_NODE*/\n    ) {\n        return new XString(n.name || n.nodeName);\n      } else if (n.nodeType === 7\n    /*Node.PROCESSING_INSTRUCTION_NODE*/\n    ) {\n        return new XString(n.target || n.nodeName);\n      } else if (n.localName == null) {\n      return new XString(\"\");\n    } else {\n      return new XString(n.localName);\n    }\n  };\n\n  Functions.string = function () {\n    var c = arguments[0];\n\n    if (arguments.length == 1) {\n      return new XString(XNodeSet.prototype.stringForNode(c.contextNode));\n    } else if (arguments.length == 2) {\n      return arguments[1].evaluate(c).string();\n    }\n\n    throw new Error(\"Function string expects (object?)\");\n  };\n\n  Functions.concat = function (c) {\n    if (arguments.length < 3) {\n      throw new Error(\"Function concat expects (string, string[, string]*)\");\n    }\n\n    var s = \"\";\n\n    for (var i = 1; i < arguments.length; i++) {\n      s += arguments[i].evaluate(c).stringValue();\n    }\n\n    return new XString(s);\n  };\n\n  Functions.startsWith = function () {\n    var c = arguments[0];\n\n    if (arguments.length != 3) {\n      throw new Error(\"Function startsWith expects (string, string)\");\n    }\n\n    var s1 = arguments[1].evaluate(c).stringValue();\n    var s2 = arguments[2].evaluate(c).stringValue();\n    return new XBoolean(s1.substring(0, s2.length) == s2);\n  };\n\n  Functions.contains = function () {\n    var c = arguments[0];\n\n    if (arguments.length != 3) {\n      throw new Error(\"Function contains expects (string, string)\");\n    }\n\n    var s1 = arguments[1].evaluate(c).stringValue();\n    var s2 = arguments[2].evaluate(c).stringValue();\n    return new XBoolean(s1.indexOf(s2) !== -1);\n  };\n\n  Functions.substringBefore = function () {\n    var c = arguments[0];\n\n    if (arguments.length != 3) {\n      throw new Error(\"Function substring-before expects (string, string)\");\n    }\n\n    var s1 = arguments[1].evaluate(c).stringValue();\n    var s2 = arguments[2].evaluate(c).stringValue();\n    return new XString(s1.substring(0, s1.indexOf(s2)));\n  };\n\n  Functions.substringAfter = function () {\n    var c = arguments[0];\n\n    if (arguments.length != 3) {\n      throw new Error(\"Function substring-after expects (string, string)\");\n    }\n\n    var s1 = arguments[1].evaluate(c).stringValue();\n    var s2 = arguments[2].evaluate(c).stringValue();\n\n    if (s2.length == 0) {\n      return new XString(s1);\n    }\n\n    var i = s1.indexOf(s2);\n\n    if (i == -1) {\n      return new XString(\"\");\n    }\n\n    return new XString(s1.substring(i + s2.length));\n  };\n\n  Functions.substring = function () {\n    var c = arguments[0];\n\n    if (!(arguments.length == 3 || arguments.length == 4)) {\n      throw new Error(\"Function substring expects (string, number, number?)\");\n    }\n\n    var s = arguments[1].evaluate(c).stringValue();\n    var n1 = Math.round(arguments[2].evaluate(c).numberValue()) - 1;\n    var n2 = arguments.length == 4 ? n1 + Math.round(arguments[3].evaluate(c).numberValue()) : undefined;\n    return new XString(s.substring(n1, n2));\n  };\n\n  Functions.stringLength = function () {\n    var c = arguments[0];\n    var s;\n\n    if (arguments.length == 1) {\n      s = XNodeSet.prototype.stringForNode(c.contextNode);\n    } else if (arguments.length == 2) {\n      s = arguments[1].evaluate(c).stringValue();\n    } else {\n      throw new Error(\"Function string-length expects (string?)\");\n    }\n\n    return new XNumber(s.length);\n  };\n\n  Functions.normalizeSpace = function () {\n    var c = arguments[0];\n    var s;\n\n    if (arguments.length == 1) {\n      s = XNodeSet.prototype.stringForNode(c.contextNode);\n    } else if (arguments.length == 2) {\n      s = arguments[1].evaluate(c).stringValue();\n    } else {\n      throw new Error(\"Function normalize-space expects (string?)\");\n    }\n\n    var i = 0;\n    var j = s.length - 1;\n\n    while (Utilities.isSpace(s.charCodeAt(j))) {\n      j--;\n    }\n\n    var t = \"\";\n\n    while (i <= j && Utilities.isSpace(s.charCodeAt(i))) {\n      i++;\n    }\n\n    while (i <= j) {\n      if (Utilities.isSpace(s.charCodeAt(i))) {\n        t += \" \";\n\n        while (i <= j && Utilities.isSpace(s.charCodeAt(i))) {\n          i++;\n        }\n      } else {\n        t += s.charAt(i);\n        i++;\n      }\n    }\n\n    return new XString(t);\n  };\n\n  Functions.translate = function (c, eValue, eFrom, eTo) {\n    if (arguments.length != 4) {\n      throw new Error(\"Function translate expects (string, string, string)\");\n    }\n\n    var value = eValue.evaluate(c).stringValue();\n    var from = eFrom.evaluate(c).stringValue();\n    var to = eTo.evaluate(c).stringValue();\n    var cMap = reduce(function (acc, ch, i) {\n      if (!(ch in acc)) {\n        acc[ch] = i > to.length ? '' : to[i];\n      }\n\n      return acc;\n    }, {}, from);\n    var t = join('', map(function (ch) {\n      return ch in cMap ? cMap[ch] : ch;\n    }, value));\n    return new XString(t);\n  };\n\n  Functions.boolean_ = function () {\n    var c = arguments[0];\n\n    if (arguments.length != 2) {\n      throw new Error(\"Function boolean expects (object)\");\n    }\n\n    return arguments[1].evaluate(c).bool();\n  };\n\n  Functions.not = function (c, eValue) {\n    if (arguments.length != 2) {\n      throw new Error(\"Function not expects (object)\");\n    }\n\n    return eValue.evaluate(c).bool().not();\n  };\n\n  Functions.true_ = function () {\n    if (arguments.length != 1) {\n      throw new Error(\"Function true expects ()\");\n    }\n\n    return XBoolean.true_;\n  };\n\n  Functions.false_ = function () {\n    if (arguments.length != 1) {\n      throw new Error(\"Function false expects ()\");\n    }\n\n    return XBoolean.false_;\n  };\n\n  Functions.lang = function () {\n    var c = arguments[0];\n\n    if (arguments.length != 2) {\n      throw new Error(\"Function lang expects (string)\");\n    }\n\n    var lang;\n\n    for (var n = c.contextNode; n != null && n.nodeType != 9\n    /*Node.DOCUMENT_NODE*/\n    ; n = n.parentNode) {\n      var a = n.getAttributeNS(XPath.XML_NAMESPACE_URI, \"lang\");\n\n      if (a != null) {\n        lang = String(a);\n        break;\n      }\n    }\n\n    if (lang == null) {\n      return XBoolean.false_;\n    }\n\n    var s = arguments[1].evaluate(c).stringValue();\n    return new XBoolean(lang.substring(0, s.length) == s && (lang.length == s.length || lang.charAt(s.length) == '-'));\n  };\n\n  Functions.number = function () {\n    var c = arguments[0];\n\n    if (!(arguments.length == 1 || arguments.length == 2)) {\n      throw new Error(\"Function number expects (object?)\");\n    }\n\n    if (arguments.length == 1) {\n      return new XNumber(XNodeSet.prototype.stringForNode(c.contextNode));\n    }\n\n    return arguments[1].evaluate(c).number();\n  };\n\n  Functions.sum = function () {\n    var c = arguments[0];\n    var ns;\n\n    if (arguments.length != 2 || !Utilities.instance_of(ns = arguments[1].evaluate(c), XNodeSet)) {\n      throw new Error(\"Function sum expects (node-set)\");\n    }\n\n    ns = ns.toUnsortedArray();\n    var n = 0;\n\n    for (var i = 0; i < ns.length; i++) {\n      n += new XNumber(XNodeSet.prototype.stringForNode(ns[i])).numberValue();\n    }\n\n    return new XNumber(n);\n  };\n\n  Functions.floor = function () {\n    var c = arguments[0];\n\n    if (arguments.length != 2) {\n      throw new Error(\"Function floor expects (number)\");\n    }\n\n    return new XNumber(Math.floor(arguments[1].evaluate(c).numberValue()));\n  };\n\n  Functions.ceiling = function () {\n    var c = arguments[0];\n\n    if (arguments.length != 2) {\n      throw new Error(\"Function ceiling expects (number)\");\n    }\n\n    return new XNumber(Math.ceil(arguments[1].evaluate(c).numberValue()));\n  };\n\n  Functions.round = function () {\n    var c = arguments[0];\n\n    if (arguments.length != 2) {\n      throw new Error(\"Function round expects (number)\");\n    }\n\n    return new XNumber(Math.round(arguments[1].evaluate(c).numberValue()));\n  }; // Utilities /////////////////////////////////////////////////////////////////\n\n\n  var Utilities = new Object();\n\n  Utilities.isAttribute = function (val) {\n    return val && (val.nodeType === 2 || val.ownerElement);\n  };\n\n  Utilities.splitQName = function (qn) {\n    var i = qn.indexOf(\":\");\n\n    if (i == -1) {\n      return [null, qn];\n    }\n\n    return [qn.substring(0, i), qn.substring(i + 1)];\n  };\n\n  Utilities.resolveQName = function (qn, nr, n, useDefault) {\n    var parts = Utilities.splitQName(qn);\n\n    if (parts[0] != null) {\n      parts[0] = nr.getNamespace(parts[0], n);\n    } else {\n      if (useDefault) {\n        parts[0] = nr.getNamespace(\"\", n);\n\n        if (parts[0] == null) {\n          parts[0] = \"\";\n        }\n      } else {\n        parts[0] = \"\";\n      }\n    }\n\n    return parts;\n  };\n\n  Utilities.isSpace = function (c) {\n    return c == 0x9 || c == 0xd || c == 0xa || c == 0x20;\n  };\n\n  Utilities.isLetter = function (c) {\n    return c >= 0x0041 && c <= 0x005A || c >= 0x0061 && c <= 0x007A || c >= 0x00C0 && c <= 0x00D6 || c >= 0x00D8 && c <= 0x00F6 || c >= 0x00F8 && c <= 0x00FF || c >= 0x0100 && c <= 0x0131 || c >= 0x0134 && c <= 0x013E || c >= 0x0141 && c <= 0x0148 || c >= 0x014A && c <= 0x017E || c >= 0x0180 && c <= 0x01C3 || c >= 0x01CD && c <= 0x01F0 || c >= 0x01F4 && c <= 0x01F5 || c >= 0x01FA && c <= 0x0217 || c >= 0x0250 && c <= 0x02A8 || c >= 0x02BB && c <= 0x02C1 || c == 0x0386 || c >= 0x0388 && c <= 0x038A || c == 0x038C || c >= 0x038E && c <= 0x03A1 || c >= 0x03A3 && c <= 0x03CE || c >= 0x03D0 && c <= 0x03D6 || c == 0x03DA || c == 0x03DC || c == 0x03DE || c == 0x03E0 || c >= 0x03E2 && c <= 0x03F3 || c >= 0x0401 && c <= 0x040C || c >= 0x040E && c <= 0x044F || c >= 0x0451 && c <= 0x045C || c >= 0x045E && c <= 0x0481 || c >= 0x0490 && c <= 0x04C4 || c >= 0x04C7 && c <= 0x04C8 || c >= 0x04CB && c <= 0x04CC || c >= 0x04D0 && c <= 0x04EB || c >= 0x04EE && c <= 0x04F5 || c >= 0x04F8 && c <= 0x04F9 || c >= 0x0531 && c <= 0x0556 || c == 0x0559 || c >= 0x0561 && c <= 0x0586 || c >= 0x05D0 && c <= 0x05EA || c >= 0x05F0 && c <= 0x05F2 || c >= 0x0621 && c <= 0x063A || c >= 0x0641 && c <= 0x064A || c >= 0x0671 && c <= 0x06B7 || c >= 0x06BA && c <= 0x06BE || c >= 0x06C0 && c <= 0x06CE || c >= 0x06D0 && c <= 0x06D3 || c == 0x06D5 || c >= 0x06E5 && c <= 0x06E6 || c >= 0x0905 && c <= 0x0939 || c == 0x093D || c >= 0x0958 && c <= 0x0961 || c >= 0x0985 && c <= 0x098C || c >= 0x098F && c <= 0x0990 || c >= 0x0993 && c <= 0x09A8 || c >= 0x09AA && c <= 0x09B0 || c == 0x09B2 || c >= 0x09B6 && c <= 0x09B9 || c >= 0x09DC && c <= 0x09DD || c >= 0x09DF && c <= 0x09E1 || c >= 0x09F0 && c <= 0x09F1 || c >= 0x0A05 && c <= 0x0A0A || c >= 0x0A0F && c <= 0x0A10 || c >= 0x0A13 && c <= 0x0A28 || c >= 0x0A2A && c <= 0x0A30 || c >= 0x0A32 && c <= 0x0A33 || c >= 0x0A35 && c <= 0x0A36 || c >= 0x0A38 && c <= 0x0A39 || c >= 0x0A59 && c <= 0x0A5C || c == 0x0A5E || c >= 0x0A72 && c <= 0x0A74 || c >= 0x0A85 && c <= 0x0A8B || c == 0x0A8D || c >= 0x0A8F && c <= 0x0A91 || c >= 0x0A93 && c <= 0x0AA8 || c >= 0x0AAA && c <= 0x0AB0 || c >= 0x0AB2 && c <= 0x0AB3 || c >= 0x0AB5 && c <= 0x0AB9 || c == 0x0ABD || c == 0x0AE0 || c >= 0x0B05 && c <= 0x0B0C || c >= 0x0B0F && c <= 0x0B10 || c >= 0x0B13 && c <= 0x0B28 || c >= 0x0B2A && c <= 0x0B30 || c >= 0x0B32 && c <= 0x0B33 || c >= 0x0B36 && c <= 0x0B39 || c == 0x0B3D || c >= 0x0B5C && c <= 0x0B5D || c >= 0x0B5F && c <= 0x0B61 || c >= 0x0B85 && c <= 0x0B8A || c >= 0x0B8E && c <= 0x0B90 || c >= 0x0B92 && c <= 0x0B95 || c >= 0x0B99 && c <= 0x0B9A || c == 0x0B9C || c >= 0x0B9E && c <= 0x0B9F || c >= 0x0BA3 && c <= 0x0BA4 || c >= 0x0BA8 && c <= 0x0BAA || c >= 0x0BAE && c <= 0x0BB5 || c >= 0x0BB7 && c <= 0x0BB9 || c >= 0x0C05 && c <= 0x0C0C || c >= 0x0C0E && c <= 0x0C10 || c >= 0x0C12 && c <= 0x0C28 || c >= 0x0C2A && c <= 0x0C33 || c >= 0x0C35 && c <= 0x0C39 || c >= 0x0C60 && c <= 0x0C61 || c >= 0x0C85 && c <= 0x0C8C || c >= 0x0C8E && c <= 0x0C90 || c >= 0x0C92 && c <= 0x0CA8 || c >= 0x0CAA && c <= 0x0CB3 || c >= 0x0CB5 && c <= 0x0CB9 || c == 0x0CDE || c >= 0x0CE0 && c <= 0x0CE1 || c >= 0x0D05 && c <= 0x0D0C || c >= 0x0D0E && c <= 0x0D10 || c >= 0x0D12 && c <= 0x0D28 || c >= 0x0D2A && c <= 0x0D39 || c >= 0x0D60 && c <= 0x0D61 || c >= 0x0E01 && c <= 0x0E2E || c == 0x0E30 || c >= 0x0E32 && c <= 0x0E33 || c >= 0x0E40 && c <= 0x0E45 || c >= 0x0E81 && c <= 0x0E82 || c == 0x0E84 || c >= 0x0E87 && c <= 0x0E88 || c == 0x0E8A || c == 0x0E8D || c >= 0x0E94 && c <= 0x0E97 || c >= 0x0E99 && c <= 0x0E9F || c >= 0x0EA1 && c <= 0x0EA3 || c == 0x0EA5 || c == 0x0EA7 || c >= 0x0EAA && c <= 0x0EAB || c >= 0x0EAD && c <= 0x0EAE || c == 0x0EB0 || c >= 0x0EB2 && c <= 0x0EB3 || c == 0x0EBD || c >= 0x0EC0 && c <= 0x0EC4 || c >= 0x0F40 && c <= 0x0F47 || c >= 0x0F49 && c <= 0x0F69 || c >= 0x10A0 && c <= 0x10C5 || c >= 0x10D0 && c <= 0x10F6 || c == 0x1100 || c >= 0x1102 && c <= 0x1103 || c >= 0x1105 && c <= 0x1107 || c == 0x1109 || c >= 0x110B && c <= 0x110C || c >= 0x110E && c <= 0x1112 || c == 0x113C || c == 0x113E || c == 0x1140 || c == 0x114C || c == 0x114E || c == 0x1150 || c >= 0x1154 && c <= 0x1155 || c == 0x1159 || c >= 0x115F && c <= 0x1161 || c == 0x1163 || c == 0x1165 || c == 0x1167 || c == 0x1169 || c >= 0x116D && c <= 0x116E || c >= 0x1172 && c <= 0x1173 || c == 0x1175 || c == 0x119E || c == 0x11A8 || c == 0x11AB || c >= 0x11AE && c <= 0x11AF || c >= 0x11B7 && c <= 0x11B8 || c == 0x11BA || c >= 0x11BC && c <= 0x11C2 || c == 0x11EB || c == 0x11F0 || c == 0x11F9 || c >= 0x1E00 && c <= 0x1E9B || c >= 0x1EA0 && c <= 0x1EF9 || c >= 0x1F00 && c <= 0x1F15 || c >= 0x1F18 && c <= 0x1F1D || c >= 0x1F20 && c <= 0x1F45 || c >= 0x1F48 && c <= 0x1F4D || c >= 0x1F50 && c <= 0x1F57 || c == 0x1F59 || c == 0x1F5B || c == 0x1F5D || c >= 0x1F5F && c <= 0x1F7D || c >= 0x1F80 && c <= 0x1FB4 || c >= 0x1FB6 && c <= 0x1FBC || c == 0x1FBE || c >= 0x1FC2 && c <= 0x1FC4 || c >= 0x1FC6 && c <= 0x1FCC || c >= 0x1FD0 && c <= 0x1FD3 || c >= 0x1FD6 && c <= 0x1FDB || c >= 0x1FE0 && c <= 0x1FEC || c >= 0x1FF2 && c <= 0x1FF4 || c >= 0x1FF6 && c <= 0x1FFC || c == 0x2126 || c >= 0x212A && c <= 0x212B || c == 0x212E || c >= 0x2180 && c <= 0x2182 || c >= 0x3041 && c <= 0x3094 || c >= 0x30A1 && c <= 0x30FA || c >= 0x3105 && c <= 0x312C || c >= 0xAC00 && c <= 0xD7A3 || c >= 0x4E00 && c <= 0x9FA5 || c == 0x3007 || c >= 0x3021 && c <= 0x3029;\n  };\n\n  Utilities.isNCNameChar = function (c) {\n    return c >= 0x0030 && c <= 0x0039 || c >= 0x0660 && c <= 0x0669 || c >= 0x06F0 && c <= 0x06F9 || c >= 0x0966 && c <= 0x096F || c >= 0x09E6 && c <= 0x09EF || c >= 0x0A66 && c <= 0x0A6F || c >= 0x0AE6 && c <= 0x0AEF || c >= 0x0B66 && c <= 0x0B6F || c >= 0x0BE7 && c <= 0x0BEF || c >= 0x0C66 && c <= 0x0C6F || c >= 0x0CE6 && c <= 0x0CEF || c >= 0x0D66 && c <= 0x0D6F || c >= 0x0E50 && c <= 0x0E59 || c >= 0x0ED0 && c <= 0x0ED9 || c >= 0x0F20 && c <= 0x0F29 || c == 0x002E || c == 0x002D || c == 0x005F || Utilities.isLetter(c) || c >= 0x0300 && c <= 0x0345 || c >= 0x0360 && c <= 0x0361 || c >= 0x0483 && c <= 0x0486 || c >= 0x0591 && c <= 0x05A1 || c >= 0x05A3 && c <= 0x05B9 || c >= 0x05BB && c <= 0x05BD || c == 0x05BF || c >= 0x05C1 && c <= 0x05C2 || c == 0x05C4 || c >= 0x064B && c <= 0x0652 || c == 0x0670 || c >= 0x06D6 && c <= 0x06DC || c >= 0x06DD && c <= 0x06DF || c >= 0x06E0 && c <= 0x06E4 || c >= 0x06E7 && c <= 0x06E8 || c >= 0x06EA && c <= 0x06ED || c >= 0x0901 && c <= 0x0903 || c == 0x093C || c >= 0x093E && c <= 0x094C || c == 0x094D || c >= 0x0951 && c <= 0x0954 || c >= 0x0962 && c <= 0x0963 || c >= 0x0981 && c <= 0x0983 || c == 0x09BC || c == 0x09BE || c == 0x09BF || c >= 0x09C0 && c <= 0x09C4 || c >= 0x09C7 && c <= 0x09C8 || c >= 0x09CB && c <= 0x09CD || c == 0x09D7 || c >= 0x09E2 && c <= 0x09E3 || c == 0x0A02 || c == 0x0A3C || c == 0x0A3E || c == 0x0A3F || c >= 0x0A40 && c <= 0x0A42 || c >= 0x0A47 && c <= 0x0A48 || c >= 0x0A4B && c <= 0x0A4D || c >= 0x0A70 && c <= 0x0A71 || c >= 0x0A81 && c <= 0x0A83 || c == 0x0ABC || c >= 0x0ABE && c <= 0x0AC5 || c >= 0x0AC7 && c <= 0x0AC9 || c >= 0x0ACB && c <= 0x0ACD || c >= 0x0B01 && c <= 0x0B03 || c == 0x0B3C || c >= 0x0B3E && c <= 0x0B43 || c >= 0x0B47 && c <= 0x0B48 || c >= 0x0B4B && c <= 0x0B4D || c >= 0x0B56 && c <= 0x0B57 || c >= 0x0B82 && c <= 0x0B83 || c >= 0x0BBE && c <= 0x0BC2 || c >= 0x0BC6 && c <= 0x0BC8 || c >= 0x0BCA && c <= 0x0BCD || c == 0x0BD7 || c >= 0x0C01 && c <= 0x0C03 || c >= 0x0C3E && c <= 0x0C44 || c >= 0x0C46 && c <= 0x0C48 || c >= 0x0C4A && c <= 0x0C4D || c >= 0x0C55 && c <= 0x0C56 || c >= 0x0C82 && c <= 0x0C83 || c >= 0x0CBE && c <= 0x0CC4 || c >= 0x0CC6 && c <= 0x0CC8 || c >= 0x0CCA && c <= 0x0CCD || c >= 0x0CD5 && c <= 0x0CD6 || c >= 0x0D02 && c <= 0x0D03 || c >= 0x0D3E && c <= 0x0D43 || c >= 0x0D46 && c <= 0x0D48 || c >= 0x0D4A && c <= 0x0D4D || c == 0x0D57 || c == 0x0E31 || c >= 0x0E34 && c <= 0x0E3A || c >= 0x0E47 && c <= 0x0E4E || c == 0x0EB1 || c >= 0x0EB4 && c <= 0x0EB9 || c >= 0x0EBB && c <= 0x0EBC || c >= 0x0EC8 && c <= 0x0ECD || c >= 0x0F18 && c <= 0x0F19 || c == 0x0F35 || c == 0x0F37 || c == 0x0F39 || c == 0x0F3E || c == 0x0F3F || c >= 0x0F71 && c <= 0x0F84 || c >= 0x0F86 && c <= 0x0F8B || c >= 0x0F90 && c <= 0x0F95 || c == 0x0F97 || c >= 0x0F99 && c <= 0x0FAD || c >= 0x0FB1 && c <= 0x0FB7 || c == 0x0FB9 || c >= 0x20D0 && c <= 0x20DC || c == 0x20E1 || c >= 0x302A && c <= 0x302F || c == 0x3099 || c == 0x309A || c == 0x00B7 || c == 0x02D0 || c == 0x02D1 || c == 0x0387 || c == 0x0640 || c == 0x0E46 || c == 0x0EC6 || c == 0x3005 || c >= 0x3031 && c <= 0x3035 || c >= 0x309D && c <= 0x309E || c >= 0x30FC && c <= 0x30FE;\n  };\n\n  Utilities.coalesceText = function (n) {\n    for (var m = n.firstChild; m != null; m = m.nextSibling) {\n      if (m.nodeType == 3\n      /*Node.TEXT_NODE*/\n      || m.nodeType == 4\n      /*Node.CDATA_SECTION_NODE*/\n      ) {\n          var s = m.nodeValue;\n          var first = m;\n          m = m.nextSibling;\n\n          while (m != null && (m.nodeType == 3\n          /*Node.TEXT_NODE*/\n          || m.nodeType == 4\n          /*Node.CDATA_SECTION_NODE*/\n          )) {\n            s += m.nodeValue;\n            var del = m;\n            m = m.nextSibling;\n            del.parentNode.removeChild(del);\n          }\n\n          if (first.nodeType == 4\n          /*Node.CDATA_SECTION_NODE*/\n          ) {\n              var p = first.parentNode;\n\n              if (first.nextSibling == null) {\n                p.removeChild(first);\n                p.appendChild(p.ownerDocument.createTextNode(s));\n              } else {\n                var next = first.nextSibling;\n                p.removeChild(first);\n                p.insertBefore(p.ownerDocument.createTextNode(s), next);\n              }\n            } else {\n            first.nodeValue = s;\n          }\n\n          if (m == null) {\n            break;\n          }\n        } else if (m.nodeType == 1\n      /*Node.ELEMENT_NODE*/\n      ) {\n          Utilities.coalesceText(m);\n        }\n    }\n  };\n\n  Utilities.instance_of = function (o, c) {\n    while (o != null) {\n      if (o.constructor === c) {\n        return true;\n      }\n\n      if (o === Object) {\n        return false;\n      }\n\n      o = o.constructor.superclass;\n    }\n\n    return false;\n  };\n\n  Utilities.getElementById = function (n, id) {\n    // Note that this does not check the DTD to check for actual\n    // attributes of type ID, so this may be a bit wrong.\n    if (n.nodeType == 1\n    /*Node.ELEMENT_NODE*/\n    ) {\n        if (n.getAttribute(\"id\") == id || n.getAttributeNS(null, \"id\") == id) {\n          return n;\n        }\n      }\n\n    for (var m = n.firstChild; m != null; m = m.nextSibling) {\n      var res = Utilities.getElementById(m, id);\n\n      if (res != null) {\n        return res;\n      }\n    }\n\n    return null;\n  }; // XPathException ////////////////////////////////////////////////////////////\n\n\n  var XPathException = function () {\n    function getMessage(code, exception) {\n      var msg = exception ? \": \" + exception.toString() : \"\";\n\n      switch (code) {\n        case XPathException.INVALID_EXPRESSION_ERR:\n          return \"Invalid expression\" + msg;\n\n        case XPathException.TYPE_ERR:\n          return \"Type error\" + msg;\n      }\n\n      return null;\n    }\n\n    function XPathException(code, error, message) {\n      var err = Error.call(this, getMessage(code, error) || message);\n      err.code = code;\n      err.exception = error;\n      return err;\n    }\n\n    XPathException.prototype = Object.create(Error.prototype);\n    XPathException.prototype.constructor = XPathException;\n    XPathException.superclass = Error;\n\n    XPathException.prototype.toString = function () {\n      return this.message;\n    };\n\n    XPathException.fromMessage = function (message, error) {\n      return new XPathException(null, error, message);\n    };\n\n    XPathException.INVALID_EXPRESSION_ERR = 51;\n    XPathException.TYPE_ERR = 52;\n    return XPathException;\n  }(); // XPathExpression ///////////////////////////////////////////////////////////\n\n\n  XPathExpression.prototype = {};\n  XPathExpression.prototype.constructor = XPathExpression;\n  XPathExpression.superclass = Object.prototype;\n\n  function XPathExpression(e, r, p) {\n    this.xpath = p.parse(e);\n    this.context = new XPathContext();\n    this.context.namespaceResolver = new XPathNSResolverWrapper(r);\n  }\n\n  XPathExpression.getOwnerDocument = function (n) {\n    return n.nodeType === 9\n    /*Node.DOCUMENT_NODE*/\n    ? n : n.ownerDocument;\n  };\n\n  XPathExpression.detectHtmlDom = function (n) {\n    if (!n) {\n      return false;\n    }\n\n    var doc = XPathExpression.getOwnerDocument(n);\n\n    try {\n      return doc.implementation.hasFeature(\"HTML\", \"2.0\");\n    } catch (e) {\n      return true;\n    }\n  };\n\n  XPathExpression.prototype.evaluate = function (n, t, res) {\n    this.context.expressionContextNode = n; // backward compatibility - no reliable way to detect whether the DOM is HTML, but\n    // this library has been using this method up until now, so we will continue to use it\n    // ONLY when using an XPathExpression\n\n    this.context.caseInsensitive = XPathExpression.detectHtmlDom(n);\n    var result = this.xpath.evaluate(this.context);\n    return new XPathResult(result, t);\n  }; // XPathNSResolverWrapper ////////////////////////////////////////////////////\n\n\n  XPathNSResolverWrapper.prototype = {};\n  XPathNSResolverWrapper.prototype.constructor = XPathNSResolverWrapper;\n  XPathNSResolverWrapper.superclass = Object.prototype;\n\n  function XPathNSResolverWrapper(r) {\n    this.xpathNSResolver = r;\n  }\n\n  XPathNSResolverWrapper.prototype.getNamespace = function (prefix, n) {\n    if (this.xpathNSResolver == null) {\n      return null;\n    }\n\n    return this.xpathNSResolver.lookupNamespaceURI(prefix);\n  }; // NodeXPathNSResolver ///////////////////////////////////////////////////////\n\n\n  NodeXPathNSResolver.prototype = {};\n  NodeXPathNSResolver.prototype.constructor = NodeXPathNSResolver;\n  NodeXPathNSResolver.superclass = Object.prototype;\n\n  function NodeXPathNSResolver(n) {\n    this.node = n;\n    this.namespaceResolver = new NamespaceResolver();\n  }\n\n  NodeXPathNSResolver.prototype.lookupNamespaceURI = function (prefix) {\n    return this.namespaceResolver.getNamespace(prefix, this.node);\n  }; // XPathResult ///////////////////////////////////////////////////////////////\n\n\n  XPathResult.prototype = {};\n  XPathResult.prototype.constructor = XPathResult;\n  XPathResult.superclass = Object.prototype;\n\n  function XPathResult(v, t) {\n    if (t == XPathResult.ANY_TYPE) {\n      if (v.constructor === XString) {\n        t = XPathResult.STRING_TYPE;\n      } else if (v.constructor === XNumber) {\n        t = XPathResult.NUMBER_TYPE;\n      } else if (v.constructor === XBoolean) {\n        t = XPathResult.BOOLEAN_TYPE;\n      } else if (v.constructor === XNodeSet) {\n        t = XPathResult.UNORDERED_NODE_ITERATOR_TYPE;\n      }\n    }\n\n    this.resultType = t;\n\n    switch (t) {\n      case XPathResult.NUMBER_TYPE:\n        this.numberValue = v.numberValue();\n        return;\n\n      case XPathResult.STRING_TYPE:\n        this.stringValue = v.stringValue();\n        return;\n\n      case XPathResult.BOOLEAN_TYPE:\n        this.booleanValue = v.booleanValue();\n        return;\n\n      case XPathResult.ANY_UNORDERED_NODE_TYPE:\n      case XPathResult.FIRST_ORDERED_NODE_TYPE:\n        if (v.constructor === XNodeSet) {\n          this.singleNodeValue = v.first();\n          return;\n        }\n\n        break;\n\n      case XPathResult.UNORDERED_NODE_ITERATOR_TYPE:\n      case XPathResult.ORDERED_NODE_ITERATOR_TYPE:\n        if (v.constructor === XNodeSet) {\n          this.invalidIteratorState = false;\n          this.nodes = v.toArray();\n          this.iteratorIndex = 0;\n          return;\n        }\n\n        break;\n\n      case XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE:\n      case XPathResult.ORDERED_NODE_SNAPSHOT_TYPE:\n        if (v.constructor === XNodeSet) {\n          this.nodes = v.toArray();\n          this.snapshotLength = this.nodes.length;\n          return;\n        }\n\n        break;\n    }\n\n    throw new XPathException(XPathException.TYPE_ERR);\n  }\n\n  ;\n\n  XPathResult.prototype.iterateNext = function () {\n    if (this.resultType != XPathResult.UNORDERED_NODE_ITERATOR_TYPE && this.resultType != XPathResult.ORDERED_NODE_ITERATOR_TYPE) {\n      throw new XPathException(XPathException.TYPE_ERR);\n    }\n\n    return this.nodes[this.iteratorIndex++];\n  };\n\n  XPathResult.prototype.snapshotItem = function (i) {\n    if (this.resultType != XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE && this.resultType != XPathResult.ORDERED_NODE_SNAPSHOT_TYPE) {\n      throw new XPathException(XPathException.TYPE_ERR);\n    }\n\n    return this.nodes[i];\n  };\n\n  XPathResult.ANY_TYPE = 0;\n  XPathResult.NUMBER_TYPE = 1;\n  XPathResult.STRING_TYPE = 2;\n  XPathResult.BOOLEAN_TYPE = 3;\n  XPathResult.UNORDERED_NODE_ITERATOR_TYPE = 4;\n  XPathResult.ORDERED_NODE_ITERATOR_TYPE = 5;\n  XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE = 6;\n  XPathResult.ORDERED_NODE_SNAPSHOT_TYPE = 7;\n  XPathResult.ANY_UNORDERED_NODE_TYPE = 8;\n  XPathResult.FIRST_ORDERED_NODE_TYPE = 9; // DOM 3 XPath support ///////////////////////////////////////////////////////\n\n  function installDOM3XPathSupport(doc, p) {\n    doc.createExpression = function (e, r) {\n      try {\n        return new XPathExpression(e, r, p);\n      } catch (e) {\n        throw new XPathException(XPathException.INVALID_EXPRESSION_ERR, e);\n      }\n    };\n\n    doc.createNSResolver = function (n) {\n      return new NodeXPathNSResolver(n);\n    };\n\n    doc.evaluate = function (e, cn, r, t, res) {\n      if (t < 0 || t > 9) {\n        throw {\n          code: 0,\n          toString: function toString() {\n            return \"Request type not supported\";\n          }\n        };\n      }\n\n      return doc.createExpression(e, r, p).evaluate(cn, t, res);\n    };\n  }\n\n  ; // ---------------------------------------------------------------------------\n  // Install DOM 3 XPath support for the current document.\n\n  try {\n    var shouldInstall = true;\n\n    try {\n      if (document.implementation && document.implementation.hasFeature && document.implementation.hasFeature(\"XPath\", null)) {\n        shouldInstall = false;\n      }\n    } catch (e) {}\n\n    if (shouldInstall) {\n      installDOM3XPathSupport(document, new XPathParser());\n    }\n  } catch (e) {} // ---------------------------------------------------------------------------\n  // exports for node.js\n\n\n  installDOM3XPathSupport(exports, new XPathParser());\n\n  (function () {\n    var parser = new XPathParser();\n    var defaultNSResolver = new NamespaceResolver();\n    var defaultFunctionResolver = new FunctionResolver();\n    var defaultVariableResolver = new VariableResolver();\n\n    function makeNSResolverFromFunction(func) {\n      return {\n        getNamespace: function getNamespace(prefix, node) {\n          var ns = func(prefix, node);\n          return ns || defaultNSResolver.getNamespace(prefix, node);\n        }\n      };\n    }\n\n    function makeNSResolverFromObject(obj) {\n      return makeNSResolverFromFunction(obj.getNamespace.bind(obj));\n    }\n\n    function makeNSResolverFromMap(map) {\n      return makeNSResolverFromFunction(function (prefix) {\n        return map[prefix];\n      });\n    }\n\n    function makeNSResolver(resolver) {\n      if (resolver && typeof resolver.getNamespace === \"function\") {\n        return makeNSResolverFromObject(resolver);\n      }\n\n      if (typeof resolver === \"function\") {\n        return makeNSResolverFromFunction(resolver);\n      } // assume prefix -> uri mapping\n\n\n      if (typeof resolver === \"object\") {\n        return makeNSResolverFromMap(resolver);\n      }\n\n      return defaultNSResolver;\n    }\n    /** Converts native JavaScript types to their XPath library equivalent */\n\n\n    function convertValue(value) {\n      if (value === null || typeof value === \"undefined\" || value instanceof XString || value instanceof XBoolean || value instanceof XNumber || value instanceof XNodeSet) {\n        return value;\n      }\n\n      switch (typeof value) {\n        case \"string\":\n          return new XString(value);\n\n        case \"boolean\":\n          return new XBoolean(value);\n\n        case \"number\":\n          return new XNumber(value);\n      } // assume node(s)\n\n\n      var ns = new XNodeSet();\n      ns.addArray([].concat(value));\n      return ns;\n    }\n\n    function makeEvaluator(func) {\n      return function (context) {\n        var args = Array.prototype.slice.call(arguments, 1).map(function (arg) {\n          return arg.evaluate(context);\n        });\n        var result = func.apply(this, [].concat(context, args));\n        return convertValue(result);\n      };\n    }\n\n    function makeFunctionResolverFromFunction(func) {\n      return {\n        getFunction: function getFunction(name, namespace) {\n          var found = func(name, namespace);\n\n          if (found) {\n            return makeEvaluator(found);\n          }\n\n          return defaultFunctionResolver.getFunction(name, namespace);\n        }\n      };\n    }\n\n    function makeFunctionResolverFromObject(obj) {\n      return makeFunctionResolverFromFunction(obj.getFunction.bind(obj));\n    }\n\n    function makeFunctionResolverFromMap(map) {\n      return makeFunctionResolverFromFunction(function (name) {\n        return map[name];\n      });\n    }\n\n    function makeFunctionResolver(resolver) {\n      if (resolver && typeof resolver.getFunction === \"function\") {\n        return makeFunctionResolverFromObject(resolver);\n      }\n\n      if (typeof resolver === \"function\") {\n        return makeFunctionResolverFromFunction(resolver);\n      } // assume map\n\n\n      if (typeof resolver === \"object\") {\n        return makeFunctionResolverFromMap(resolver);\n      }\n\n      return defaultFunctionResolver;\n    }\n\n    function makeVariableResolverFromFunction(func) {\n      return {\n        getVariable: function getVariable(name, namespace) {\n          var value = func(name, namespace);\n          return convertValue(value);\n        }\n      };\n    }\n\n    function makeVariableResolver(resolver) {\n      if (resolver) {\n        if (typeof resolver.getVariable === \"function\") {\n          return makeVariableResolverFromFunction(resolver.getVariable.bind(resolver));\n        }\n\n        if (typeof resolver === \"function\") {\n          return makeVariableResolverFromFunction(resolver);\n        } // assume map\n\n\n        if (typeof resolver === \"object\") {\n          return makeVariableResolverFromFunction(function (name) {\n            return resolver[name];\n          });\n        }\n      }\n\n      return defaultVariableResolver;\n    }\n\n    function copyIfPresent(prop, dest, source) {\n      if (prop in source) {\n        dest[prop] = source[prop];\n      }\n    }\n\n    function makeContext(options) {\n      var context = new XPathContext();\n\n      if (options) {\n        context.namespaceResolver = makeNSResolver(options.namespaces);\n        context.functionResolver = makeFunctionResolver(options.functions);\n        context.variableResolver = makeVariableResolver(options.variables);\n        context.expressionContextNode = options.node;\n        copyIfPresent('allowAnyNamespaceForNoPrefix', context, options);\n        copyIfPresent('isHtml', context, options);\n      } else {\n        context.namespaceResolver = defaultNSResolver;\n      }\n\n      return context;\n    }\n\n    function _evaluate(parsedExpression, options) {\n      var context = makeContext(options);\n      return parsedExpression.evaluate(context);\n    }\n\n    var evaluatorPrototype = {\n      evaluate: function evaluate(options) {\n        return _evaluate(this.expression, options);\n      },\n      evaluateNumber: function evaluateNumber(options) {\n        return this.evaluate(options).numberValue();\n      },\n      evaluateString: function evaluateString(options) {\n        return this.evaluate(options).stringValue();\n      },\n      evaluateBoolean: function evaluateBoolean(options) {\n        return this.evaluate(options).booleanValue();\n      },\n      evaluateNodeSet: function evaluateNodeSet(options) {\n        return this.evaluate(options).nodeset();\n      },\n      select: function select(options) {\n        return this.evaluateNodeSet(options).toArray();\n      },\n      select1: function select1(options) {\n        return this.select(options)[0];\n      }\n    };\n\n    function parse(xpath) {\n      var parsed = parser.parse(xpath);\n      return Object.create(evaluatorPrototype, {\n        expression: {\n          value: parsed\n        }\n      });\n    }\n\n    exports.parse = parse;\n  })();\n\n  exports.XPath = XPath;\n  exports.XPathParser = XPathParser;\n  exports.XPathResult = XPathResult;\n  exports.Step = Step;\n  exports.NodeTest = NodeTest;\n  exports.BarOperation = BarOperation;\n  exports.NamespaceResolver = NamespaceResolver;\n  exports.FunctionResolver = FunctionResolver;\n  exports.VariableResolver = VariableResolver;\n  exports.Utilities = Utilities;\n  exports.XPathContext = XPathContext;\n  exports.XNodeSet = XNodeSet;\n  exports.XBoolean = XBoolean;\n  exports.XString = XString;\n  exports.XNumber = XNumber; // helper\n\n  exports.select = function (e, doc, single) {\n    return exports.selectWithResolver(e, doc, null, single);\n  };\n\n  exports.useNamespaces = function (mappings) {\n    var resolver = {\n      mappings: mappings || {},\n      lookupNamespaceURI: function lookupNamespaceURI(prefix) {\n        return this.mappings[prefix];\n      }\n    };\n    return function (e, doc, single) {\n      return exports.selectWithResolver(e, doc, resolver, single);\n    };\n  };\n\n  exports.selectWithResolver = function (e, doc, resolver, single) {\n    var expression = new XPathExpression(e, resolver, new XPathParser());\n    var type = XPathResult.ANY_TYPE;\n    var result = expression.evaluate(doc, type, null);\n\n    if (result.resultType == XPathResult.STRING_TYPE) {\n      result = result.stringValue;\n    } else if (result.resultType == XPathResult.NUMBER_TYPE) {\n      result = result.numberValue;\n    } else if (result.resultType == XPathResult.BOOLEAN_TYPE) {\n      result = result.booleanValue;\n    } else {\n      result = result.nodes;\n\n      if (single) {\n        result = result[0];\n      }\n    }\n\n    return result;\n  };\n\n  exports.select1 = function (e, doc) {\n    return exports.select(e, doc, true);\n  }; // end non-node wrapper\n\n})(xpath);","map":{"version":3,"sources":["/home/kpost/Desktop/Political_UI/node_modules/xpath/xpath.js"],"names":["xpath","exports","curry","func","slice","Array","prototype","totalargs","length","partial","args","fn","apply","concat","call","arguments","forEach","f","xs","i","reduce","seed","acc","x","map","mapped","filter","filtered","push","compose","Error","funcs","reverse","f0","fRem","next","includes","values","value","always","prop","name","obj","toString","join","s","wrap","pref","suf","str","assign","target","to","Object","index","nextSource","nextKey","hasOwnProperty","XPathParser","constructor","superclass","init","reduceActions","rhs","OrOperation","AndOperation","EqualsOperation","NotEqualOperation","LessThanOperation","GreaterThanOperation","LessThanOrEqualOperation","GreaterThanOrEqualOperation","PlusOperation","MinusOperation","MultiplyOperation","DivOperation","ModOperation","UnaryMinusOperation","BarOperation","PathExpr","undefined","locationPath","steps","unshift","Step","DESCENDANTORSELF","NodeTest","nodeTest","Utilities","instance_of","filterPredicates","XString","XNumber","FunctionCall","LocationPath","absolute","CHILD","ANCESTOR","ANCESTORORSELF","ATTRIBUTE","DESCENDANT","FOLLOWING","FOLLOWINGSIBLING","NAMESPACE","PARENT","PRECEDING","PRECEDINGSIBLING","SELF","commentTest","textTest","anyPiTest","PITest","VariableReference","nameTestAny","NameTestPrefixAny","split","NameTestQName","actionTable","actionTableNumber","gotoTable","productions","DOUBLEDOT","DOUBLECOLON","DOUBLESLASH","NOTEQUAL","LESSTHANOREQUAL","GREATERTHANOREQUAL","AND","OR","MOD","DIV","MULTIPLYOPERATOR","FUNCTIONNAME","AXISNAME","LITERAL","NUMBER","ASTERISKNAMETEST","QNAME","NCNAMECOLONASTERISK","NODETYPE","PROCESSINGINSTRUCTIONWITHLITERAL","EQUALS","LESSTHAN","GREATERTHAN","PLUS","MINUS","BAR","SLASH","LEFTPARENTHESIS","RIGHTPARENTHESIS","COMMA","AT","LEFTBRACKET","RIGHTBRACKET","DOT","DOLLAR","tokenize","s1","types","pos","c","charAt","number","delimiter","literal","XPathException","fromMessage","last","isLetter","charCodeAt","isNCNameChar","SHIFT","REDUCE","ACCEPT","parse","res","tokenPos","state","tokenType","tokenValue","a","t","num","pop","s_","XPath","e","expression","setIfUnset","evaluate","contextNode","expressionContextNode","contextSize","contextPosition","isHtml","XML_NAMESPACE_URI","XMLNS_NAMESPACE_URI","Expression","UnaryOperation","negate","BinaryOperation","lhs","b","bool","booleanValue","equals","notequal","lessthan","greaterthan","lessthanorequal","greaterthanorequal","plus","minus","multiply","div","mod","nodeset","union","filterPreds","locpath","findRoot","node","parentNode","applyPredicates","predicates","nodes","inNodes","pred","ctx","extend","predicateMatches","getRoot","xpc","firstNode","nodeType","virtualRoot","ownerDoc","ownerDocument","n","applyStep","step","self","newNodes","axis","m","getOwnerElement","matches","nnm","attributes","k","item","firstChild","nextSibling","st","attr","nm","String","substring","pre","nsn","XPathNamespace","outer","previousSibling","applySteps","applyFilter","ns","XNodeSet","nonNodes","toUnsortedArray","applyLocationPath","startNodes","XPathContext","filterResult","addArray","numberValue","predicateString","predicatesString","filterStr","ownerElement","selectSingleNode","doc","elts","getElementsByTagName","elt","j","an","abs","nodetest","preds","STEPNAMES","type","console","warn","NAMETESTANY","NAMETESTPREFIXANY","NAMETESTQNAME","COMMENT","TEXT","PI","NODE","isNodeType","makeNodeTestType","members","ctor","newType","key","makeNodeTypeTest","nodeTypes","stringVal","hasPrefix","prefix","nodeName","tagName","indexOf","isElementOrAttribute","nameSpaceMatches","nNamespace","namespaceURI","allowAnyNamespaceForNoPrefix","namespaceResolver","getNamespace","localNameMatches","localName","nLocalName","caseInsensitive","toLowerCase","XPATH_NAMESPACE_NODE","nameParts","v","variable","parts","resolveQName","result","variableResolver","getVariable","functionName","FunctionResolver","getFunctionFromContext","functionResolver","thisArg","Operators","l","r","string","XBoolean","stringValue","compareWithString","Number","numberFormat","test","parseFloat","NaN","padSmallNumber","numberStr","base","replace","exponent","padLargeNumber","zerosToAppend","strValue","compareWithNumber","Boolean","not","compareWithBoolean","true_","false_","AVLTree","left","right","depth","balance","ldepth","rdepth","lldepth","lrdepth","rotateRR","rotateLL","rrdepth","rldepth","nodeBefore","rightBefore","updateInNewLocation","leftBefore","getDepthFromChildren","nodeOrder","n1","n2","compareDocumentPosition","cpos","d1","d2","m1","m2","n1Par","n2Par","n1isAttr","isAttribute","n2isAttr","cn","childNodes","len","add","o","ret","tree","size","p","first","stringForNode","stringForContainerNode","nodeValue","isNamespaceNode","namespace","nt","buildTree","toArray","toArrayRec","compareWithNodeSet","arr","oInvert","lop","rop","compareWith","isXPathNamespace","vr","nr","fr","VariableResolver","NamespaceResolver","newProps","ln","Functions","functions","addStandardFunctions","position","count","id","startsWith","contains","substringBefore","substringAfter","stringLength","normalizeSpace","translate","boolean_","lang","sum","floor","ceiling","round","addFunction","qName","context","getFunction","documentElement","aname","ids","getElementById","eNode","baseName","s2","Math","isSpace","eValue","eFrom","eTo","from","cMap","ch","getAttributeNS","ceil","val","splitQName","qn","useDefault","coalesceText","del","removeChild","appendChild","createTextNode","insertBefore","getAttribute","getMessage","code","exception","msg","INVALID_EXPRESSION_ERR","TYPE_ERR","error","message","err","create","XPathExpression","XPathNSResolverWrapper","getOwnerDocument","detectHtmlDom","implementation","hasFeature","XPathResult","xpathNSResolver","lookupNamespaceURI","NodeXPathNSResolver","ANY_TYPE","STRING_TYPE","NUMBER_TYPE","BOOLEAN_TYPE","UNORDERED_NODE_ITERATOR_TYPE","resultType","ANY_UNORDERED_NODE_TYPE","FIRST_ORDERED_NODE_TYPE","singleNodeValue","ORDERED_NODE_ITERATOR_TYPE","invalidIteratorState","iteratorIndex","UNORDERED_NODE_SNAPSHOT_TYPE","ORDERED_NODE_SNAPSHOT_TYPE","snapshotLength","iterateNext","snapshotItem","installDOM3XPathSupport","createExpression","createNSResolver","shouldInstall","document","parser","defaultNSResolver","defaultFunctionResolver","defaultVariableResolver","makeNSResolverFromFunction","makeNSResolverFromObject","bind","makeNSResolverFromMap","makeNSResolver","resolver","convertValue","makeEvaluator","arg","makeFunctionResolverFromFunction","found","makeFunctionResolverFromObject","makeFunctionResolverFromMap","makeFunctionResolver","makeVariableResolverFromFunction","makeVariableResolver","copyIfPresent","dest","source","makeContext","options","namespaces","variables","parsedExpression","evaluatorPrototype","evaluateNumber","evaluateString","evaluateBoolean","evaluateNodeSet","select","select1","parsed","single","selectWithResolver","useNamespaces","mappings"],"mappings":"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","sourcesContent":["/*\r\n * xpath.js\r\n *\r\n * An XPath 1.0 library for JavaScript.\r\n *\r\n * Cameron McCormack <cam (at) mcc.id.au>\r\n *\r\n * This work is licensed under the MIT License.\r\n *\r\n * Revision 20: April 26, 2011\r\n *   Fixed a typo resulting in FIRST_ORDERED_NODE_TYPE results being wrong,\r\n *   thanks to <shi_a009 (at) hotmail.com>.\r\n *\r\n * Revision 19: November 29, 2005\r\n *   Nodesets now store their nodes in a height balanced tree, increasing\r\n *   performance for the common case of selecting nodes in document order,\r\n *   thanks to S閎astien Cramatte <contact (at) zeninteractif.com>.\r\n *   AVL tree code adapted from Raimund Neumann <rnova (at) gmx.net>.\r\n *\r\n * Revision 18: October 27, 2005\r\n *   DOM 3 XPath support.  Caveats:\r\n *     - namespace prefixes aren't resolved in XPathEvaluator.createExpression,\r\n *       but in XPathExpression.evaluate.\r\n *     - XPathResult.invalidIteratorState is not implemented.\r\n *\r\n * Revision 17: October 25, 2005\r\n *   Some core XPath function fixes and a patch to avoid crashing certain\r\n *   versions of MSXML in PathExpr.prototype.getOwnerElement, thanks to\r\n *   S閎astien Cramatte <contact (at) zeninteractif.com>.\r\n *\r\n * Revision 16: September 22, 2005\r\n *   Workarounds for some IE 5.5 deficiencies.\r\n *   Fixed problem with prefix node tests on attribute nodes.\r\n *\r\n * Revision 15: May 21, 2005\r\n *   Fixed problem with QName node tests on elements with an xmlns=\"...\".\r\n *\r\n * Revision 14: May 19, 2005\r\n *   Fixed QName node tests on attribute node regression.\r\n *\r\n * Revision 13: May 3, 2005\r\n *   Node tests are case insensitive now if working in an HTML DOM.\r\n *\r\n * Revision 12: April 26, 2005\r\n *   Updated licence.  Slight code changes to enable use of Dean\r\n *   Edwards' script compression, http://dean.edwards.name/packer/ .\r\n *\r\n * Revision 11: April 23, 2005\r\n *   Fixed bug with 'and' and 'or' operators, fix thanks to\r\n *   Sandy McArthur <sandy (at) mcarthur.org>.\r\n *\r\n * Revision 10: April 15, 2005\r\n *   Added support for a virtual root node, supposedly helpful for\r\n *   implementing XForms.  Fixed problem with QName node tests and\r\n *   the parent axis.\r\n *\r\n * Revision 9: March 17, 2005\r\n *   Namespace resolver tweaked so using the document node as the context\r\n *   for namespace lookups is equivalent to using the document element.\r\n *\r\n * Revision 8: February 13, 2005\r\n *   Handle implicit declaration of 'xmlns' namespace prefix.\r\n *   Fixed bug when comparing nodesets.\r\n *   Instance data can now be associated with a FunctionResolver, and\r\n *     workaround for MSXML not supporting 'localName' and 'getElementById',\r\n *     thanks to Grant Gongaware.\r\n *   Fix a few problems when the context node is the root node.\r\n *\r\n * Revision 7: February 11, 2005\r\n *   Default namespace resolver fix from Grant Gongaware\r\n *   <grant (at) gongaware.com>.\r\n *\r\n * Revision 6: February 10, 2005\r\n *   Fixed bug in 'number' function.\r\n *\r\n * Revision 5: February 9, 2005\r\n *   Fixed bug where text nodes not getting converted to string values.\r\n *\r\n * Revision 4: January 21, 2005\r\n *   Bug in 'name' function, fix thanks to Bill Edney.\r\n *   Fixed incorrect processing of namespace nodes.\r\n *   Fixed NamespaceResolver to resolve 'xml' namespace.\r\n *   Implemented union '|' operator.\r\n *\r\n * Revision 3: January 14, 2005\r\n *   Fixed bug with nodeset comparisons, bug lexing < and >.\r\n *\r\n * Revision 2: October 26, 2004\r\n *   QName node test namespace handling fixed.  Few other bug fixes.\r\n *\r\n * Revision 1: August 13, 2004\r\n *   Bug fixes from William J. Edney <bedney (at) technicalpursuit.com>.\r\n *   Added minimal licence.\r\n *\r\n * Initial version: June 14, 2004\r\n */\r\n\r\n// non-node wrapper\r\nvar xpath = (typeof exports === 'undefined') ? {} : exports;\r\n\r\n(function(exports) {\r\n\"use strict\";\r\n\r\n// functional helpers\r\nfunction curry( func ) {\r\n    var slice = Array.prototype.slice,\r\n        totalargs = func.length,\r\n        partial = function( args, fn ) {\r\n            return function( ) {\r\n                return fn.apply( this, args.concat( slice.call( arguments ) ) );\r\n            }\r\n        },\r\n        fn = function( ) {\r\n            var args = slice.call( arguments );\r\n            return ( args.length < totalargs ) ?\r\n                partial( args, fn ) :\r\n                func.apply( this, slice.apply( arguments, [ 0, totalargs ] ) );\r\n        };\r\n    return fn;\r\n}\r\n\r\nvar forEach = curry(function (f, xs) {\r\n\tfor (var i = 0; i < xs.length; i += 1) {\r\n\t\tf(xs[i], i, xs);\r\n\t}\r\n});\r\n\r\nvar reduce = curry(function (f, seed, xs) {\r\n\tvar acc = seed;\r\n\r\n\tforEach(function (x, i) { acc = f(acc, x, i); }, xs);\r\n\r\n\treturn acc;\r\n});\r\n\r\nvar map = curry(function (f, xs) { \r\n\tvar mapped = new Array(xs.length);\r\n\t\r\n\tforEach(function (x, i) { mapped[i] = f(x); }, xs);\r\n\r\n\treturn mapped;\r\n});\r\n\r\nvar filter = curry(function (f, xs) {\r\n\tvar filtered = [];\r\n\t\r\n\tforEach(function (x, i) { if(f(x, i)) { filtered.push(x); } }, xs);\r\n\t\r\n\treturn filtered;\r\n});\r\n\r\nfunction compose() {\r\n    if (arguments.length === 0) { throw new Error('compose requires at least one argument'); }\r\n\r\n    var funcs = Array.prototype.slice.call(arguments).reverse();\r\n\t\r\n    var f0 = funcs[0];\r\n    var fRem = funcs.slice(1);\r\n\r\n    return function () {\r\n        return reduce(function (acc, next) {\r\n            return next(acc);\r\n        }, f0.apply(null, arguments), fRem);\r\n    };\r\n}\r\n\r\nvar includes = curry(function (values, value) {\r\n\tfor (var i = 0; i < values.length; i += 1) {\r\n\t\tif (values[i] === value){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn false;\r\n});\r\n\r\nfunction always(value) { return function () { return value ;} }\r\n\r\nvar prop = curry(function (name, obj) { return obj[name]; });\r\n\r\nfunction toString (x) { return x.toString(); }\r\nvar join = curry(function (s, xs) { return xs.join(s); });\r\nvar wrap = curry(function (pref, suf, str) { return pref + str + suf; });\r\n\r\nfunction assign(target) { // .length of function is 2\r\n    var to = Object(target);\r\n\r\n    for (var index = 1; index < arguments.length; index++) {\r\n        var nextSource = arguments[index];\r\n\r\n        if (nextSource != null) { // Skip over if undefined or null\r\n            for (var nextKey in nextSource) {\r\n                // Avoid bugs when hasOwnProperty is shadowed\r\n                if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\r\n                    to[nextKey] = nextSource[nextKey];\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    return to;\r\n}\r\n\r\n// XPathParser ///////////////////////////////////////////////////////////////\r\n\r\nXPathParser.prototype = new Object();\r\nXPathParser.prototype.constructor = XPathParser;\r\nXPathParser.superclass = Object.prototype;\r\n\r\nfunction XPathParser() {\r\n\tthis.init();\r\n}\r\n\r\nXPathParser.prototype.init = function() {\r\n\tthis.reduceActions = [];\r\n\r\n\tthis.reduceActions[3] = function(rhs) {\r\n\t\treturn new OrOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[5] = function(rhs) {\r\n\t\treturn new AndOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[7] = function(rhs) {\r\n\t\treturn new EqualsOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[8] = function(rhs) {\r\n\t\treturn new NotEqualOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[10] = function(rhs) {\r\n\t\treturn new LessThanOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[11] = function(rhs) {\r\n\t\treturn new GreaterThanOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[12] = function(rhs) {\r\n\t\treturn new LessThanOrEqualOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[13] = function(rhs) {\r\n\t\treturn new GreaterThanOrEqualOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[15] = function(rhs) {\r\n\t\treturn new PlusOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[16] = function(rhs) {\r\n\t\treturn new MinusOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[18] = function(rhs) {\r\n\t\treturn new MultiplyOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[19] = function(rhs) {\r\n\t\treturn new DivOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[20] = function(rhs) {\r\n\t\treturn new ModOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[22] = function(rhs) {\r\n\t\treturn new UnaryMinusOperation(rhs[1]);\r\n\t};\r\n\tthis.reduceActions[24] = function(rhs) {\r\n\t\treturn new BarOperation(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[25] = function(rhs) {\r\n\t\treturn new PathExpr(undefined, undefined, rhs[0]);\r\n\t};\r\n\tthis.reduceActions[27] = function(rhs) {\r\n\t\trhs[0].locationPath = rhs[2];\r\n\t\treturn rhs[0];\r\n\t};\r\n\tthis.reduceActions[28] = function(rhs) {\r\n\t\trhs[0].locationPath = rhs[2];\r\n\t\trhs[0].locationPath.steps.unshift(new Step(Step.DESCENDANTORSELF, NodeTest.nodeTest, []));\r\n\t\treturn rhs[0];\r\n\t};\r\n\tthis.reduceActions[29] = function(rhs) {\r\n\t\treturn new PathExpr(rhs[0], [], undefined);\r\n\t};\r\n\tthis.reduceActions[30] = function(rhs) {\r\n\t\tif (Utilities.instance_of(rhs[0], PathExpr)) {\r\n\t\t\tif (rhs[0].filterPredicates == undefined) {\r\n\t\t\t\trhs[0].filterPredicates = [];\r\n\t\t\t}\r\n\t\t\trhs[0].filterPredicates.push(rhs[1]);\r\n\t\t\treturn rhs[0];\r\n\t\t} else {\r\n\t\t\treturn new PathExpr(rhs[0], [rhs[1]], undefined);\r\n\t\t}\r\n\t};\r\n\tthis.reduceActions[32] = function(rhs) {\r\n\t\treturn rhs[1];\r\n\t};\r\n\tthis.reduceActions[33] = function(rhs) {\r\n\t\treturn new XString(rhs[0]);\r\n\t};\r\n\tthis.reduceActions[34] = function(rhs) {\r\n\t\treturn new XNumber(rhs[0]);\r\n\t};\r\n\tthis.reduceActions[36] = function(rhs) {\r\n\t\treturn new FunctionCall(rhs[0], []);\r\n\t};\r\n\tthis.reduceActions[37] = function(rhs) {\r\n\t\treturn new FunctionCall(rhs[0], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[38] = function(rhs) {\r\n\t\treturn [ rhs[0] ];\r\n\t};\r\n\tthis.reduceActions[39] = function(rhs) {\r\n\t\trhs[2].unshift(rhs[0]);\r\n\t\treturn rhs[2];\r\n\t};\r\n\tthis.reduceActions[43] = function(rhs) {\r\n\t\treturn new LocationPath(true, []);\r\n\t};\r\n\tthis.reduceActions[44] = function(rhs) {\r\n\t\trhs[1].absolute = true;\r\n\t\treturn rhs[1];\r\n\t};\r\n\tthis.reduceActions[46] = function(rhs) {\r\n\t\treturn new LocationPath(false, [ rhs[0] ]);\r\n\t};\r\n\tthis.reduceActions[47] = function(rhs) {\r\n\t\trhs[0].steps.push(rhs[2]);\r\n\t\treturn rhs[0];\r\n\t};\r\n\tthis.reduceActions[49] = function(rhs) {\r\n\t\treturn new Step(rhs[0], rhs[1], []);\r\n\t};\r\n\tthis.reduceActions[50] = function(rhs) {\r\n\t\treturn new Step(Step.CHILD, rhs[0], []);\r\n\t};\r\n\tthis.reduceActions[51] = function(rhs) {\r\n\t\treturn new Step(rhs[0], rhs[1], rhs[2]);\r\n\t};\r\n\tthis.reduceActions[52] = function(rhs) {\r\n\t\treturn new Step(Step.CHILD, rhs[0], rhs[1]);\r\n\t};\r\n\tthis.reduceActions[54] = function(rhs) {\r\n\t\treturn [ rhs[0] ];\r\n\t};\r\n\tthis.reduceActions[55] = function(rhs) {\r\n\t\trhs[1].unshift(rhs[0]);\r\n\t\treturn rhs[1];\r\n\t};\r\n\tthis.reduceActions[56] = function(rhs) {\r\n\t\tif (rhs[0] == \"ancestor\") {\r\n\t\t\treturn Step.ANCESTOR;\r\n\t\t} else if (rhs[0] == \"ancestor-or-self\") {\r\n\t\t\treturn Step.ANCESTORORSELF;\r\n\t\t} else if (rhs[0] == \"attribute\") {\r\n\t\t\treturn Step.ATTRIBUTE;\r\n\t\t} else if (rhs[0] == \"child\") {\r\n\t\t\treturn Step.CHILD;\r\n\t\t} else if (rhs[0] == \"descendant\") {\r\n\t\t\treturn Step.DESCENDANT;\r\n\t\t} else if (rhs[0] == \"descendant-or-self\") {\r\n\t\t\treturn Step.DESCENDANTORSELF;\r\n\t\t} else if (rhs[0] == \"following\") {\r\n\t\t\treturn Step.FOLLOWING;\r\n\t\t} else if (rhs[0] == \"following-sibling\") {\r\n\t\t\treturn Step.FOLLOWINGSIBLING;\r\n\t\t} else if (rhs[0] == \"namespace\") {\r\n\t\t\treturn Step.NAMESPACE;\r\n\t\t} else if (rhs[0] == \"parent\") {\r\n\t\t\treturn Step.PARENT;\r\n\t\t} else if (rhs[0] == \"preceding\") {\r\n\t\t\treturn Step.PRECEDING;\r\n\t\t} else if (rhs[0] == \"preceding-sibling\") {\r\n\t\t\treturn Step.PRECEDINGSIBLING;\r\n\t\t} else if (rhs[0] == \"self\") {\r\n\t\t\treturn Step.SELF;\r\n\t\t}\r\n\t\treturn -1;\r\n\t};\r\n\tthis.reduceActions[57] = function(rhs) {\r\n\t\treturn Step.ATTRIBUTE;\r\n\t};\r\n\tthis.reduceActions[59] = function(rhs) {\r\n\t\tif (rhs[0] == \"comment\") {\r\n\t\t\treturn NodeTest.commentTest;\r\n\t\t} else if (rhs[0] == \"text\") {\r\n\t\t\treturn NodeTest.textTest;\r\n\t\t} else if (rhs[0] == \"processing-instruction\") {\r\n\t\t\treturn NodeTest.anyPiTest;\r\n\t\t} else if (rhs[0] == \"node\") {\r\n\t\t\treturn NodeTest.nodeTest;\r\n\t\t}\r\n\t\treturn new NodeTest(-1, undefined);\r\n\t};\r\n\tthis.reduceActions[60] = function(rhs) {\r\n\t\treturn new NodeTest.PITest(rhs[2]);\r\n\t};\r\n\tthis.reduceActions[61] = function(rhs) {\r\n\t\treturn rhs[1];\r\n\t};\r\n\tthis.reduceActions[63] = function(rhs) {\r\n\t\trhs[1].absolute = true;\r\n\t\trhs[1].steps.unshift(new Step(Step.DESCENDANTORSELF, NodeTest.nodeTest, []));\r\n\t\treturn rhs[1];\r\n\t};\r\n\tthis.reduceActions[64] = function(rhs) {\r\n\t\trhs[0].steps.push(new Step(Step.DESCENDANTORSELF, NodeTest.nodeTest, []));\r\n\t\trhs[0].steps.push(rhs[2]);\r\n\t\treturn rhs[0];\r\n\t};\r\n\tthis.reduceActions[65] = function(rhs) {\r\n\t\treturn new Step(Step.SELF, NodeTest.nodeTest, []);\r\n\t};\r\n\tthis.reduceActions[66] = function(rhs) {\r\n\t\treturn new Step(Step.PARENT, NodeTest.nodeTest, []);\r\n\t};\r\n\tthis.reduceActions[67] = function(rhs) {\r\n\t\treturn new VariableReference(rhs[1]);\r\n\t};\r\n\tthis.reduceActions[68] = function(rhs) {\r\n\t\treturn NodeTest.nameTestAny;\r\n\t};\r\n\tthis.reduceActions[69] = function(rhs) {\r\n\t\treturn new NodeTest.NameTestPrefixAny(rhs[0].split(':')[0]);\r\n\t};\r\n\tthis.reduceActions[70] = function(rhs) {\r\n\t\treturn new NodeTest.NameTestQName(rhs[0]);\r\n\t};\r\n};\r\n\r\nXPathParser.actionTable = [\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\"                 s                  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"                rrrrr               \",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\"rs  rrrrrrrr s  sssssrrrrrr  rrs rs \",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\"                            s       \",\r\n\t\"                            s       \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"  s                                 \",\r\n\t\"                            s       \",\r\n\t\" s           s  sssss          s  s \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"a                                   \",\r\n\t\"r       s                    rr  r  \",\r\n\t\"r      sr                    rr  r  \",\r\n\t\"r   s  rr            s       rr  r  \",\r\n\t\"r   rssrr            rss     rr  r  \",\r\n\t\"r   rrrrr            rrrss   rr  r  \",\r\n\t\"r   rrrrrsss         rrrrr   rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrr   rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrrs  rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrrr  rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrrr  rr  r  \",\r\n\t\"r  srrrrrrrr         rrrrrrs rr sr  \",\r\n\t\"r  srrrrrrrr         rrrrrrs rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r   rrrrrrrr         rrrrrr  rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrrr  rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"                sssss               \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr sr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"                             s      \",\r\n\t\"r  srrrrrrrr         rrrrrrs rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrr   rr  r  \",\r\n\t\"              s                     \",\r\n\t\"                             s      \",\r\n\t\"                rrrrr               \",\r\n\t\" s s        sssssssss    s sss s  ss\",\r\n\t\"r  srrrrrrrr         rrrrrrs rr  r  \",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s s        sssssssss      ss  s  ss\",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\" s           s  sssss          s  s \",\r\n\t\" s           s  sssss          s  s \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\" s           s  sssss          s  s \",\r\n\t\" s           s  sssss          s  s \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr sr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr sr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"                             s      \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"                             rr     \",\r\n\t\"                             s      \",\r\n\t\"                             rs     \",\r\n\t\"r      sr                    rr  r  \",\r\n\t\"r   s  rr            s       rr  r  \",\r\n\t\"r   rssrr            rss     rr  r  \",\r\n\t\"r   rssrr            rss     rr  r  \",\r\n\t\"r   rrrrr            rrrss   rr  r  \",\r\n\t\"r   rrrrr            rrrss   rr  r  \",\r\n\t\"r   rrrrr            rrrss   rr  r  \",\r\n\t\"r   rrrrr            rrrss   rr  r  \",\r\n\t\"r   rrrrrsss         rrrrr   rr  r  \",\r\n\t\"r   rrrrrsss         rrrrr   rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrr   rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrr   rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrr   rr  r  \",\r\n\t\"r   rrrrrrrr         rrrrrr  rr  r  \",\r\n\t\"                                 r  \",\r\n\t\"                                 s  \",\r\n\t\"r  srrrrrrrr         rrrrrrs rr  r  \",\r\n\t\"r  srrrrrrrr         rrrrrrs rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr  r  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\" s s        sssssssss    s ss  s  ss\",\r\n\t\"r  rrrrrrrrr         rrrrrrr rr rr  \",\r\n\t\"                             r      \"\r\n];\r\n\r\nXPathParser.actionTableNumber = [\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\"                 J                  \",\r\n\t\"a  aaaaaaaaa         aaaaaaa aa  a  \",\r\n\t\"                YYYYY               \",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\"K1  KKKKKKKK .  +*)('KKKKKK  KK# K\\\" \",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\"                            N       \",\r\n\t\"                            O       \",\r\n\t\"e  eeeeeeeee         eeeeeee ee ee  \",\r\n\t\"f  fffffffff         fffffff ff ff  \",\r\n\t\"d  ddddddddd         ddddddd dd dd  \",\r\n\t\"B  BBBBBBBBB         BBBBBBB BB BB  \",\r\n\t\"A  AAAAAAAAA         AAAAAAA AA AA  \",\r\n\t\"  P                                 \",\r\n\t\"                            Q       \",\r\n\t\" 1           .  +*)('          #  \\\" \",\r\n\t\"b  bbbbbbbbb         bbbbbbb bb  b  \",\r\n\t\"                                    \",\r\n\t\"!       S                    !!  !  \",\r\n\t\"\\\"      T\\\"                    \\\"\\\"  \\\"  \",\r\n\t\"$   V  $$            U       $$  $  \",\r\n\t\"&   &ZY&&            &XW     &&  &  \",\r\n\t\")   )))))            )))\\\\[   ))  )  \",\r\n\t\".   ....._^]         .....   ..  .  \",\r\n\t\"1   11111111         11111   11  1  \",\r\n\t\"5   55555555         55555`  55  5  \",\r\n\t\"7   77777777         777777  77  7  \",\r\n\t\"9   99999999         999999  99  9  \",\r\n\t\":  c::::::::         ::::::b :: a:  \",\r\n\t\"I  fIIIIIIII         IIIIIIe II  I  \",\r\n\t\"=  =========         ======= == ==  \",\r\n\t\"?  ?????????         ??????? ?? ??  \",\r\n\t\"C  CCCCCCCCC         CCCCCCC CC CC  \",\r\n\t\"J   JJJJJJJJ         JJJJJJ  JJ  J  \",\r\n\t\"M   MMMMMMMM         MMMMMM  MM  M  \",\r\n\t\"N  NNNNNNNNN         NNNNNNN NN  N  \",\r\n\t\"P  PPPPPPPPP         PPPPPPP PP  P  \",\r\n\t\"                +*)('               \",\r\n\t\"R  RRRRRRRRR         RRRRRRR RR aR  \",\r\n\t\"U  UUUUUUUUU         UUUUUUU UU  U  \",\r\n\t\"Z  ZZZZZZZZZ         ZZZZZZZ ZZ ZZ  \",\r\n\t\"c  ccccccccc         ccccccc cc cc  \",\r\n\t\"                             j      \",\r\n\t\"L  fLLLLLLLL         LLLLLLe LL  L  \",\r\n\t\"6   66666666         66666   66  6  \",\r\n\t\"              k                     \",\r\n\t\"                             l      \",\r\n\t\"                XXXXX               \",\r\n\t\" 1 0        /.-,+*)('    & %$m #  \\\"!\",\r\n\t\"_  f________         ______e __  _  \",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('      %$  #  \\\"!\",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\" 1           .  +*)('          #  \\\" \",\r\n\t\" 1           .  +*)('          #  \\\" \",\r\n\t\">  >>>>>>>>>         >>>>>>> >> >>  \",\r\n\t\" 1           .  +*)('          #  \\\" \",\r\n\t\" 1           .  +*)('          #  \\\" \",\r\n\t\"Q  QQQQQQQQQ         QQQQQQQ QQ aQ  \",\r\n\t\"V  VVVVVVVVV         VVVVVVV VV aV  \",\r\n\t\"T  TTTTTTTTT         TTTTTTT TT  T  \",\r\n\t\"@  @@@@@@@@@         @@@@@@@ @@ @@  \",\r\n\t\"                             \\x87      \",\r\n\t\"[  [[[[[[[[[         [[[[[[[ [[ [[  \",\r\n\t\"D  DDDDDDDDD         DDDDDDD DD DD  \",\r\n\t\"                             HH     \",\r\n\t\"                             \\x88      \",\r\n\t\"                             F\\x89     \",\r\n\t\"#      T#                    ##  #  \",\r\n\t\"%   V  %%            U       %%  %  \",\r\n\t\"'   'ZY''            'XW     ''  '  \",\r\n\t\"(   (ZY((            (XW     ((  (  \",\r\n\t\"+   +++++            +++\\\\[   ++  +  \",\r\n\t\"*   *****            ***\\\\[   **  *  \",\r\n\t\"-   -----            ---\\\\[   --  -  \",\r\n\t\",   ,,,,,            ,,,\\\\[   ,,  ,  \",\r\n\t\"0   00000_^]         00000   00  0  \",\r\n\t\"/   /////_^]         /////   //  /  \",\r\n\t\"2   22222222         22222   22  2  \",\r\n\t\"3   33333333         33333   33  3  \",\r\n\t\"4   44444444         44444   44  4  \",\r\n\t\"8   88888888         888888  88  8  \",\r\n\t\"                                 ^  \",\r\n\t\"                                 \\x8a  \",\r\n\t\";  f;;;;;;;;         ;;;;;;e ;;  ;  \",\r\n\t\"<  f<<<<<<<<         <<<<<<e <<  <  \",\r\n\t\"O  OOOOOOOOO         OOOOOOO OO  O  \",\r\n\t\"`  `````````         ``````` ``  `  \",\r\n\t\"S  SSSSSSSSS         SSSSSSS SS  S  \",\r\n\t\"W  WWWWWWWWW         WWWWWWW WW  W  \",\r\n\t\"\\\\  \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\         \\\\\\\\\\\\\\\\\\\\\\\\\\\\ \\\\\\\\ \\\\\\\\  \",\r\n\t\"E  EEEEEEEEE         EEEEEEE EE EE  \",\r\n\t\" 1 0        /.-,+*)('    & %$  #  \\\"!\",\r\n\t\"]  ]]]]]]]]]         ]]]]]]] ]] ]]  \",\r\n\t\"                             G      \"\r\n];\r\n\r\nXPathParser.gotoTable = [\r\n\t\"3456789:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"L456789:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"            M        EFGH IJ \",\r\n\t\"       N;<=>?@ AB  CDEFGH IJ \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"            S        EFGH IJ \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"              e              \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                        h  J \",\r\n\t\"              i          j   \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"o456789:;<=>?@ ABpqCDEFGH IJ \",\r\n\t\"                             \",\r\n\t\"  r6789:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"   s789:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"    t89:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"    u89:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"     v9:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"     w9:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"     x9:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"     y9:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"      z:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"      {:;<=>?@ AB  CDEFGH IJ \",\r\n\t\"       |;<=>?@ AB  CDEFGH IJ \",\r\n\t\"       };<=>?@ AB  CDEFGH IJ \",\r\n\t\"       ~;<=>?@ AB  CDEFGH IJ \",\r\n\t\"         \\x7f=>?@ AB  CDEFGH IJ \",\r\n\t\"\\x80456789:;<=>?@ AB  CDEFGH IJ\\x81\",\r\n\t\"            \\x82        EFGH IJ \",\r\n\t\"            \\x83        EFGH IJ \",\r\n\t\"                             \",\r\n\t\"                     \\x84 GH IJ \",\r\n\t\"                     \\x85 GH IJ \",\r\n\t\"              i          \\x86   \",\r\n\t\"              i          \\x87   \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"                             \",\r\n\t\"o456789:;<=>?@ AB\\x8cqCDEFGH IJ \",\r\n\t\"                             \",\r\n\t\"                             \"\r\n];\r\n\r\nXPathParser.productions = [\r\n\t[1, 1, 2],\r\n\t[2, 1, 3],\r\n\t[3, 1, 4],\r\n\t[3, 3, 3, -9, 4],\r\n\t[4, 1, 5],\r\n\t[4, 3, 4, -8, 5],\r\n\t[5, 1, 6],\r\n\t[5, 3, 5, -22, 6],\r\n\t[5, 3, 5, -5, 6],\r\n\t[6, 1, 7],\r\n\t[6, 3, 6, -23, 7],\r\n\t[6, 3, 6, -24, 7],\r\n\t[6, 3, 6, -6, 7],\r\n\t[6, 3, 6, -7, 7],\r\n\t[7, 1, 8],\r\n\t[7, 3, 7, -25, 8],\r\n\t[7, 3, 7, -26, 8],\r\n\t[8, 1, 9],\r\n\t[8, 3, 8, -12, 9],\r\n\t[8, 3, 8, -11, 9],\r\n\t[8, 3, 8, -10, 9],\r\n\t[9, 1, 10],\r\n\t[9, 2, -26, 9],\r\n\t[10, 1, 11],\r\n\t[10, 3, 10, -27, 11],\r\n\t[11, 1, 12],\r\n\t[11, 1, 13],\r\n\t[11, 3, 13, -28, 14],\r\n\t[11, 3, 13, -4, 14],\r\n\t[13, 1, 15],\r\n\t[13, 2, 13, 16],\r\n\t[15, 1, 17],\r\n\t[15, 3, -29, 2, -30],\r\n\t[15, 1, -15],\r\n\t[15, 1, -16],\r\n\t[15, 1, 18],\r\n\t[18, 3, -13, -29, -30],\r\n\t[18, 4, -13, -29, 19, -30],\r\n\t[19, 1, 20],\r\n\t[19, 3, 20, -31, 19],\r\n\t[20, 1, 2],\r\n\t[12, 1, 14],\r\n\t[12, 1, 21],\r\n\t[21, 1, -28],\r\n\t[21, 2, -28, 14],\r\n\t[21, 1, 22],\r\n\t[14, 1, 23],\r\n\t[14, 3, 14, -28, 23],\r\n\t[14, 1, 24],\r\n\t[23, 2, 25, 26],\r\n\t[23, 1, 26],\r\n\t[23, 3, 25, 26, 27],\r\n\t[23, 2, 26, 27],\r\n\t[23, 1, 28],\r\n\t[27, 1, 16],\r\n\t[27, 2, 16, 27],\r\n\t[25, 2, -14, -3],\r\n\t[25, 1, -32],\r\n\t[26, 1, 29],\r\n\t[26, 3, -20, -29, -30],\r\n\t[26, 4, -21, -29, -15, -30],\r\n\t[16, 3, -33, 30, -34],\r\n\t[30, 1, 2],\r\n\t[22, 2, -4, 14],\r\n\t[24, 3, 14, -4, 23],\r\n\t[28, 1, -35],\r\n\t[28, 1, -2],\r\n\t[17, 2, -36, -18],\r\n\t[29, 1, -17],\r\n\t[29, 1, -19],\r\n\t[29, 1, -18]\r\n];\r\n\r\nXPathParser.DOUBLEDOT = 2;\r\nXPathParser.DOUBLECOLON = 3;\r\nXPathParser.DOUBLESLASH = 4;\r\nXPathParser.NOTEQUAL = 5;\r\nXPathParser.LESSTHANOREQUAL = 6;\r\nXPathParser.GREATERTHANOREQUAL = 7;\r\nXPathParser.AND = 8;\r\nXPathParser.OR = 9;\r\nXPathParser.MOD = 10;\r\nXPathParser.DIV = 11;\r\nXPathParser.MULTIPLYOPERATOR = 12;\r\nXPathParser.FUNCTIONNAME = 13;\r\nXPathParser.AXISNAME = 14;\r\nXPathParser.LITERAL = 15;\r\nXPathParser.NUMBER = 16;\r\nXPathParser.ASTERISKNAMETEST = 17;\r\nXPathParser.QNAME = 18;\r\nXPathParser.NCNAMECOLONASTERISK = 19;\r\nXPathParser.NODETYPE = 20;\r\nXPathParser.PROCESSINGINSTRUCTIONWITHLITERAL = 21;\r\nXPathParser.EQUALS = 22;\r\nXPathParser.LESSTHAN = 23;\r\nXPathParser.GREATERTHAN = 24;\r\nXPathParser.PLUS = 25;\r\nXPathParser.MINUS = 26;\r\nXPathParser.BAR = 27;\r\nXPathParser.SLASH = 28;\r\nXPathParser.LEFTPARENTHESIS = 29;\r\nXPathParser.RIGHTPARENTHESIS = 30;\r\nXPathParser.COMMA = 31;\r\nXPathParser.AT = 32;\r\nXPathParser.LEFTBRACKET = 33;\r\nXPathParser.RIGHTBRACKET = 34;\r\nXPathParser.DOT = 35;\r\nXPathParser.DOLLAR = 36;\r\n\r\nXPathParser.prototype.tokenize = function(s1) {\r\n\tvar types = [];\r\n\tvar values = [];\r\n\tvar s = s1 + '\\0';\r\n\r\n\tvar pos = 0;\r\n\tvar c = s.charAt(pos++);\r\n\twhile (1) {\r\n\t\twhile (c == ' ' || c == '\\t' || c == '\\r' || c == '\\n') {\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t}\r\n\t\tif (c == '\\0' || pos >= s.length) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tif (c == '(') {\r\n\t\t\ttypes.push(XPathParser.LEFTPARENTHESIS);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == ')') {\r\n\t\t\ttypes.push(XPathParser.RIGHTPARENTHESIS);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == '[') {\r\n\t\t\ttypes.push(XPathParser.LEFTBRACKET);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == ']') {\r\n\t\t\ttypes.push(XPathParser.RIGHTBRACKET);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == '@') {\r\n\t\t\ttypes.push(XPathParser.AT);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == ',') {\r\n\t\t\ttypes.push(XPathParser.COMMA);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == '|') {\r\n\t\t\ttypes.push(XPathParser.BAR);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == '+') {\r\n\t\t\ttypes.push(XPathParser.PLUS);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == '-') {\r\n\t\t\ttypes.push(XPathParser.MINUS);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == '=') {\r\n\t\t\ttypes.push(XPathParser.EQUALS);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (c == '$') {\r\n\t\t\ttypes.push(XPathParser.DOLLAR);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (c == '.') {\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tif (c == '.') {\r\n\t\t\t\ttypes.push(XPathParser.DOUBLEDOT);\r\n\t\t\t\tvalues.push(\"..\");\r\n\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (c >= '0' && c <= '9') {\r\n\t\t\t\tvar number = \".\" + c;\r\n\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\twhile (c >= '0' && c <= '9') {\r\n\t\t\t\t\tnumber += c;\r\n\t\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\t}\r\n\t\t\t\ttypes.push(XPathParser.NUMBER);\r\n\t\t\t\tvalues.push(number);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\ttypes.push(XPathParser.DOT);\r\n\t\t\tvalues.push('.');\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (c == '\\'' || c == '\"') {\r\n\t\t\tvar delimiter = c;\r\n\t\t\tvar literal = \"\";\r\n\t\t\twhile (pos < s.length && (c = s.charAt(pos)) !== delimiter) {\r\n\t\t\t\tliteral += c;\r\n                pos += 1;\r\n\t\t\t}\r\n            if (c !== delimiter) {\r\n                throw XPathException.fromMessage(\"Unterminated string literal: \" + delimiter + literal);\r\n            }\r\n            pos += 1;\r\n\t\t\ttypes.push(XPathParser.LITERAL);\r\n\t\t\tvalues.push(literal);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (c >= '0' && c <= '9') {\r\n\t\t\tvar number = c;\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\twhile (c >= '0' && c <= '9') {\r\n\t\t\t\tnumber += c;\r\n\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t}\r\n\t\t\tif (c == '.') {\r\n\t\t\t\tif (s.charAt(pos) >= '0' && s.charAt(pos) <= '9') {\r\n\t\t\t\t\tnumber += c;\r\n\t\t\t\t\tnumber += s.charAt(pos++);\r\n\t\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\t\twhile (c >= '0' && c <= '9') {\r\n\t\t\t\t\t\tnumber += c;\r\n\t\t\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ttypes.push(XPathParser.NUMBER);\r\n\t\t\tvalues.push(number);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (c == '*') {\r\n\t\t\tif (types.length > 0) {\r\n\t\t\t\tvar last = types[types.length - 1];\r\n\t\t\t\tif (last != XPathParser.AT\r\n\t\t\t\t\t\t&& last != XPathParser.DOUBLECOLON\r\n\t\t\t\t\t\t&& last != XPathParser.LEFTPARENTHESIS\r\n\t\t\t\t\t\t&& last != XPathParser.LEFTBRACKET\r\n\t\t\t\t\t\t&& last != XPathParser.AND\r\n\t\t\t\t\t\t&& last != XPathParser.OR\r\n\t\t\t\t\t\t&& last != XPathParser.MOD\r\n\t\t\t\t\t\t&& last != XPathParser.DIV\r\n\t\t\t\t\t\t&& last != XPathParser.MULTIPLYOPERATOR\r\n\t\t\t\t\t\t&& last != XPathParser.SLASH\r\n\t\t\t\t\t\t&& last != XPathParser.DOUBLESLASH\r\n\t\t\t\t\t\t&& last != XPathParser.BAR\r\n\t\t\t\t\t\t&& last != XPathParser.PLUS\r\n\t\t\t\t\t\t&& last != XPathParser.MINUS\r\n\t\t\t\t\t\t&& last != XPathParser.EQUALS\r\n\t\t\t\t\t\t&& last != XPathParser.NOTEQUAL\r\n\t\t\t\t\t\t&& last != XPathParser.LESSTHAN\r\n\t\t\t\t\t\t&& last != XPathParser.LESSTHANOREQUAL\r\n\t\t\t\t\t\t&& last != XPathParser.GREATERTHAN\r\n\t\t\t\t\t\t&& last != XPathParser.GREATERTHANOREQUAL) {\r\n\t\t\t\t\ttypes.push(XPathParser.MULTIPLYOPERATOR);\r\n\t\t\t\t\tvalues.push(c);\r\n\t\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ttypes.push(XPathParser.ASTERISKNAMETEST);\r\n\t\t\tvalues.push(c);\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (c == ':') {\r\n\t\t\tif (s.charAt(pos) == ':') {\r\n\t\t\t\ttypes.push(XPathParser.DOUBLECOLON);\r\n\t\t\t\tvalues.push(\"::\");\r\n\t\t\t\tpos++;\r\n\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (c == '/') {\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tif (c == '/') {\r\n\t\t\t\ttypes.push(XPathParser.DOUBLESLASH);\r\n\t\t\t\tvalues.push(\"//\");\r\n\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\ttypes.push(XPathParser.SLASH);\r\n\t\t\tvalues.push('/');\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (c == '!') {\r\n\t\t\tif (s.charAt(pos) == '=') {\r\n\t\t\t\ttypes.push(XPathParser.NOTEQUAL);\r\n\t\t\t\tvalues.push(\"!=\");\r\n\t\t\t\tpos++;\r\n\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (c == '<') {\r\n\t\t\tif (s.charAt(pos) == '=') {\r\n\t\t\t\ttypes.push(XPathParser.LESSTHANOREQUAL);\r\n\t\t\t\tvalues.push(\"<=\");\r\n\t\t\t\tpos++;\r\n\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\ttypes.push(XPathParser.LESSTHAN);\r\n\t\t\tvalues.push('<');\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (c == '>') {\r\n\t\t\tif (s.charAt(pos) == '=') {\r\n\t\t\t\ttypes.push(XPathParser.GREATERTHANOREQUAL);\r\n\t\t\t\tvalues.push(\">=\");\r\n\t\t\t\tpos++;\r\n\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\ttypes.push(XPathParser.GREATERTHAN);\r\n\t\t\tvalues.push('>');\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (c == '_' || Utilities.isLetter(c.charCodeAt(0))) {\r\n\t\t\tvar name = c;\r\n\t\t\tc = s.charAt(pos++);\r\n\t\t\twhile (Utilities.isNCNameChar(c.charCodeAt(0))) {\r\n\t\t\t\tname += c;\r\n\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t}\r\n\t\t\tif (types.length > 0) {\r\n\t\t\t\tvar last = types[types.length - 1];\r\n\t\t\t\tif (last != XPathParser.AT\r\n\t\t\t\t\t\t&& last != XPathParser.DOUBLECOLON\r\n\t\t\t\t\t\t&& last != XPathParser.LEFTPARENTHESIS\r\n\t\t\t\t\t\t&& last != XPathParser.LEFTBRACKET\r\n\t\t\t\t\t\t&& last != XPathParser.AND\r\n\t\t\t\t\t\t&& last != XPathParser.OR\r\n\t\t\t\t\t\t&& last != XPathParser.MOD\r\n\t\t\t\t\t\t&& last != XPathParser.DIV\r\n\t\t\t\t\t\t&& last != XPathParser.MULTIPLYOPERATOR\r\n\t\t\t\t\t\t&& last != XPathParser.SLASH\r\n\t\t\t\t\t\t&& last != XPathParser.DOUBLESLASH\r\n\t\t\t\t\t\t&& last != XPathParser.BAR\r\n\t\t\t\t\t\t&& last != XPathParser.PLUS\r\n\t\t\t\t\t\t&& last != XPathParser.MINUS\r\n\t\t\t\t\t\t&& last != XPathParser.EQUALS\r\n\t\t\t\t\t\t&& last != XPathParser.NOTEQUAL\r\n\t\t\t\t\t\t&& last != XPathParser.LESSTHAN\r\n\t\t\t\t\t\t&& last != XPathParser.LESSTHANOREQUAL\r\n\t\t\t\t\t\t&& last != XPathParser.GREATERTHAN\r\n\t\t\t\t\t\t&& last != XPathParser.GREATERTHANOREQUAL) {\r\n\t\t\t\t\tif (name == \"and\") {\r\n\t\t\t\t\t\ttypes.push(XPathParser.AND);\r\n\t\t\t\t\t\tvalues.push(name);\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (name == \"or\") {\r\n\t\t\t\t\t\ttypes.push(XPathParser.OR);\r\n\t\t\t\t\t\tvalues.push(name);\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (name == \"mod\") {\r\n\t\t\t\t\t\ttypes.push(XPathParser.MOD);\r\n\t\t\t\t\t\tvalues.push(name);\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (name == \"div\") {\r\n\t\t\t\t\t\ttypes.push(XPathParser.DIV);\r\n\t\t\t\t\t\tvalues.push(name);\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (c == ':') {\r\n\t\t\t\tif (s.charAt(pos) == '*') {\r\n\t\t\t\t\ttypes.push(XPathParser.NCNAMECOLONASTERISK);\r\n\t\t\t\t\tvalues.push(name + \":*\");\r\n\t\t\t\t\tpos++;\r\n\t\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (s.charAt(pos) == '_' || Utilities.isLetter(s.charCodeAt(pos))) {\r\n\t\t\t\t\tname += ':';\r\n\t\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\t\twhile (Utilities.isNCNameChar(c.charCodeAt(0))) {\r\n\t\t\t\t\t\tname += c;\r\n\t\t\t\t\t\tc = s.charAt(pos++);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (c == '(') {\r\n\t\t\t\t\t\ttypes.push(XPathParser.FUNCTIONNAME);\r\n\t\t\t\t\t\tvalues.push(name);\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttypes.push(XPathParser.QNAME);\r\n\t\t\t\t\tvalues.push(name);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (s.charAt(pos) == ':') {\r\n\t\t\t\t\ttypes.push(XPathParser.AXISNAME);\r\n\t\t\t\t\tvalues.push(name);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (c == '(') {\r\n\t\t\t\tif (name == \"comment\" || name == \"text\" || name == \"node\") {\r\n\t\t\t\t\ttypes.push(XPathParser.NODETYPE);\r\n\t\t\t\t\tvalues.push(name);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (name == \"processing-instruction\") {\r\n\t\t\t\t\tif (s.charAt(pos) == ')') {\r\n\t\t\t\t\t\ttypes.push(XPathParser.NODETYPE);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttypes.push(XPathParser.PROCESSINGINSTRUCTIONWITHLITERAL);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvalues.push(name);\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\ttypes.push(XPathParser.FUNCTIONNAME);\r\n\t\t\t\tvalues.push(name);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\ttypes.push(XPathParser.QNAME);\r\n\t\t\tvalues.push(name);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tthrow new Error(\"Unexpected character \" + c);\r\n\t}\r\n\ttypes.push(1);\r\n\tvalues.push(\"[EOF]\");\r\n\treturn [types, values];\r\n};\r\n\r\nXPathParser.SHIFT = 's';\r\nXPathParser.REDUCE = 'r';\r\nXPathParser.ACCEPT = 'a';\r\n\r\nXPathParser.prototype.parse = function(s) {\r\n\tvar types;\r\n\tvar values;\r\n\tvar res = this.tokenize(s);\r\n\tif (res == undefined) {\r\n\t\treturn undefined;\r\n\t}\r\n\ttypes = res[0];\r\n\tvalues = res[1];\r\n\tvar tokenPos = 0;\r\n\tvar state = [];\r\n\tvar tokenType = [];\r\n\tvar tokenValue = [];\r\n\tvar s;\r\n\tvar a;\r\n\tvar t;\r\n\r\n\tstate.push(0);\r\n\ttokenType.push(1);\r\n\ttokenValue.push(\"_S\");\r\n\r\n\ta = types[tokenPos];\r\n\tt = values[tokenPos++];\r\n\twhile (1) {\r\n\t\ts = state[state.length - 1];\r\n\t\tswitch (XPathParser.actionTable[s].charAt(a - 1)) {\r\n\t\t\tcase XPathParser.SHIFT:\r\n\t\t\t\ttokenType.push(-a);\r\n\t\t\t\ttokenValue.push(t);\r\n\t\t\t\tstate.push(XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32);\r\n\t\t\t\ta = types[tokenPos];\r\n\t\t\t\tt = values[tokenPos++];\r\n\t\t\t\tbreak;\r\n\t\t\tcase XPathParser.REDUCE:\r\n\t\t\t\tvar num = XPathParser.productions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32][1];\r\n\t\t\t\tvar rhs = [];\r\n\t\t\t\tfor (var i = 0; i < num; i++) {\r\n\t\t\t\t\ttokenType.pop();\r\n\t\t\t\t\trhs.unshift(tokenValue.pop());\r\n\t\t\t\t\tstate.pop();\r\n\t\t\t\t}\r\n\t\t\t\tvar s_ = state[state.length - 1];\r\n\t\t\t\ttokenType.push(XPathParser.productions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32][0]);\r\n\t\t\t\tif (this.reduceActions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32] == undefined) {\r\n\t\t\t\t\ttokenValue.push(rhs[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttokenValue.push(this.reduceActions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32](rhs));\r\n\t\t\t\t}\r\n\t\t\t\tstate.push(XPathParser.gotoTable[s_].charCodeAt(XPathParser.productions[XPathParser.actionTableNumber[s].charCodeAt(a - 1) - 32][0] - 2) - 33);\r\n\t\t\t\tbreak;\r\n\t\t\tcase XPathParser.ACCEPT:\r\n\t\t\t\treturn new XPath(tokenValue.pop());\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error(\"XPath parse error\");\r\n\t\t}\r\n\t}\r\n};\r\n\r\n// XPath /////////////////////////////////////////////////////////////////////\r\n\r\nXPath.prototype = new Object();\r\nXPath.prototype.constructor = XPath;\r\nXPath.superclass = Object.prototype;\r\n\r\nfunction XPath(e) {\r\n\tthis.expression = e;\r\n}\r\n\r\nXPath.prototype.toString = function() {\r\n\treturn this.expression.toString();\r\n};\r\n\r\nfunction setIfUnset(obj, prop, value) {\r\n\tif (!(prop in obj)) {\r\n\t\tobj[prop] = value;\r\n\t}\r\n}\r\n\r\nXPath.prototype.evaluate = function(c) {\r\n\tc.contextNode = c.expressionContextNode;\r\n\tc.contextSize = 1;\r\n\tc.contextPosition = 1;\r\n\r\n\t// [2017-11-25] Removed usage of .implementation.hasFeature() since it does\r\n\t//              not reliably detect HTML DOMs (always returns false in xmldom and true in browsers)\r\n\tif (c.isHtml) {\r\n\t\tsetIfUnset(c, 'caseInsensitive', true);\r\n\t\tsetIfUnset(c, 'allowAnyNamespaceForNoPrefix', true);\r\n\t}\r\n\t\r\n    setIfUnset(c, 'caseInsensitive', false);\r\n\r\n\treturn this.expression.evaluate(c);\r\n};\r\n\r\nXPath.XML_NAMESPACE_URI = \"http://www.w3.org/XML/1998/namespace\";\r\nXPath.XMLNS_NAMESPACE_URI = \"http://www.w3.org/2000/xmlns/\";\r\n\r\n// Expression ////////////////////////////////////////////////////////////////\r\n\r\nExpression.prototype = new Object();\r\nExpression.prototype.constructor = Expression;\r\nExpression.superclass = Object.prototype;\r\n\r\nfunction Expression() {\r\n}\r\n\r\nExpression.prototype.init = function() {\r\n};\r\n\r\nExpression.prototype.toString = function() {\r\n\treturn \"<Expression>\";\r\n};\r\n\r\nExpression.prototype.evaluate = function(c) {\r\n\tthrow new Error(\"Could not evaluate expression.\");\r\n};\r\n\r\n// UnaryOperation ////////////////////////////////////////////////////////////\r\n\r\nUnaryOperation.prototype = new Expression();\r\nUnaryOperation.prototype.constructor = UnaryOperation;\r\nUnaryOperation.superclass = Expression.prototype;\r\n\r\nfunction UnaryOperation(rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(rhs);\r\n\t}\r\n}\r\n\r\nUnaryOperation.prototype.init = function(rhs) {\r\n\tthis.rhs = rhs;\r\n};\r\n\r\n// UnaryMinusOperation ///////////////////////////////////////////////////////\r\n\r\nUnaryMinusOperation.prototype = new UnaryOperation();\r\nUnaryMinusOperation.prototype.constructor = UnaryMinusOperation;\r\nUnaryMinusOperation.superclass = UnaryOperation.prototype;\r\n\r\nfunction UnaryMinusOperation(rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(rhs);\r\n\t}\r\n}\r\n\r\nUnaryMinusOperation.prototype.init = function(rhs) {\r\n\tUnaryMinusOperation.superclass.init.call(this, rhs);\r\n};\r\n\r\nUnaryMinusOperation.prototype.evaluate = function(c) {\r\n\treturn this.rhs.evaluate(c).number().negate();\r\n};\r\n\r\nUnaryMinusOperation.prototype.toString = function() {\r\n\treturn \"-\" + this.rhs.toString();\r\n};\r\n\r\n// BinaryOperation ///////////////////////////////////////////////////////////\r\n\r\nBinaryOperation.prototype = new Expression();\r\nBinaryOperation.prototype.constructor = BinaryOperation;\r\nBinaryOperation.superclass = Expression.prototype;\r\n\r\nfunction BinaryOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nBinaryOperation.prototype.init = function(lhs, rhs) {\r\n\tthis.lhs = lhs;\r\n\tthis.rhs = rhs;\r\n};\r\n\r\n// OrOperation ///////////////////////////////////////////////////////////////\r\n\r\nOrOperation.prototype = new BinaryOperation();\r\nOrOperation.prototype.constructor = OrOperation;\r\nOrOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction OrOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nOrOperation.prototype.init = function(lhs, rhs) {\r\n\tOrOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nOrOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" or \" + this.rhs.toString() + \")\";\r\n};\r\n\r\nOrOperation.prototype.evaluate = function(c) {\r\n\tvar b = this.lhs.evaluate(c).bool();\r\n\tif (b.booleanValue()) {\r\n\t\treturn b;\r\n\t}\r\n\treturn this.rhs.evaluate(c).bool();\r\n};\r\n\r\n// AndOperation //////////////////////////////////////////////////////////////\r\n\r\nAndOperation.prototype = new BinaryOperation();\r\nAndOperation.prototype.constructor = AndOperation;\r\nAndOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction AndOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nAndOperation.prototype.init = function(lhs, rhs) {\r\n\tAndOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nAndOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" and \" + this.rhs.toString() + \")\";\r\n};\r\n\r\nAndOperation.prototype.evaluate = function(c) {\r\n\tvar b = this.lhs.evaluate(c).bool();\r\n\tif (!b.booleanValue()) {\r\n\t\treturn b;\r\n\t}\r\n\treturn this.rhs.evaluate(c).bool();\r\n};\r\n\r\n// EqualsOperation ///////////////////////////////////////////////////////////\r\n\r\nEqualsOperation.prototype = new BinaryOperation();\r\nEqualsOperation.prototype.constructor = EqualsOperation;\r\nEqualsOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction EqualsOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nEqualsOperation.prototype.init = function(lhs, rhs) {\r\n\tEqualsOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nEqualsOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" = \" + this.rhs.toString() + \")\";\r\n};\r\n\r\nEqualsOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).equals(this.rhs.evaluate(c));\r\n};\r\n\r\n// NotEqualOperation /////////////////////////////////////////////////////////\r\n\r\nNotEqualOperation.prototype = new BinaryOperation();\r\nNotEqualOperation.prototype.constructor = NotEqualOperation;\r\nNotEqualOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction NotEqualOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nNotEqualOperation.prototype.init = function(lhs, rhs) {\r\n\tNotEqualOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nNotEqualOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" != \" + this.rhs.toString() + \")\";\r\n};\r\n\r\nNotEqualOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).notequal(this.rhs.evaluate(c));\r\n};\r\n\r\n// LessThanOperation /////////////////////////////////////////////////////////\r\n\r\nLessThanOperation.prototype = new BinaryOperation();\r\nLessThanOperation.prototype.constructor = LessThanOperation;\r\nLessThanOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction LessThanOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nLessThanOperation.prototype.init = function(lhs, rhs) {\r\n\tLessThanOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nLessThanOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).lessthan(this.rhs.evaluate(c));\r\n};\r\n\r\nLessThanOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" < \" + this.rhs.toString() + \")\";\r\n};\r\n\r\n// GreaterThanOperation //////////////////////////////////////////////////////\r\n\r\nGreaterThanOperation.prototype = new BinaryOperation();\r\nGreaterThanOperation.prototype.constructor = GreaterThanOperation;\r\nGreaterThanOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction GreaterThanOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nGreaterThanOperation.prototype.init = function(lhs, rhs) {\r\n\tGreaterThanOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nGreaterThanOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).greaterthan(this.rhs.evaluate(c));\r\n};\r\n\r\nGreaterThanOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" > \" + this.rhs.toString() + \")\";\r\n};\r\n\r\n// LessThanOrEqualOperation //////////////////////////////////////////////////\r\n\r\nLessThanOrEqualOperation.prototype = new BinaryOperation();\r\nLessThanOrEqualOperation.prototype.constructor = LessThanOrEqualOperation;\r\nLessThanOrEqualOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction LessThanOrEqualOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nLessThanOrEqualOperation.prototype.init = function(lhs, rhs) {\r\n\tLessThanOrEqualOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nLessThanOrEqualOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).lessthanorequal(this.rhs.evaluate(c));\r\n};\r\n\r\nLessThanOrEqualOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" <= \" + this.rhs.toString() + \")\";\r\n};\r\n\r\n// GreaterThanOrEqualOperation ///////////////////////////////////////////////\r\n\r\nGreaterThanOrEqualOperation.prototype = new BinaryOperation();\r\nGreaterThanOrEqualOperation.prototype.constructor = GreaterThanOrEqualOperation;\r\nGreaterThanOrEqualOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction GreaterThanOrEqualOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nGreaterThanOrEqualOperation.prototype.init = function(lhs, rhs) {\r\n\tGreaterThanOrEqualOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nGreaterThanOrEqualOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).greaterthanorequal(this.rhs.evaluate(c));\r\n};\r\n\r\nGreaterThanOrEqualOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" >= \" + this.rhs.toString() + \")\";\r\n};\r\n\r\n// PlusOperation /////////////////////////////////////////////////////////////\r\n\r\nPlusOperation.prototype = new BinaryOperation();\r\nPlusOperation.prototype.constructor = PlusOperation;\r\nPlusOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction PlusOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nPlusOperation.prototype.init = function(lhs, rhs) {\r\n\tPlusOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nPlusOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).number().plus(this.rhs.evaluate(c).number());\r\n};\r\n\r\nPlusOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" + \" + this.rhs.toString() + \")\";\r\n};\r\n\r\n// MinusOperation ////////////////////////////////////////////////////////////\r\n\r\nMinusOperation.prototype = new BinaryOperation();\r\nMinusOperation.prototype.constructor = MinusOperation;\r\nMinusOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction MinusOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nMinusOperation.prototype.init = function(lhs, rhs) {\r\n\tMinusOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nMinusOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).number().minus(this.rhs.evaluate(c).number());\r\n};\r\n\r\nMinusOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" - \" + this.rhs.toString() + \")\";\r\n};\r\n\r\n// MultiplyOperation /////////////////////////////////////////////////////////\r\n\r\nMultiplyOperation.prototype = new BinaryOperation();\r\nMultiplyOperation.prototype.constructor = MultiplyOperation;\r\nMultiplyOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction MultiplyOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nMultiplyOperation.prototype.init = function(lhs, rhs) {\r\n\tMultiplyOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nMultiplyOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).number().multiply(this.rhs.evaluate(c).number());\r\n};\r\n\r\nMultiplyOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" * \" + this.rhs.toString() + \")\";\r\n};\r\n\r\n// DivOperation //////////////////////////////////////////////////////////////\r\n\r\nDivOperation.prototype = new BinaryOperation();\r\nDivOperation.prototype.constructor = DivOperation;\r\nDivOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction DivOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nDivOperation.prototype.init = function(lhs, rhs) {\r\n\tDivOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nDivOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).number().div(this.rhs.evaluate(c).number());\r\n};\r\n\r\nDivOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" div \" + this.rhs.toString() + \")\";\r\n};\r\n\r\n// ModOperation //////////////////////////////////////////////////////////////\r\n\r\nModOperation.prototype = new BinaryOperation();\r\nModOperation.prototype.constructor = ModOperation;\r\nModOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction ModOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nModOperation.prototype.init = function(lhs, rhs) {\r\n\tModOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nModOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).number().mod(this.rhs.evaluate(c).number());\r\n};\r\n\r\nModOperation.prototype.toString = function() {\r\n\treturn \"(\" + this.lhs.toString() + \" mod \" + this.rhs.toString() + \")\";\r\n};\r\n\r\n// BarOperation //////////////////////////////////////////////////////////////\r\n\r\nBarOperation.prototype = new BinaryOperation();\r\nBarOperation.prototype.constructor = BarOperation;\r\nBarOperation.superclass = BinaryOperation.prototype;\r\n\r\nfunction BarOperation(lhs, rhs) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(lhs, rhs);\r\n\t}\r\n}\r\n\r\nBarOperation.prototype.init = function(lhs, rhs) {\r\n\tBarOperation.superclass.init.call(this, lhs, rhs);\r\n};\r\n\r\nBarOperation.prototype.evaluate = function(c) {\r\n\treturn this.lhs.evaluate(c).nodeset().union(this.rhs.evaluate(c).nodeset());\r\n};\r\n\r\nBarOperation.prototype.toString = function() {\r\n\treturn map(toString, [this.lhs, this.rhs]).join(' | ');\r\n};\r\n\r\n// PathExpr //////////////////////////////////////////////////////////////////\r\n\r\nPathExpr.prototype = new Expression();\r\nPathExpr.prototype.constructor = PathExpr;\r\nPathExpr.superclass = Expression.prototype;\r\n\r\nfunction PathExpr(filter, filterPreds, locpath) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(filter, filterPreds, locpath);\r\n\t}\r\n}\r\n\r\nPathExpr.prototype.init = function(filter, filterPreds, locpath) {\r\n\tPathExpr.superclass.init.call(this);\r\n\tthis.filter = filter;\r\n\tthis.filterPredicates = filterPreds;\r\n\tthis.locationPath = locpath;\r\n};\r\n\r\n/**\r\n * Returns the topmost node of the tree containing node\r\n */\r\nfunction findRoot(node) {\r\n    while (node && node.parentNode) {\r\n        node = node.parentNode;\r\n    }\r\n\r\n    return node;\r\n}\r\n\r\nPathExpr.applyPredicates = function (predicates, c, nodes) {\r\n\treturn reduce(function (inNodes, pred) {\r\n\t\tvar ctx = c.extend({ contextSize: inNodes.length });\r\n\t\t\r\n\t\treturn filter(function (node, i) {\r\n\t\t\treturn PathExpr.predicateMatches(pred, ctx.extend({ contextNode: node, contextPosition: i + 1 }));\r\n\t\t}, inNodes);\r\n\t}, nodes, predicates);\r\n};\r\n\r\nPathExpr.getRoot = function (xpc, nodes) {\r\n\tvar firstNode = nodes[0];\r\n\t\r\n    if (firstNode.nodeType === 9 /*Node.DOCUMENT_NODE*/) {\r\n\t\treturn firstNode;\r\n\t}\r\n\t\r\n    if (xpc.virtualRoot) {\r\n    \treturn xpc.virtualRoot;\r\n    }\r\n\t\t\r\n\tvar ownerDoc = firstNode.ownerDocument;\r\n\t\r\n\tif (ownerDoc) {\r\n\t\treturn ownerDoc;\r\n\t}\r\n\t\t\t\r\n    // IE 5.5 doesn't have ownerDocument?\r\n    var n = firstNode;\r\n    while (n.parentNode != null) {\r\n    \tn = n.parentNode;\r\n    }\r\n    return n;\r\n}\r\n\r\nPathExpr.applyStep = function (step, xpc, node) {\r\n\tvar self = this;\r\n\tvar newNodes = [];\r\n    xpc.contextNode = node;\r\n    \r\n    switch (step.axis) {\r\n    \tcase Step.ANCESTOR:\r\n    \t\t// look at all the ancestor nodes\r\n    \t\tif (xpc.contextNode === xpc.virtualRoot) {\r\n    \t\t\tbreak;\r\n    \t\t}\r\n    \t\tvar m;\r\n    \t\tif (xpc.contextNode.nodeType == 2 /*Node.ATTRIBUTE_NODE*/) {\r\n    \t\t\tm = PathExpr.getOwnerElement(xpc.contextNode);\r\n    \t\t} else {\r\n    \t\t\tm = xpc.contextNode.parentNode;\r\n    \t\t}\r\n    \t\twhile (m != null) {\r\n    \t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n    \t\t\t\tnewNodes.push(m);\r\n    \t\t\t}\r\n    \t\t\tif (m === xpc.virtualRoot) {\r\n    \t\t\t\tbreak;\r\n    \t\t\t}\r\n    \t\t\tm = m.parentNode;\r\n    \t\t}\r\n    \t\tbreak;\r\n    \r\n    \tcase Step.ANCESTORORSELF:\r\n    \t\t// look at all the ancestor nodes and the current node\r\n    \t\tfor (var m = xpc.contextNode; m != null; m = m.nodeType == 2 /*Node.ATTRIBUTE_NODE*/ ? PathExpr.getOwnerElement(m) : m.parentNode) {\r\n    \t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n    \t\t\t\tnewNodes.push(m);\r\n    \t\t\t}\r\n    \t\t\tif (m === xpc.virtualRoot) {\r\n    \t\t\t\tbreak;\r\n    \t\t\t}\r\n    \t\t}\r\n    \t\tbreak;\r\n    \r\n    \tcase Step.ATTRIBUTE:\r\n    \t\t// look at the attributes\r\n    \t\tvar nnm = xpc.contextNode.attributes;\r\n    \t\tif (nnm != null) {\r\n    \t\t\tfor (var k = 0; k < nnm.length; k++) {\r\n    \t\t\t\tvar m = nnm.item(k);\r\n    \t\t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n    \t\t\t\t\tnewNodes.push(m);\r\n    \t\t\t\t}\r\n    \t\t\t}\r\n    \t\t}\r\n    \t\tbreak;\r\n    \r\n    \tcase Step.CHILD:\r\n    \t\t// look at all child elements\r\n    \t\tfor (var m = xpc.contextNode.firstChild; m != null; m = m.nextSibling) {\r\n    \t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n    \t\t\t\tnewNodes.push(m);\r\n    \t\t\t}\r\n    \t\t}\r\n    \t\tbreak;\r\n    \r\n    \tcase Step.DESCENDANT:\r\n    \t\t// look at all descendant nodes\r\n    \t\tvar st = [ xpc.contextNode.firstChild ];\r\n    \t\twhile (st.length > 0) {\r\n    \t\t\tfor (var m = st.pop(); m != null; ) {\r\n    \t\t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n    \t\t\t\t\tnewNodes.push(m);\r\n    \t\t\t\t}\r\n    \t\t\t\tif (m.firstChild != null) {\r\n    \t\t\t\t\tst.push(m.nextSibling);\r\n    \t\t\t\t\tm = m.firstChild;\r\n    \t\t\t\t} else {\r\n    \t\t\t\t\tm = m.nextSibling;\r\n    \t\t\t\t}\r\n    \t\t\t}\r\n    \t\t}\r\n    \t\tbreak;\r\n    \r\n    \tcase Step.DESCENDANTORSELF:\r\n    \t\t// look at self\r\n    \t\tif (step.nodeTest.matches(xpc.contextNode, xpc)) {\r\n    \t\t\tnewNodes.push(xpc.contextNode);\r\n    \t\t}\r\n    \t\t// look at all descendant nodes\r\n    \t\tvar st = [ xpc.contextNode.firstChild ];\r\n    \t\twhile (st.length > 0) {\r\n    \t\t\tfor (var m = st.pop(); m != null; ) {\r\n    \t\t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n    \t\t\t\t\tnewNodes.push(m);\r\n    \t\t\t\t}\r\n    \t\t\t\tif (m.firstChild != null) {\r\n    \t\t\t\t\tst.push(m.nextSibling);\r\n    \t\t\t\t\tm = m.firstChild;\r\n    \t\t\t\t} else {\r\n    \t\t\t\t\tm = m.nextSibling;\r\n    \t\t\t\t}\r\n    \t\t\t}\r\n    \t\t}\r\n    \t\tbreak;\r\n    \r\n    \tcase Step.FOLLOWING:\r\n    \t\tif (xpc.contextNode === xpc.virtualRoot) {\r\n    \t\t\tbreak;\r\n    \t\t}\r\n    \t\tvar st = [];\r\n    \t\tif (xpc.contextNode.firstChild != null) {\r\n    \t\t\tst.unshift(xpc.contextNode.firstChild);\r\n    \t\t} else {\r\n    \t\t\tst.unshift(xpc.contextNode.nextSibling);\r\n    \t\t}\r\n    \t\tfor (var m = xpc.contextNode.parentNode; m != null && m.nodeType != 9 /*Node.DOCUMENT_NODE*/ && m !== xpc.virtualRoot; m = m.parentNode) {\r\n    \t\t\tst.unshift(m.nextSibling);\r\n    \t\t}\r\n    \t\tdo {\r\n    \t\t\tfor (var m = st.pop(); m != null; ) {\r\n    \t\t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n    \t\t\t\t\tnewNodes.push(m);\r\n    \t\t\t\t}\r\n    \t\t\t\tif (m.firstChild != null) {\r\n    \t\t\t\t\tst.push(m.nextSibling);\r\n    \t\t\t\t\tm = m.firstChild;\r\n    \t\t\t\t} else {\r\n    \t\t\t\t\tm = m.nextSibling;\r\n    \t\t\t\t}\r\n    \t\t\t}\r\n    \t\t} while (st.length > 0);\r\n    \t\tbreak;\r\n    \r\n    \tcase Step.FOLLOWINGSIBLING:\r\n    \t\tif (xpc.contextNode === xpc.virtualRoot) {\r\n    \t\t\tbreak;\r\n    \t\t}\r\n    \t\tfor (var m = xpc.contextNode.nextSibling; m != null; m = m.nextSibling) {\r\n    \t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n    \t\t\t\tnewNodes.push(m);\r\n    \t\t\t}\r\n    \t\t}\r\n    \t\tbreak;\r\n    \r\n    \tcase Step.NAMESPACE:\r\n    \t\tvar n = {};\r\n    \t\tif (xpc.contextNode.nodeType == 1 /*Node.ELEMENT_NODE*/) {\r\n    \t\t\tn[\"xml\"] = XPath.XML_NAMESPACE_URI;\r\n    \t\t\tn[\"xmlns\"] = XPath.XMLNS_NAMESPACE_URI;\r\n    \t\t\tfor (var m = xpc.contextNode; m != null && m.nodeType == 1 /*Node.ELEMENT_NODE*/; m = m.parentNode) {\r\n    \t\t\t\tfor (var k = 0; k < m.attributes.length; k++) {\r\n    \t\t\t\t\tvar attr = m.attributes.item(k);\r\n    \t\t\t\t\tvar nm = String(attr.name);\r\n    \t\t\t\t\tif (nm == \"xmlns\") {\r\n    \t\t\t\t\t\tif (n[\"\"] == undefined) {\r\n    \t\t\t\t\t\t\tn[\"\"] = attr.value;\r\n    \t\t\t\t\t\t}\r\n    \t\t\t\t\t} else if (nm.length > 6 && nm.substring(0, 6) == \"xmlns:\") {\r\n    \t\t\t\t\t\tvar pre = nm.substring(6, nm.length);\r\n    \t\t\t\t\t\tif (n[pre] == undefined) {\r\n    \t\t\t\t\t\t\tn[pre] = attr.value;\r\n    \t\t\t\t\t\t}\r\n    \t\t\t\t\t}\r\n    \t\t\t\t}\r\n    \t\t\t}\r\n    \t\t\tfor (var pre in n) {\r\n    \t\t\t\tvar nsn = new XPathNamespace(pre, n[pre], xpc.contextNode);\r\n    \t\t\t\tif (step.nodeTest.matches(nsn, xpc)) {\r\n    \t\t\t\t\tnewNodes.push(nsn);\r\n    \t\t\t\t}\r\n    \t\t\t}\r\n    \t\t}\r\n    \t\tbreak;\r\n    \r\n    \tcase Step.PARENT:\r\n    \t\tm = null;\r\n    \t\tif (xpc.contextNode !== xpc.virtualRoot) {\r\n    \t\t\tif (xpc.contextNode.nodeType == 2 /*Node.ATTRIBUTE_NODE*/) {\r\n    \t\t\t\tm = PathExpr.getOwnerElement(xpc.contextNode);\r\n    \t\t\t} else {\r\n    \t\t\t\tm = xpc.contextNode.parentNode;\r\n    \t\t\t}\r\n    \t\t}\r\n    \t\tif (m != null && step.nodeTest.matches(m, xpc)) {\r\n    \t\t\tnewNodes.push(m);\r\n    \t\t}\r\n    \t\tbreak;\r\n    \r\n    \tcase Step.PRECEDING:\r\n    \t\tvar st;\r\n    \t\tif (xpc.virtualRoot != null) {\r\n    \t\t\tst = [ xpc.virtualRoot ];\r\n    \t\t} else {\r\n                // cannot rely on .ownerDocument because the node may be in a document fragment\r\n                st = [findRoot(xpc.contextNode)];\r\n    \t\t}\r\n    \t\touter: while (st.length > 0) {\r\n    \t\t\tfor (var m = st.pop(); m != null; ) {\r\n    \t\t\t\tif (m == xpc.contextNode) {\r\n    \t\t\t\t\tbreak outer;\r\n    \t\t\t\t}\r\n    \t\t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n    \t\t\t\t\tnewNodes.unshift(m);\r\n    \t\t\t\t}\r\n    \t\t\t\tif (m.firstChild != null) {\r\n    \t\t\t\t\tst.push(m.nextSibling);\r\n    \t\t\t\t\tm = m.firstChild;\r\n    \t\t\t\t} else {\r\n    \t\t\t\t\tm = m.nextSibling;\r\n    \t\t\t\t}\r\n    \t\t\t}\r\n    \t\t}\r\n    \t\tbreak;\r\n    \r\n    \tcase Step.PRECEDINGSIBLING:\r\n    \t\tif (xpc.contextNode === xpc.virtualRoot) {\r\n    \t\t\tbreak;\r\n    \t\t}\r\n    \t\tfor (var m = xpc.contextNode.previousSibling; m != null; m = m.previousSibling) {\r\n    \t\t\tif (step.nodeTest.matches(m, xpc)) {\r\n    \t\t\t\tnewNodes.push(m);\r\n    \t\t\t}\r\n    \t\t}\r\n    \t\tbreak;\r\n    \r\n    \tcase Step.SELF:\r\n    \t\tif (step.nodeTest.matches(xpc.contextNode, xpc)) {\r\n    \t\t\tnewNodes.push(xpc.contextNode);\r\n    \t\t}\r\n    \t\tbreak;\r\n    \r\n    \tdefault:\r\n    }\r\n\t\r\n\treturn newNodes;\r\n};\r\n\r\nPathExpr.applySteps = function (steps, xpc, nodes) {\r\n\treturn reduce(function (inNodes, step) {\r\n\t\treturn [].concat.apply([], map(function (node) {\r\n\t\t\treturn PathExpr.applyPredicates(step.predicates, xpc, PathExpr.applyStep(step, xpc, node));\r\n\t\t}, inNodes));\r\n\t}, nodes, steps);\r\n}\r\n\r\nPathExpr.prototype.applyFilter = function(c, xpc) {\r\n\tif (!this.filter) {\r\n\t\treturn { nodes: [ c.contextNode ] };\r\n\t}\r\n\t\r\n\tvar ns = this.filter.evaluate(c);\r\n\r\n\tif (!Utilities.instance_of(ns, XNodeSet)) {\r\n        if (this.filterPredicates != null && this.filterPredicates.length > 0 || this.locationPath != null) {\r\n\t\t    throw new Error(\"Path expression filter must evaluate to a nodeset if predicates or location path are used\");\r\n\t\t}\r\n\r\n\t\treturn { nonNodes: ns };\r\n\t}\r\n\t\r\n\treturn { \r\n\t    nodes: PathExpr.applyPredicates(this.filterPredicates || [], xpc, ns.toUnsortedArray())\r\n\t};\r\n};\r\n\r\nPathExpr.applyLocationPath = function (locationPath, xpc, nodes) {\r\n\tif (!locationPath) {\r\n\t\treturn nodes;\r\n\t}\r\n\t\r\n\tvar startNodes = locationPath.absolute ? [ PathExpr.getRoot(xpc, nodes) ] : nodes;\r\n\t\t\r\n    return PathExpr.applySteps(locationPath.steps, xpc, startNodes);\r\n};\r\n\r\nPathExpr.prototype.evaluate = function(c) {\r\n\tvar xpc = assign(new XPathContext(), c);\r\n\t\r\n    var filterResult = this.applyFilter(c, xpc);\r\n\t\r\n\tif ('nonNodes' in filterResult) {\r\n\t\treturn filterResult.nonNodes;\r\n\t}\t\r\n\t\r\n\tvar ns = new XNodeSet();\r\n\tns.addArray(PathExpr.applyLocationPath(this.locationPath, xpc, filterResult.nodes));\r\n\treturn ns;\r\n};\r\n\r\nPathExpr.predicateMatches = function(pred, c) {\r\n\tvar res = pred.evaluate(c);\r\n\t\r\n\treturn Utilities.instance_of(res, XNumber)\r\n\t\t? c.contextPosition == res.numberValue()\r\n\t\t: res.booleanValue();\r\n};\r\n\r\nPathExpr.predicateString = compose(wrap('[', ']'), toString);\r\nPathExpr.predicatesString = compose(join(''), map(PathExpr.predicateString));\r\n\r\nPathExpr.prototype.toString = function() {\r\n\tif (this.filter != undefined) {\r\n\t\tvar filterStr = toString(this.filter);\r\n\r\n\t\tif (Utilities.instance_of(this.filter, XString)) {\r\n\t\t\treturn wrap(\"'\", \"'\", filterStr);\r\n\t\t}\r\n\t\tif (this.filterPredicates != undefined && this.filterPredicates.length) {\r\n\t\t\treturn wrap('(', ')', filterStr) + \r\n\t\t\t    PathExpr.predicatesString(this.filterPredicates);\r\n\t\t}\r\n\t\tif (this.locationPath != undefined) {\r\n\t\t\treturn filterStr + \r\n\t\t\t    (this.locationPath.absolute ? '' : '/') +\r\n\t\t\t\ttoString(this.locationPath);\r\n\t\t}\r\n\r\n\t\treturn filterStr;\r\n\t}\r\n\r\n\treturn toString(this.locationPath);\r\n};\r\n\r\nPathExpr.getOwnerElement = function(n) {\r\n\t// DOM 2 has ownerElement\r\n\tif (n.ownerElement) {\r\n\t\treturn n.ownerElement;\r\n\t}\r\n\t// DOM 1 Internet Explorer can use selectSingleNode (ironically)\r\n\ttry {\r\n\t\tif (n.selectSingleNode) {\r\n\t\t\treturn n.selectSingleNode(\"..\");\r\n\t\t}\r\n\t} catch (e) {\r\n\t}\r\n\t// Other DOM 1 implementations must use this egregious search\r\n\tvar doc = n.nodeType == 9 /*Node.DOCUMENT_NODE*/\r\n\t\t\t? n\r\n\t\t\t: n.ownerDocument;\r\n\tvar elts = doc.getElementsByTagName(\"*\");\r\n\tfor (var i = 0; i < elts.length; i++) {\r\n\t\tvar elt = elts.item(i);\r\n\t\tvar nnm = elt.attributes;\r\n\t\tfor (var j = 0; j < nnm.length; j++) {\r\n\t\t\tvar an = nnm.item(j);\r\n\t\t\tif (an === n) {\r\n\t\t\t\treturn elt;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\n// LocationPath //////////////////////////////////////////////////////////////\r\n\r\nLocationPath.prototype = new Object();\r\nLocationPath.prototype.constructor = LocationPath;\r\nLocationPath.superclass = Object.prototype;\r\n\r\nfunction LocationPath(abs, steps) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(abs, steps);\r\n\t}\r\n}\r\n\r\nLocationPath.prototype.init = function(abs, steps) {\r\n\tthis.absolute = abs;\r\n\tthis.steps = steps;\r\n};\r\n\r\nLocationPath.prototype.toString = function() {\r\n\treturn (\r\n\t    (this.absolute ? '/' : '') +\r\n\t\tmap(toString, this.steps).join('/')\r\n    );\r\n};\r\n\r\n// Step //////////////////////////////////////////////////////////////////////\r\n\r\nStep.prototype = new Object();\r\nStep.prototype.constructor = Step;\r\nStep.superclass = Object.prototype;\r\n\r\nfunction Step(axis, nodetest, preds) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(axis, nodetest, preds);\r\n\t}\r\n}\r\n\r\nStep.prototype.init = function(axis, nodetest, preds) {\r\n\tthis.axis = axis;\r\n\tthis.nodeTest = nodetest;\r\n\tthis.predicates = preds;\r\n};\r\n\r\nStep.prototype.toString = function() {\r\n\treturn Step.STEPNAMES[this.axis] +\r\n        \"::\" +\r\n        this.nodeTest.toString() +\r\n\t    PathExpr.predicatesString(this.predicates);\r\n};\r\n\r\n\r\nStep.ANCESTOR = 0;\r\nStep.ANCESTORORSELF = 1;\r\nStep.ATTRIBUTE = 2;\r\nStep.CHILD = 3;\r\nStep.DESCENDANT = 4;\r\nStep.DESCENDANTORSELF = 5;\r\nStep.FOLLOWING = 6;\r\nStep.FOLLOWINGSIBLING = 7;\r\nStep.NAMESPACE = 8;\r\nStep.PARENT = 9;\r\nStep.PRECEDING = 10;\r\nStep.PRECEDINGSIBLING = 11;\r\nStep.SELF = 12;\r\n\r\nStep.STEPNAMES = reduce(function (acc, x) { return acc[x[0]] = x[1], acc; }, {}, [\r\n\t[Step.ANCESTOR, 'ancestor'],\r\n\t[Step.ANCESTORORSELF, 'ancestor-or-self'],\r\n\t[Step.ATTRIBUTE, 'attribute'],\r\n\t[Step.CHILD, 'child'],\r\n\t[Step.DESCENDANT, 'descendant'],\r\n\t[Step.DESCENDANTORSELF, 'descendant-or-self'],\r\n\t[Step.FOLLOWING, 'following'],\r\n\t[Step.FOLLOWINGSIBLING, 'following-sibling'],\r\n\t[Step.NAMESPACE, 'namespace'],\r\n\t[Step.PARENT, 'parent'],\r\n\t[Step.PRECEDING, 'preceding'],\r\n\t[Step.PRECEDINGSIBLING, 'preceding-sibling'],\r\n\t[Step.SELF, 'self']\r\n  ]);\r\n  \r\n// NodeTest //////////////////////////////////////////////////////////////////\r\n\r\nNodeTest.prototype = new Object();\r\nNodeTest.prototype.constructor = NodeTest;\r\nNodeTest.superclass = Object.prototype;\r\n\r\nfunction NodeTest(type, value) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(type, value);\r\n\t}\r\n}\r\n\r\nNodeTest.prototype.init = function(type, value) {\r\n\tthis.type = type;\r\n\tthis.value = value;\r\n};\r\n\r\nNodeTest.prototype.toString = function() {\r\n\treturn \"<unknown nodetest type>\";\r\n};\r\n\r\nNodeTest.prototype.matches = function (n, xpc) {\r\n    console.warn('unknown node test type');\r\n};\r\n\r\nNodeTest.NAMETESTANY = 0;\r\nNodeTest.NAMETESTPREFIXANY = 1;\r\nNodeTest.NAMETESTQNAME = 2;\r\nNodeTest.COMMENT = 3;\r\nNodeTest.TEXT = 4;\r\nNodeTest.PI = 5;\r\nNodeTest.NODE = 6;\r\n\r\nNodeTest.isNodeType = function (types){\r\n\treturn compose(includes(types), prop('nodeType'));\r\n};\r\n\r\nNodeTest.makeNodeTestType = function (type, members, ctor) {\r\n\tvar newType = ctor || function () {};\r\n\t\r\n\tnewType.prototype = new NodeTest(members.type);\r\n\tnewType.prototype.constructor = type;\r\n\t\r\n\tfor (var key in members) {\r\n\t\tnewType.prototype[key] = members[key];\r\n\t}\r\n\t\r\n\treturn newType;\r\n};\r\n// create invariant node test for certain node types\r\nNodeTest.makeNodeTypeTest = function (type, nodeTypes, stringVal) {\r\n\treturn new (NodeTest.makeNodeTestType(type, {\r\n\t\tmatches: NodeTest.isNodeType(nodeTypes),\r\n\t\ttoString: always(stringVal)\r\n\t}))();\r\n};\r\n\r\nNodeTest.hasPrefix = function (node) {\r\n\treturn node.prefix || (node.nodeName || node.tagName).indexOf(':') !== -1;\r\n};\r\n\r\nNodeTest.isElementOrAttribute = NodeTest.isNodeType([1, 2]);\r\nNodeTest.nameSpaceMatches = function (prefix, xpc, n) {\r\n\tvar nNamespace = (n.namespaceURI || '');\r\n\t\r\n\tif (!prefix) { \r\n\t    return !nNamespace || (xpc.allowAnyNamespaceForNoPrefix && !NodeTest.hasPrefix(n)); \r\n\t}\r\n\t\r\n    var ns = xpc.namespaceResolver.getNamespace(prefix, xpc.expressionContextNode);\r\n\r\n\tif (ns == null) {\r\n        throw new Error(\"Cannot resolve QName \" + prefix);\r\n    }\r\n\r\n    return ns === nNamespace;\r\n};\r\nNodeTest.localNameMatches = function (localName, xpc, n) {\r\n\tvar nLocalName = (n.localName || n.nodeName);\r\n\t\r\n\treturn xpc.caseInsensitive\r\n\t    ? localName.toLowerCase() === nLocalName.toLowerCase()\r\n\t\t: localName === nLocalName;\r\n};\r\n\r\nNodeTest.NameTestPrefixAny = NodeTest.makeNodeTestType(NodeTest.NAMETESTPREFIXANY, {\r\n\tmatches: function (n, xpc){\r\n        return NodeTest.isElementOrAttribute(n) && \r\n\t\t    NodeTest.nameSpaceMatches(this.prefix, xpc, n);\r\n\t},\r\n\ttoString: function () {\r\n\t\treturn this.prefix + \":*\";\r\n\t}\r\n}, function (prefix) { this.prefix = prefix; });\r\n\r\nNodeTest.NameTestQName = NodeTest.makeNodeTestType(NodeTest.NAMETESTQNAME, {\r\n\tmatches: function (n, xpc) {\r\n\t\treturn NodeTest.isNodeType([1, 2, XPathNamespace.XPATH_NAMESPACE_NODE])(n) &&\r\n\t\t    NodeTest.nameSpaceMatches(this.prefix, xpc, n) &&\r\n            NodeTest.localNameMatches(this.localName, xpc, n);\r\n\t},\r\n\ttoString: function () {\r\n        return this.name;\r\n\t}\r\n}, function (name) { \r\n    var nameParts = name.split(':');\r\n\t\r\n\tthis.name = name;\r\n\tthis.prefix = nameParts.length > 1 ? nameParts[0] : null;\r\n\tthis.localName = nameParts[nameParts.length > 1 ? 1 : 0];\r\n});\r\n\r\nNodeTest.PITest = NodeTest.makeNodeTestType(NodeTest.PI, {\r\n\tmatches: function (n, xpc) {\r\n\t\treturn NodeTest.isNodeType([7])(n) && (n.target || n.nodeName) === this.name;\r\n\t},\r\n\ttoString: function () {\r\n        return wrap('processing-instruction(\"', '\")', this.name);\r\n\t}\r\n}, function (name) { this.name = name; })\r\n\r\n// singletons\r\n\r\n// elements, attributes, namespaces\r\nNodeTest.nameTestAny = NodeTest.makeNodeTypeTest(NodeTest.NAMETESTANY, [1, 2, XPathNamespace.XPATH_NAMESPACE_NODE], '*');\r\n// text, cdata\r\nNodeTest.textTest = NodeTest.makeNodeTypeTest(NodeTest.TEXT, [3, 4], 'text()');\r\nNodeTest.commentTest = NodeTest.makeNodeTypeTest(NodeTest.COMMENT, [8], 'comment()');\r\n// elements, attributes, text, cdata, PIs, comments, document nodes\r\nNodeTest.nodeTest = NodeTest.makeNodeTypeTest(NodeTest.NODE, [1, 2, 3, 4, 7, 8, 9], 'node()');\r\nNodeTest.anyPiTest = NodeTest.makeNodeTypeTest(NodeTest.PI, [7], 'processing-instruction()');\r\n\r\n// VariableReference /////////////////////////////////////////////////////////\r\n\r\nVariableReference.prototype = new Expression();\r\nVariableReference.prototype.constructor = VariableReference;\r\nVariableReference.superclass = Expression.prototype;\r\n\r\nfunction VariableReference(v) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(v);\r\n\t}\r\n}\r\n\r\nVariableReference.prototype.init = function(v) {\r\n\tthis.variable = v;\r\n};\r\n\r\nVariableReference.prototype.toString = function() {\r\n\treturn \"$\" + this.variable;\r\n};\r\n\r\nVariableReference.prototype.evaluate = function(c) {\r\n    var parts = Utilities.resolveQName(this.variable, c.namespaceResolver, c.contextNode, false);\r\n\r\n    if (parts[0] == null) {\r\n        throw new Error(\"Cannot resolve QName \" + fn);\r\n    }\r\n\tvar result = c.variableResolver.getVariable(parts[1], parts[0]);\r\n    if (!result) {\r\n        throw XPathException.fromMessage(\"Undeclared variable: \" + this.toString());\r\n    }\r\n    return result;\r\n};\r\n\r\n// FunctionCall //////////////////////////////////////////////////////////////\r\n\r\nFunctionCall.prototype = new Expression();\r\nFunctionCall.prototype.constructor = FunctionCall;\r\nFunctionCall.superclass = Expression.prototype;\r\n\r\nfunction FunctionCall(fn, args) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(fn, args);\r\n\t}\r\n}\r\n\r\nFunctionCall.prototype.init = function(fn, args) {\r\n\tthis.functionName = fn;\r\n\tthis.arguments = args;\r\n};\r\n\r\nFunctionCall.prototype.toString = function() {\r\n\tvar s = this.functionName + \"(\";\r\n\tfor (var i = 0; i < this.arguments.length; i++) {\r\n\t\tif (i > 0) {\r\n\t\t\ts += \", \";\r\n\t\t}\r\n\t\ts += this.arguments[i].toString();\r\n\t}\r\n\treturn s + \")\";\r\n};\r\n\r\nFunctionCall.prototype.evaluate = function(c) {\r\n    var f = FunctionResolver.getFunctionFromContext(this.functionName, c);\r\n\r\n    if (!f) {\r\n\t\tthrow new Error(\"Unknown function \" + this.functionName);\r\n\t}\r\n\r\n    var a = [c].concat(this.arguments);\r\n\treturn f.apply(c.functionResolver.thisArg, a);\r\n};\r\n\r\n// Operators /////////////////////////////////////////////////////////////////\r\n\r\nvar Operators = new Object();\r\n\r\nOperators.equals = function(l, r) {\r\n\treturn l.equals(r);\r\n};\r\n\r\nOperators.notequal = function(l, r) {\r\n\treturn l.notequal(r);\r\n};\r\n\r\nOperators.lessthan = function(l, r) {\r\n\treturn l.lessthan(r);\r\n};\r\n\r\nOperators.greaterthan = function(l, r) {\r\n\treturn l.greaterthan(r);\r\n};\r\n\r\nOperators.lessthanorequal = function(l, r) {\r\n\treturn l.lessthanorequal(r);\r\n};\r\n\r\nOperators.greaterthanorequal = function(l, r) {\r\n\treturn l.greaterthanorequal(r);\r\n};\r\n\r\n// XString ///////////////////////////////////////////////////////////////////\r\n\r\nXString.prototype = new Expression();\r\nXString.prototype.constructor = XString;\r\nXString.superclass = Expression.prototype;\r\n\r\nfunction XString(s) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(s);\r\n\t}\r\n}\r\n\r\nXString.prototype.init = function(s) {\r\n\tthis.str = String(s);\r\n};\r\n\r\nXString.prototype.toString = function() {\r\n\treturn this.str;\r\n};\r\n\r\nXString.prototype.evaluate = function(c) {\r\n\treturn this;\r\n};\r\n\r\nXString.prototype.string = function() {\r\n\treturn this;\r\n};\r\n\r\nXString.prototype.number = function() {\r\n\treturn new XNumber(this.str);\r\n};\r\n\r\nXString.prototype.bool = function() {\r\n\treturn new XBoolean(this.str);\r\n};\r\n\r\nXString.prototype.nodeset = function() {\r\n\tthrow new Error(\"Cannot convert string to nodeset\");\r\n};\r\n\r\nXString.prototype.stringValue = function() {\r\n\treturn this.str;\r\n};\r\n\r\nXString.prototype.numberValue = function() {\r\n\treturn this.number().numberValue();\r\n};\r\n\r\nXString.prototype.booleanValue = function() {\r\n\treturn this.bool().booleanValue();\r\n};\r\n\r\nXString.prototype.equals = function(r) {\r\n\tif (Utilities.instance_of(r, XBoolean)) {\r\n\t\treturn this.bool().equals(r);\r\n\t}\r\n\tif (Utilities.instance_of(r, XNumber)) {\r\n\t\treturn this.number().equals(r);\r\n\t}\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithString(this, Operators.equals);\r\n\t}\r\n\treturn new XBoolean(this.str == r.str);\r\n};\r\n\r\nXString.prototype.notequal = function(r) {\r\n\tif (Utilities.instance_of(r, XBoolean)) {\r\n\t\treturn this.bool().notequal(r);\r\n\t}\r\n\tif (Utilities.instance_of(r, XNumber)) {\r\n\t\treturn this.number().notequal(r);\r\n\t}\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithString(this, Operators.notequal);\r\n\t}\r\n\treturn new XBoolean(this.str != r.str);\r\n};\r\n\r\nXString.prototype.lessthan = function(r) {\r\n\treturn this.number().lessthan(r);\r\n};\r\n\r\nXString.prototype.greaterthan = function(r) {\r\n\treturn this.number().greaterthan(r);\r\n};\r\n\r\nXString.prototype.lessthanorequal = function(r) {\r\n\treturn this.number().lessthanorequal(r);\r\n};\r\n\r\nXString.prototype.greaterthanorequal = function(r) {\r\n\treturn this.number().greaterthanorequal(r);\r\n};\r\n\r\n// XNumber ///////////////////////////////////////////////////////////////////\r\n\r\nXNumber.prototype = new Expression();\r\nXNumber.prototype.constructor = XNumber;\r\nXNumber.superclass = Expression.prototype;\r\n\r\nfunction XNumber(n) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(n);\r\n\t}\r\n}\r\n\r\nXNumber.prototype.init = function(n) {\r\n\tthis.num = typeof n === \"string\" ? this.parse(n) : Number(n);\r\n};\r\n\r\nXNumber.prototype.numberFormat = /^\\s*-?[0-9]*\\.?[0-9]+\\s*$/;\r\n\r\nXNumber.prototype.parse = function(s) {\r\n    // XPath representation of numbers is more restrictive than what Number() or parseFloat() allow\r\n    return this.numberFormat.test(s) ? parseFloat(s) : Number.NaN;\r\n};\r\n\r\nfunction padSmallNumber(numberStr) {\r\n\tvar parts = numberStr.split('e-');\r\n\tvar base = parts[0].replace('.', '');\r\n\tvar exponent = Number(parts[1]);\r\n\t\r\n\tfor (var i = 0; i < exponent - 1; i += 1) {\r\n\t\tbase = '0' + base;\r\n\t}\r\n\t\r\n\treturn '0.' + base;\r\n}\r\n\r\nfunction padLargeNumber(numberStr) {\r\n\tvar parts = numberStr.split('e');\r\n\tvar base = parts[0].replace('.', '');\r\n\tvar exponent = Number(parts[1]);\r\n\tvar zerosToAppend = exponent + 1 - base.length;\r\n\t\r\n\tfor (var i = 0; i < zerosToAppend; i += 1){\r\n\t\tbase += '0';\r\n\t}\r\n\t\r\n\treturn base;\r\n}\r\n\r\nXNumber.prototype.toString = function() {\r\n\tvar strValue = this.num.toString();\r\n\r\n\tif (strValue.indexOf('e-') !== -1) {\r\n\t\treturn padSmallNumber(strValue);\r\n\t}\r\n    \r\n\tif (strValue.indexOf('e') !== -1) {\r\n\t\treturn padLargeNumber(strValue);\r\n\t}\r\n\t\r\n\treturn strValue;\r\n};\r\n\r\nXNumber.prototype.evaluate = function(c) {\r\n\treturn this;\r\n};\r\n\r\nXNumber.prototype.string = function() {\r\n\t\r\n\t\r\n\treturn new XString(this.toString());\r\n};\r\n\r\nXNumber.prototype.number = function() {\r\n\treturn this;\r\n};\r\n\r\nXNumber.prototype.bool = function() {\r\n\treturn new XBoolean(this.num);\r\n};\r\n\r\nXNumber.prototype.nodeset = function() {\r\n\tthrow new Error(\"Cannot convert number to nodeset\");\r\n};\r\n\r\nXNumber.prototype.stringValue = function() {\r\n\treturn this.string().stringValue();\r\n};\r\n\r\nXNumber.prototype.numberValue = function() {\r\n\treturn this.num;\r\n};\r\n\r\nXNumber.prototype.booleanValue = function() {\r\n\treturn this.bool().booleanValue();\r\n};\r\n\r\nXNumber.prototype.negate = function() {\r\n\treturn new XNumber(-this.num);\r\n};\r\n\r\nXNumber.prototype.equals = function(r) {\r\n\tif (Utilities.instance_of(r, XBoolean)) {\r\n\t\treturn this.bool().equals(r);\r\n\t}\r\n\tif (Utilities.instance_of(r, XString)) {\r\n\t\treturn this.equals(r.number());\r\n\t}\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this, Operators.equals);\r\n\t}\r\n\treturn new XBoolean(this.num == r.num);\r\n};\r\n\r\nXNumber.prototype.notequal = function(r) {\r\n\tif (Utilities.instance_of(r, XBoolean)) {\r\n\t\treturn this.bool().notequal(r);\r\n\t}\r\n\tif (Utilities.instance_of(r, XString)) {\r\n\t\treturn this.notequal(r.number());\r\n\t}\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this, Operators.notequal);\r\n\t}\r\n\treturn new XBoolean(this.num != r.num);\r\n};\r\n\r\nXNumber.prototype.lessthan = function(r) {\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this, Operators.greaterthan);\r\n\t}\r\n\tif (Utilities.instance_of(r, XBoolean) || Utilities.instance_of(r, XString)) {\r\n\t\treturn this.lessthan(r.number());\r\n\t}\r\n\treturn new XBoolean(this.num < r.num);\r\n};\r\n\r\nXNumber.prototype.greaterthan = function(r) {\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this, Operators.lessthan);\r\n\t}\r\n\tif (Utilities.instance_of(r, XBoolean) || Utilities.instance_of(r, XString)) {\r\n\t\treturn this.greaterthan(r.number());\r\n\t}\r\n\treturn new XBoolean(this.num > r.num);\r\n};\r\n\r\nXNumber.prototype.lessthanorequal = function(r) {\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this, Operators.greaterthanorequal);\r\n\t}\r\n\tif (Utilities.instance_of(r, XBoolean) || Utilities.instance_of(r, XString)) {\r\n\t\treturn this.lessthanorequal(r.number());\r\n\t}\r\n\treturn new XBoolean(this.num <= r.num);\r\n};\r\n\r\nXNumber.prototype.greaterthanorequal = function(r) {\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithNumber(this, Operators.lessthanorequal);\r\n\t}\r\n\tif (Utilities.instance_of(r, XBoolean) || Utilities.instance_of(r, XString)) {\r\n\t\treturn this.greaterthanorequal(r.number());\r\n\t}\r\n\treturn new XBoolean(this.num >= r.num);\r\n};\r\n\r\nXNumber.prototype.plus = function(r) {\r\n\treturn new XNumber(this.num + r.num);\r\n};\r\n\r\nXNumber.prototype.minus = function(r) {\r\n\treturn new XNumber(this.num - r.num);\r\n};\r\n\r\nXNumber.prototype.multiply = function(r) {\r\n\treturn new XNumber(this.num * r.num);\r\n};\r\n\r\nXNumber.prototype.div = function(r) {\r\n\treturn new XNumber(this.num / r.num);\r\n};\r\n\r\nXNumber.prototype.mod = function(r) {\r\n\treturn new XNumber(this.num % r.num);\r\n};\r\n\r\n// XBoolean //////////////////////////////////////////////////////////////////\r\n\r\nXBoolean.prototype = new Expression();\r\nXBoolean.prototype.constructor = XBoolean;\r\nXBoolean.superclass = Expression.prototype;\r\n\r\nfunction XBoolean(b) {\r\n\tif (arguments.length > 0) {\r\n\t\tthis.init(b);\r\n\t}\r\n}\r\n\r\nXBoolean.prototype.init = function(b) {\r\n\tthis.b = Boolean(b);\r\n};\r\n\r\nXBoolean.prototype.toString = function() {\r\n\treturn this.b.toString();\r\n};\r\n\r\nXBoolean.prototype.evaluate = function(c) {\r\n\treturn this;\r\n};\r\n\r\nXBoolean.prototype.string = function() {\r\n\treturn new XString(this.b);\r\n};\r\n\r\nXBoolean.prototype.number = function() {\r\n\treturn new XNumber(this.b);\r\n};\r\n\r\nXBoolean.prototype.bool = function() {\r\n\treturn this;\r\n};\r\n\r\nXBoolean.prototype.nodeset = function() {\r\n\tthrow new Error(\"Cannot convert boolean to nodeset\");\r\n};\r\n\r\nXBoolean.prototype.stringValue = function() {\r\n\treturn this.string().stringValue();\r\n};\r\n\r\nXBoolean.prototype.numberValue = function() {\r\n\treturn this.number().numberValue();\r\n};\r\n\r\nXBoolean.prototype.booleanValue = function() {\r\n\treturn this.b;\r\n};\r\n\r\nXBoolean.prototype.not = function() {\r\n\treturn new XBoolean(!this.b);\r\n};\r\n\r\nXBoolean.prototype.equals = function(r) {\r\n\tif (Utilities.instance_of(r, XString) || Utilities.instance_of(r, XNumber)) {\r\n\t\treturn this.equals(r.bool());\r\n\t}\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithBoolean(this, Operators.equals);\r\n\t}\r\n\treturn new XBoolean(this.b == r.b);\r\n};\r\n\r\nXBoolean.prototype.notequal = function(r) {\r\n\tif (Utilities.instance_of(r, XString) || Utilities.instance_of(r, XNumber)) {\r\n\t\treturn this.notequal(r.bool());\r\n\t}\r\n\tif (Utilities.instance_of(r, XNodeSet)) {\r\n\t\treturn r.compareWithBoolean(this, Operators.notequal);\r\n\t}\r\n\treturn new XBoolean(this.b != r.b);\r\n};\r\n\r\nXBoolean.prototype.lessthan = function(r) {\r\n\treturn this.number().lessthan(r);\r\n};\r\n\r\nXBoolean.prototype.greaterthan = function(r) {\r\n\treturn this.number().greaterthan(r);\r\n};\r\n\r\nXBoolean.prototype.lessthanorequal = function(r) {\r\n\treturn this.number().lessthanorequal(r);\r\n};\r\n\r\nXBoolean.prototype.greaterthanorequal = function(r) {\r\n\treturn this.number().greaterthanorequal(r);\r\n};\r\n\r\nXBoolean.true_ = new XBoolean(true);\r\nXBoolean.false_ = new XBoolean(false);\r\n\r\n// AVLTree ///////////////////////////////////////////////////////////////////\r\n\r\nAVLTree.prototype = new Object();\r\nAVLTree.prototype.constructor = AVLTree;\r\nAVLTree.superclass = Object.prototype;\r\n\r\nfunction AVLTree(n) {\r\n\tthis.init(n);\r\n}\r\n\r\nAVLTree.prototype.init = function(n) {\r\n\tthis.left = null;\r\n    this.right = null;\r\n\tthis.node = n;\r\n\tthis.depth = 1;\r\n};\r\n\r\nAVLTree.prototype.balance = function() {\r\n    var ldepth = this.left  == null ? 0 : this.left.depth;\r\n    var rdepth = this.right == null ? 0 : this.right.depth;\r\n\r\n\tif (ldepth > rdepth + 1) {\r\n        // LR or LL rotation\r\n        var lldepth = this.left.left  == null ? 0 : this.left.left.depth;\r\n        var lrdepth = this.left.right == null ? 0 : this.left.right.depth;\r\n\r\n        if (lldepth < lrdepth) {\r\n            // LR rotation consists of a RR rotation of the left child\r\n            this.left.rotateRR();\r\n            // plus a LL rotation of this node, which happens anyway\r\n        }\r\n        this.rotateLL();\r\n    } else if (ldepth + 1 < rdepth) {\r\n        // RR or RL rorarion\r\n\t\tvar rrdepth = this.right.right == null ? 0 : this.right.right.depth;\r\n\t\tvar rldepth = this.right.left  == null ? 0 : this.right.left.depth;\r\n\r\n        if (rldepth > rrdepth) {\r\n            // RR rotation consists of a LL rotation of the right child\r\n            this.right.rotateLL();\r\n            // plus a RR rotation of this node, which happens anyway\r\n        }\r\n        this.rotateRR();\r\n    }\r\n};\r\n\r\nAVLTree.prototype.rotateLL = function() {\r\n    // the left side is too long => rotate from the left (_not_ leftwards)\r\n    var nodeBefore = this.node;\r\n    var rightBefore = this.right;\r\n    this.node = this.left.node;\r\n    this.right = this.left;\r\n    this.left = this.left.left;\r\n    this.right.left = this.right.right;\r\n    this.right.right = rightBefore;\r\n    this.right.node = nodeBefore;\r\n    this.right.updateInNewLocation();\r\n    this.updateInNewLocation();\r\n};\r\n\r\nAVLTree.prototype.rotateRR = function() {\r\n    // the right side is too long => rotate from the right (_not_ rightwards)\r\n    var nodeBefore = this.node;\r\n    var leftBefore = this.left;\r\n    this.node = this.right.node;\r\n    this.left = this.right;\r\n    this.right = this.right.right;\r\n    this.left.right = this.left.left;\r\n    this.left.left = leftBefore;\r\n    this.left.node = nodeBefore;\r\n    this.left.updateInNewLocation();\r\n    this.updateInNewLocation();\r\n};\r\n\r\nAVLTree.prototype.updateInNewLocation = function() {\r\n    this.getDepthFromChildren();\r\n};\r\n\r\nAVLTree.prototype.getDepthFromChildren = function() {\r\n    this.depth = this.node == null ? 0 : 1;\r\n    if (this.left != null) {\r\n        this.depth = this.left.depth + 1;\r\n    }\r\n    if (this.right != null && this.depth <= this.right.depth) {\r\n        this.depth = this.right.depth + 1;\r\n    }\r\n};\r\n\r\nfunction nodeOrder(n1, n2) {\r\n\tif (n1 === n2) {\r\n\t\treturn 0;\r\n\t}\r\n\r\n\tif (n1.compareDocumentPosition) {\r\n\t    var cpos = n1.compareDocumentPosition(n2);\r\n\r\n        if (cpos & 0x01) {\r\n            // not in the same document; return an arbitrary result (is there a better way to do this)\r\n            return 1;\r\n        }\r\n        if (cpos & 0x0A) {\r\n            // n2 precedes or contains n1\r\n            return 1;\r\n        }\r\n        if (cpos & 0x14) {\r\n            // n2 follows or is contained by n1\r\n            return -1;\r\n        }\r\n\r\n\t    return 0;\r\n\t}\r\n\r\n\tvar d1 = 0,\r\n\t    d2 = 0;\r\n\tfor (var m1 = n1; m1 != null; m1 = m1.parentNode || m1.ownerElement) {\r\n\t\td1++;\r\n\t}\r\n\tfor (var m2 = n2; m2 != null; m2 = m2.parentNode || m2.ownerElement) {\r\n\t\td2++;\r\n\t}\r\n\r\n    // step up to same depth\r\n\tif (d1 > d2) {\r\n\t\twhile (d1 > d2) {\r\n\t\t\tn1 = n1.parentNode || n1.ownerElement;\r\n\t\t\td1--;\r\n\t\t}\r\n\t\tif (n1 === n2) {\r\n\t\t\treturn 1;\r\n\t\t}\r\n\t} else if (d2 > d1) {\r\n\t\twhile (d2 > d1) {\r\n\t\t\tn2 = n2.parentNode || n2.ownerElement;\r\n\t\t\td2--;\r\n\t\t}\r\n\t\tif (n1 === n2) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t}\r\n\r\n    var n1Par = n1.parentNode || n1.ownerElement,\r\n        n2Par = n2.parentNode || n2.ownerElement;\r\n\r\n    // find common parent\r\n\twhile (n1Par !== n2Par) {\r\n\t\tn1 = n1Par;\r\n\t\tn2 = n2Par;\r\n\t\tn1Par = n1.parentNode || n1.ownerElement;\r\n\t    n2Par = n2.parentNode || n2.ownerElement;\r\n\t}\r\n    \r\n    var n1isAttr = Utilities.isAttribute(n1);\r\n    var n2isAttr = Utilities.isAttribute(n2);\r\n    \r\n    if (n1isAttr && !n2isAttr) {\r\n        return -1;\r\n    }\r\n    if (!n1isAttr && n2isAttr) {\r\n        return 1;\r\n    }\r\n    \r\n    if(n1Par) {\r\n\t    var cn = n1isAttr ? n1Par.attributes : n1Par.childNodes,\r\n\t        len = cn.length;\r\n        for (var i = 0; i < len; i += 1) {\r\n            var n = cn[i];\r\n            if (n === n1) {\r\n                return -1;\r\n            }\r\n            if (n === n2) {\r\n                return 1;\r\n            }\r\n        }\r\n    }        \r\n    \r\n    throw new Error('Unexpected: could not determine node order');\r\n}\r\n\r\nAVLTree.prototype.add = function(n)  {\r\n\tif (n === this.node) {\r\n        return false;\r\n    }\r\n\r\n\tvar o = nodeOrder(n, this.node);\r\n\r\n    var ret = false;\r\n    if (o == -1) {\r\n        if (this.left == null) {\r\n            this.left = new AVLTree(n);\r\n            ret = true;\r\n        } else {\r\n            ret = this.left.add(n);\r\n            if (ret) {\r\n                this.balance();\r\n            }\r\n        }\r\n    } else if (o == 1) {\r\n        if (this.right == null) {\r\n            this.right = new AVLTree(n);\r\n            ret = true;\r\n        } else {\r\n            ret = this.right.add(n);\r\n            if (ret) {\r\n                this.balance();\r\n            }\r\n        }\r\n    }\r\n\r\n    if (ret) {\r\n        this.getDepthFromChildren();\r\n    }\r\n    return ret;\r\n};\r\n\r\n// XNodeSet //////////////////////////////////////////////////////////////////\r\n\r\nXNodeSet.prototype = new Expression();\r\nXNodeSet.prototype.constructor = XNodeSet;\r\nXNodeSet.superclass = Expression.prototype;\r\n\r\nfunction XNodeSet() {\r\n\tthis.init();\r\n}\r\n\r\nXNodeSet.prototype.init = function() {\r\n    this.tree = null;\r\n\tthis.nodes = [];\r\n\tthis.size = 0;\r\n};\r\n\r\nXNodeSet.prototype.toString = function() {\r\n\tvar p = this.first();\r\n\tif (p == null) {\r\n\t\treturn \"\";\r\n\t}\r\n\treturn this.stringForNode(p);\r\n};\r\n\r\nXNodeSet.prototype.evaluate = function(c) {\r\n\treturn this;\r\n};\r\n\r\nXNodeSet.prototype.string = function() {\r\n\treturn new XString(this.toString());\r\n};\r\n\r\nXNodeSet.prototype.stringValue = function() {\r\n\treturn this.toString();\r\n};\r\n\r\nXNodeSet.prototype.number = function() {\r\n\treturn new XNumber(this.string());\r\n};\r\n\r\nXNodeSet.prototype.numberValue = function() {\r\n\treturn Number(this.string());\r\n};\r\n\r\nXNodeSet.prototype.bool = function() {\r\n\treturn new XBoolean(this.booleanValue());\r\n};\r\n\r\nXNodeSet.prototype.booleanValue = function() {\r\n\treturn !!this.size;\r\n};\r\n\r\nXNodeSet.prototype.nodeset = function() {\r\n\treturn this;\r\n};\r\n\r\nXNodeSet.prototype.stringForNode = function(n) {\r\n\tif (n.nodeType == 9   /*Node.DOCUMENT_NODE*/ || \r\n        n.nodeType == 1   /*Node.ELEMENT_NODE */ || \r\n        n.nodeType === 11 /*Node.DOCUMENT_FRAGMENT*/) {\r\n\t\treturn this.stringForContainerNode(n);\r\n\t}\r\n    if (n.nodeType === 2 /* Node.ATTRIBUTE_NODE */) {\r\n        return n.value || n.nodeValue;\r\n    }\r\n\tif (n.isNamespaceNode) {\r\n\t\treturn n.namespace;\r\n\t}\r\n\treturn n.nodeValue;\r\n};\r\n\r\nXNodeSet.prototype.stringForContainerNode = function(n) {\r\n\tvar s = \"\";\r\n\tfor (var n2 = n.firstChild; n2 != null; n2 = n2.nextSibling) {\r\n        var nt = n2.nodeType;\r\n        //  Element,    Text,       CDATA,      Document,   Document Fragment\r\n        if (nt === 1 || nt === 3 || nt === 4 || nt === 9 || nt === 11) {\r\n            s += this.stringForNode(n2);\r\n        }\r\n\t}\r\n\treturn s;\r\n};\r\n\r\nXNodeSet.prototype.buildTree = function () {\r\n    if (!this.tree && this.nodes.length) {\r\n        this.tree = new AVLTree(this.nodes[0]);\r\n        for (var i = 1; i < this.nodes.length; i += 1) {\r\n            this.tree.add(this.nodes[i]);\r\n        }\r\n    }\r\n\r\n    return this.tree;\r\n};\r\n\r\nXNodeSet.prototype.first = function() {\r\n\tvar p = this.buildTree();\r\n\tif (p == null) {\r\n\t\treturn null;\r\n\t}\r\n\twhile (p.left != null) {\r\n\t\tp = p.left;\r\n\t}\r\n\treturn p.node;\r\n};\r\n\r\nXNodeSet.prototype.add = function(n) {\r\n    for (var i = 0; i < this.nodes.length; i += 1) {\r\n        if (n === this.nodes[i]) {\r\n            return;\r\n        }\r\n    }\r\n\r\n    this.tree = null;\r\n    this.nodes.push(n);\r\n    this.size += 1;\r\n};\r\n\r\nXNodeSet.prototype.addArray = function(ns) {\r\n\tvar self = this;\r\n\t\r\n\tforEach(function (x) { self.add(x); }, ns);\r\n};\r\n\r\n/**\r\n * Returns an array of the node set's contents in document order\r\n */\r\nXNodeSet.prototype.toArray = function() {\r\n\tvar a = [];\r\n\tthis.toArrayRec(this.buildTree(), a);\r\n\treturn a;\r\n};\r\n\r\nXNodeSet.prototype.toArrayRec = function(t, a) {\r\n\tif (t != null) {\r\n\t\tthis.toArrayRec(t.left, a);\r\n\t\ta.push(t.node);\r\n\t\tthis.toArrayRec(t.right, a);\r\n\t}\r\n};\r\n\r\n/**\r\n * Returns an array of the node set's contents in arbitrary order\r\n */\r\nXNodeSet.prototype.toUnsortedArray = function () {\r\n    return this.nodes.slice();\r\n};\r\n\r\nXNodeSet.prototype.compareWithString = function(r, o) {\r\n\tvar a = this.toUnsortedArray();\r\n\tfor (var i = 0; i < a.length; i++) {\r\n\t\tvar n = a[i];\r\n\t\tvar l = new XString(this.stringForNode(n));\r\n\t\tvar res = o(l, r);\r\n\t\tif (res.booleanValue()) {\r\n\t\t\treturn res;\r\n\t\t}\r\n\t}\r\n\treturn new XBoolean(false);\r\n};\r\n\r\nXNodeSet.prototype.compareWithNumber = function(r, o) {\r\n\tvar a = this.toUnsortedArray();\r\n\tfor (var i = 0; i < a.length; i++) {\r\n\t\tvar n = a[i];\r\n\t\tvar l = new XNumber(this.stringForNode(n));\r\n\t\tvar res = o(l, r);\r\n\t\tif (res.booleanValue()) {\r\n\t\t\treturn res;\r\n\t\t}\r\n\t}\r\n\treturn new XBoolean(false);\r\n};\r\n\r\nXNodeSet.prototype.compareWithBoolean = function(r, o) {\r\n\treturn o(this.bool(), r);\r\n};\r\n\r\nXNodeSet.prototype.compareWithNodeSet = function(r, o) {\r\n\tvar arr = this.toUnsortedArray();\r\n\tvar oInvert = function (lop, rop) { return o(rop, lop); };\r\n\t\r\n\tfor (var i = 0; i < arr.length; i++) {\r\n\t\tvar l = new XString(this.stringForNode(arr[i]));\r\n\r\n\t\tvar res = r.compareWithString(l, oInvert);\r\n\t\tif (res.booleanValue()) {\r\n\t\t\treturn res;\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn new XBoolean(false);\r\n};\r\n\r\nXNodeSet.compareWith = curry(function (o, r) {\r\n\tif (Utilities.instance_of(r, XString)) {\r\n\t\treturn this.compareWithString(r, o);\r\n\t}\r\n\tif (Utilities.instance_of(r, XNumber)) {\r\n\t\treturn this.compareWithNumber(r, o);\r\n\t}\r\n\tif (Utilities.instance_of(r, XBoolean)) {\r\n\t\treturn this.compareWithBoolean(r, o);\r\n\t}\r\n\treturn this.compareWithNodeSet(r, o);\r\n});\r\n\r\nXNodeSet.prototype.equals = XNodeSet.compareWith(Operators.equals);\r\nXNodeSet.prototype.notequal = XNodeSet.compareWith(Operators.notequal);\r\nXNodeSet.prototype.lessthan = XNodeSet.compareWith(Operators.lessthan);\r\nXNodeSet.prototype.greaterthan = XNodeSet.compareWith(Operators.greaterthan);\r\nXNodeSet.prototype.lessthanorequal = XNodeSet.compareWith(Operators.lessthanorequal);\r\nXNodeSet.prototype.greaterthanorequal = XNodeSet.compareWith(Operators.greaterthanorequal);\r\n\r\nXNodeSet.prototype.union = function(r) {\r\n\tvar ns = new XNodeSet();\r\n    ns.addArray(this.toUnsortedArray());\r\n\tns.addArray(r.toUnsortedArray());\r\n\treturn ns;\r\n};\r\n\r\n// XPathNamespace ////////////////////////////////////////////////////////////\r\n\r\nXPathNamespace.prototype = new Object();\r\nXPathNamespace.prototype.constructor = XPathNamespace;\r\nXPathNamespace.superclass = Object.prototype;\r\n\r\nfunction XPathNamespace(pre, ns, p) {\r\n\tthis.isXPathNamespace = true;\r\n\tthis.ownerDocument = p.ownerDocument;\r\n\tthis.nodeName = \"#namespace\";\r\n\tthis.prefix = pre;\r\n\tthis.localName = pre;\r\n\tthis.namespaceURI = ns;\r\n\tthis.nodeValue = ns;\r\n\tthis.ownerElement = p;\r\n\tthis.nodeType = XPathNamespace.XPATH_NAMESPACE_NODE;\r\n}\r\n\r\nXPathNamespace.prototype.toString = function() {\r\n\treturn \"{ \\\"\" + this.prefix + \"\\\", \\\"\" + this.namespaceURI + \"\\\" }\";\r\n};\r\n\r\n// XPathContext //////////////////////////////////////////////////////////////\r\n\r\nXPathContext.prototype = new Object();\r\nXPathContext.prototype.constructor = XPathContext;\r\nXPathContext.superclass = Object.prototype;\r\n\r\nfunction XPathContext(vr, nr, fr) {\r\n\tthis.variableResolver = vr != null ? vr : new VariableResolver();\r\n\tthis.namespaceResolver = nr != null ? nr : new NamespaceResolver();\r\n\tthis.functionResolver = fr != null ? fr : new FunctionResolver();\r\n}\r\n\r\nXPathContext.prototype.extend = function (newProps) {\r\n\treturn assign(new XPathContext(), this, newProps);\r\n};\r\n\r\n// VariableResolver //////////////////////////////////////////////////////////\r\n\r\nVariableResolver.prototype = new Object();\r\nVariableResolver.prototype.constructor = VariableResolver;\r\nVariableResolver.superclass = Object.prototype;\r\n\r\nfunction VariableResolver() {\r\n}\r\n\r\nVariableResolver.prototype.getVariable = function(ln, ns) {\r\n\treturn null;\r\n};\r\n\r\n// FunctionResolver //////////////////////////////////////////////////////////\r\n\r\nFunctionResolver.prototype = new Object();\r\nFunctionResolver.prototype.constructor = FunctionResolver;\r\nFunctionResolver.superclass = Object.prototype;\r\n\r\nfunction FunctionResolver(thisArg) {\r\n\tthis.thisArg = thisArg != null ? thisArg : Functions;\r\n\tthis.functions = new Object();\r\n\tthis.addStandardFunctions();\r\n}\r\n\r\nFunctionResolver.prototype.addStandardFunctions = function() {\r\n\tthis.functions[\"{}last\"] = Functions.last;\r\n\tthis.functions[\"{}position\"] = Functions.position;\r\n\tthis.functions[\"{}count\"] = Functions.count;\r\n\tthis.functions[\"{}id\"] = Functions.id;\r\n\tthis.functions[\"{}local-name\"] = Functions.localName;\r\n\tthis.functions[\"{}namespace-uri\"] = Functions.namespaceURI;\r\n\tthis.functions[\"{}name\"] = Functions.name;\r\n\tthis.functions[\"{}string\"] = Functions.string;\r\n\tthis.functions[\"{}concat\"] = Functions.concat;\r\n\tthis.functions[\"{}starts-with\"] = Functions.startsWith;\r\n\tthis.functions[\"{}contains\"] = Functions.contains;\r\n\tthis.functions[\"{}substring-before\"] = Functions.substringBefore;\r\n\tthis.functions[\"{}substring-after\"] = Functions.substringAfter;\r\n\tthis.functions[\"{}substring\"] = Functions.substring;\r\n\tthis.functions[\"{}string-length\"] = Functions.stringLength;\r\n\tthis.functions[\"{}normalize-space\"] = Functions.normalizeSpace;\r\n\tthis.functions[\"{}translate\"] = Functions.translate;\r\n\tthis.functions[\"{}boolean\"] = Functions.boolean_;\r\n\tthis.functions[\"{}not\"] = Functions.not;\r\n\tthis.functions[\"{}true\"] = Functions.true_;\r\n\tthis.functions[\"{}false\"] = Functions.false_;\r\n\tthis.functions[\"{}lang\"] = Functions.lang;\r\n\tthis.functions[\"{}number\"] = Functions.number;\r\n\tthis.functions[\"{}sum\"] = Functions.sum;\r\n\tthis.functions[\"{}floor\"] = Functions.floor;\r\n\tthis.functions[\"{}ceiling\"] = Functions.ceiling;\r\n\tthis.functions[\"{}round\"] = Functions.round;\r\n};\r\n\r\nFunctionResolver.prototype.addFunction = function(ns, ln, f) {\r\n\tthis.functions[\"{\" + ns + \"}\" + ln] = f;\r\n};\r\n\r\nFunctionResolver.getFunctionFromContext = function(qName, context) {\r\n    var parts = Utilities.resolveQName(qName, context.namespaceResolver, context.contextNode, false);\r\n\r\n    if (parts[0] === null) {\r\n        throw new Error(\"Cannot resolve QName \" + name);\r\n    }\r\n\r\n    return context.functionResolver.getFunction(parts[1], parts[0]);\r\n};\r\n\r\nFunctionResolver.prototype.getFunction = function(localName, namespace) {\r\n\treturn this.functions[\"{\" + namespace + \"}\" + localName];\r\n};\r\n\r\n// NamespaceResolver /////////////////////////////////////////////////////////\r\n\r\nNamespaceResolver.prototype = new Object();\r\nNamespaceResolver.prototype.constructor = NamespaceResolver;\r\nNamespaceResolver.superclass = Object.prototype;\r\n\r\nfunction NamespaceResolver() {\r\n}\r\n\r\nNamespaceResolver.prototype.getNamespace = function(prefix, n) {\r\n\tif (prefix == \"xml\") {\r\n\t\treturn XPath.XML_NAMESPACE_URI;\r\n\t} else if (prefix == \"xmlns\") {\r\n\t\treturn XPath.XMLNS_NAMESPACE_URI;\r\n\t}\r\n\tif (n.nodeType == 9 /*Node.DOCUMENT_NODE*/) {\r\n\t\tn = n.documentElement;\r\n\t} else if (n.nodeType == 2 /*Node.ATTRIBUTE_NODE*/) {\r\n\t\tn = PathExpr.getOwnerElement(n);\r\n\t} else if (n.nodeType != 1 /*Node.ELEMENT_NODE*/) {\r\n\t\tn = n.parentNode;\r\n\t}\r\n\twhile (n != null && n.nodeType == 1 /*Node.ELEMENT_NODE*/) {\r\n\t\tvar nnm = n.attributes;\r\n\t\tfor (var i = 0; i < nnm.length; i++) {\r\n\t\t\tvar a = nnm.item(i);\r\n\t\t\tvar aname = a.name || a.nodeName;\r\n\t\t\tif ((aname === \"xmlns\" && prefix === \"\")\r\n\t\t\t\t\t|| aname === \"xmlns:\" + prefix) {\r\n\t\t\t\treturn String(a.value || a.nodeValue);\r\n\t\t\t}\r\n\t\t}\r\n\t\tn = n.parentNode;\r\n\t}\r\n\treturn null;\r\n};\r\n\r\n// Functions /////////////////////////////////////////////////////////////////\r\n\r\nvar Functions = new Object();\r\n\r\nFunctions.last = function(c) {\r\n\tif (arguments.length != 1) {\r\n\t\tthrow new Error(\"Function last expects ()\");\r\n\t}\r\n\r\n\treturn new XNumber(c.contextSize);\r\n};\r\n\r\nFunctions.position = function(c) {\r\n\tif (arguments.length != 1) {\r\n\t\tthrow new Error(\"Function position expects ()\");\r\n\t}\r\n\r\n\treturn new XNumber(c.contextPosition);\r\n};\r\n\r\nFunctions.count = function() {\r\n\tvar c = arguments[0];\r\n\tvar ns;\r\n\tif (arguments.length != 2 || !Utilities.instance_of(ns = arguments[1].evaluate(c), XNodeSet)) {\r\n\t\tthrow new Error(\"Function count expects (node-set)\");\r\n\t}\r\n\treturn new XNumber(ns.size);\r\n};\r\n\r\nFunctions.id = function() {\r\n\tvar c = arguments[0];\r\n\tvar id;\r\n\tif (arguments.length != 2) {\r\n\t\tthrow new Error(\"Function id expects (object)\");\r\n\t}\r\n\tid = arguments[1].evaluate(c);\r\n\tif (Utilities.instance_of(id, XNodeSet)) {\r\n\t\tid = id.toArray().join(\" \");\r\n\t} else {\r\n\t\tid = id.stringValue();\r\n\t}\r\n\tvar ids = id.split(/[\\x0d\\x0a\\x09\\x20]+/);\r\n\tvar count = 0;\r\n\tvar ns = new XNodeSet();\r\n\tvar doc = c.contextNode.nodeType == 9 /*Node.DOCUMENT_NODE*/\r\n\t\t\t? c.contextNode\r\n\t\t\t: c.contextNode.ownerDocument;\r\n\tfor (var i = 0; i < ids.length; i++) {\r\n\t\tvar n;\r\n\t\tif (doc.getElementById) {\r\n\t\t\tn = doc.getElementById(ids[i]);\r\n\t\t} else {\r\n\t\t\tn = Utilities.getElementById(doc, ids[i]);\r\n\t\t}\r\n\t\tif (n != null) {\r\n\t\t\tns.add(n);\r\n\t\t\tcount++;\r\n\t\t}\r\n\t}\r\n\treturn ns;\r\n};\r\n\r\nFunctions.localName = function(c, eNode) {\r\n\tvar n;\r\n\t\r\n\tif (arguments.length == 1) {\r\n\t\tn = c.contextNode;\r\n\t} else if (arguments.length == 2) {\r\n\t\tn = eNode.evaluate(c).first();\r\n\t} else {\r\n\t\tthrow new Error(\"Function local-name expects (node-set?)\");\r\n\t}\r\n\t\r\n\tif (n == null) {\r\n\t\treturn new XString(\"\");\r\n\t}\r\n\r\n\treturn new XString(n.localName ||     //  standard elements and attributes\r\n\t                   n.baseName  ||     //  IE\r\n\t\t\t\t\t   n.target    ||     //  processing instructions\r\n                       n.nodeName  ||     //  DOM1 elements\r\n\t\t\t\t\t   \"\");               //  fallback\r\n};\r\n\r\nFunctions.namespaceURI = function() {\r\n\tvar c = arguments[0];\r\n\tvar n;\r\n\tif (arguments.length == 1) {\r\n\t\tn = c.contextNode;\r\n\t} else if (arguments.length == 2) {\r\n\t\tn = arguments[1].evaluate(c).first();\r\n\t} else {\r\n\t\tthrow new Error(\"Function namespace-uri expects (node-set?)\");\r\n\t}\r\n\tif (n == null) {\r\n\t\treturn new XString(\"\");\r\n\t}\r\n\treturn new XString(n.namespaceURI);\r\n};\r\n\r\nFunctions.name = function() {\r\n\tvar c = arguments[0];\r\n\tvar n;\r\n\tif (arguments.length == 1) {\r\n\t\tn = c.contextNode;\r\n\t} else if (arguments.length == 2) {\r\n\t\tn = arguments[1].evaluate(c).first();\r\n\t} else {\r\n\t\tthrow new Error(\"Function name expects (node-set?)\");\r\n\t}\r\n\tif (n == null) {\r\n\t\treturn new XString(\"\");\r\n\t}\r\n\tif (n.nodeType == 1 /*Node.ELEMENT_NODE*/) {\r\n\t\treturn new XString(n.nodeName);\r\n\t} else if (n.nodeType == 2 /*Node.ATTRIBUTE_NODE*/) {\r\n\t\treturn new XString(n.name || n.nodeName);\r\n\t} else if (n.nodeType === 7 /*Node.PROCESSING_INSTRUCTION_NODE*/) {\r\n\t    return new XString(n.target || n.nodeName);\r\n\t} else if (n.localName == null) {\r\n\t\treturn new XString(\"\");\r\n\t} else {\r\n\t\treturn new XString(n.localName);\r\n\t}\r\n};\r\n\r\nFunctions.string = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length == 1) {\r\n\t\treturn new XString(XNodeSet.prototype.stringForNode(c.contextNode));\r\n\t} else if (arguments.length == 2) {\r\n\t\treturn arguments[1].evaluate(c).string();\r\n\t}\r\n\tthrow new Error(\"Function string expects (object?)\");\r\n};\r\n\r\nFunctions.concat = function(c) {\r\n\tif (arguments.length < 3) {\r\n\t\tthrow new Error(\"Function concat expects (string, string[, string]*)\");\r\n\t}\r\n\tvar s = \"\";\r\n\tfor (var i = 1; i < arguments.length; i++) {\r\n\t\ts += arguments[i].evaluate(c).stringValue();\r\n\t}\r\n\treturn new XString(s);\r\n};\r\n\r\nFunctions.startsWith = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 3) {\r\n\t\tthrow new Error(\"Function startsWith expects (string, string)\");\r\n\t}\r\n\tvar s1 = arguments[1].evaluate(c).stringValue();\r\n\tvar s2 = arguments[2].evaluate(c).stringValue();\r\n\treturn new XBoolean(s1.substring(0, s2.length) == s2);\r\n};\r\n\r\nFunctions.contains = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 3) {\r\n\t\tthrow new Error(\"Function contains expects (string, string)\");\r\n\t}\r\n\tvar s1 = arguments[1].evaluate(c).stringValue();\r\n\tvar s2 = arguments[2].evaluate(c).stringValue();\r\n\treturn new XBoolean(s1.indexOf(s2) !== -1);\r\n};\r\n\r\nFunctions.substringBefore = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 3) {\r\n\t\tthrow new Error(\"Function substring-before expects (string, string)\");\r\n\t}\r\n\tvar s1 = arguments[1].evaluate(c).stringValue();\r\n\tvar s2 = arguments[2].evaluate(c).stringValue();\r\n\treturn new XString(s1.substring(0, s1.indexOf(s2)));\r\n};\r\n\r\nFunctions.substringAfter = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 3) {\r\n\t\tthrow new Error(\"Function substring-after expects (string, string)\");\r\n\t}\r\n\tvar s1 = arguments[1].evaluate(c).stringValue();\r\n\tvar s2 = arguments[2].evaluate(c).stringValue();\r\n\tif (s2.length == 0) {\r\n\t\treturn new XString(s1);\r\n\t}\r\n\tvar i = s1.indexOf(s2);\r\n\tif (i == -1) {\r\n\t\treturn new XString(\"\");\r\n\t}\r\n\treturn new XString(s1.substring(i + s2.length));\r\n};\r\n\r\nFunctions.substring = function() {\r\n\tvar c = arguments[0];\r\n\tif (!(arguments.length == 3 || arguments.length == 4)) {\r\n\t\tthrow new Error(\"Function substring expects (string, number, number?)\");\r\n\t}\r\n\tvar s = arguments[1].evaluate(c).stringValue();\r\n\tvar n1 = Math.round(arguments[2].evaluate(c).numberValue()) - 1;\r\n\tvar n2 = arguments.length == 4 ? n1 + Math.round(arguments[3].evaluate(c).numberValue()) : undefined;\r\n\treturn new XString(s.substring(n1, n2));\r\n};\r\n\r\nFunctions.stringLength = function() {\r\n\tvar c = arguments[0];\r\n\tvar s;\r\n\tif (arguments.length == 1) {\r\n\t\ts = XNodeSet.prototype.stringForNode(c.contextNode);\r\n\t} else if (arguments.length == 2) {\r\n\t\ts = arguments[1].evaluate(c).stringValue();\r\n\t} else {\r\n\t\tthrow new Error(\"Function string-length expects (string?)\");\r\n\t}\r\n\treturn new XNumber(s.length);\r\n};\r\n\r\nFunctions.normalizeSpace = function() {\r\n\tvar c = arguments[0];\r\n\tvar s;\r\n\tif (arguments.length == 1) {\r\n\t\ts = XNodeSet.prototype.stringForNode(c.contextNode);\r\n\t} else if (arguments.length == 2) {\r\n\t\ts = arguments[1].evaluate(c).stringValue();\r\n\t} else {\r\n\t\tthrow new Error(\"Function normalize-space expects (string?)\");\r\n\t}\r\n\tvar i = 0;\r\n\tvar j = s.length - 1;\r\n\twhile (Utilities.isSpace(s.charCodeAt(j))) {\r\n\t\tj--;\r\n\t}\r\n\tvar t = \"\";\r\n\twhile (i <= j && Utilities.isSpace(s.charCodeAt(i))) {\r\n\t\ti++;\r\n\t}\r\n\twhile (i <= j) {\r\n\t\tif (Utilities.isSpace(s.charCodeAt(i))) {\r\n\t\t\tt += \" \";\r\n\t\t\twhile (i <= j && Utilities.isSpace(s.charCodeAt(i))) {\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tt += s.charAt(i);\r\n\t\t\ti++;\r\n\t\t}\r\n\t}\r\n\treturn new XString(t);\r\n};\r\n\r\nFunctions.translate = function(c, eValue, eFrom, eTo) {\r\n\tif (arguments.length != 4) {\r\n\t\tthrow new Error(\"Function translate expects (string, string, string)\");\r\n\t}\r\n\r\n\tvar value = eValue.evaluate(c).stringValue();\r\n\tvar from = eFrom.evaluate(c).stringValue();\r\n\tvar to = eTo.evaluate(c).stringValue();\r\n\t\r\n\tvar cMap = reduce(function (acc, ch, i) {\r\n\t\tif (!(ch in acc)) {\r\n\t\t\tacc[ch] = i > to.length ? '' : to[i];\r\n\t\t}\r\n\t\treturn acc;\r\n\t}, {}, from);\r\n\r\n    var t = join('', map(function (ch) {\r\n        return ch in cMap ? cMap[ch] : ch;\r\n    }, value));\r\n\r\n\treturn new XString(t);\r\n};\r\n\r\nFunctions.boolean_ = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 2) {\r\n\t\tthrow new Error(\"Function boolean expects (object)\");\r\n\t}\r\n\treturn arguments[1].evaluate(c).bool();\r\n};\r\n\r\nFunctions.not = function(c, eValue) {\r\n\tif (arguments.length != 2) {\r\n\t\tthrow new Error(\"Function not expects (object)\");\r\n\t}\r\n\treturn eValue.evaluate(c).bool().not();\r\n};\r\n\r\nFunctions.true_ = function() {\r\n\tif (arguments.length != 1) {\r\n\t\tthrow new Error(\"Function true expects ()\");\r\n\t}\r\n\treturn XBoolean.true_;\r\n};\r\n\r\nFunctions.false_ = function() {\r\n\tif (arguments.length != 1) {\r\n\t\tthrow new Error(\"Function false expects ()\");\r\n\t}\r\n\treturn XBoolean.false_;\r\n};\r\n\r\nFunctions.lang = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 2) {\r\n\t\tthrow new Error(\"Function lang expects (string)\");\r\n\t}\r\n\tvar lang;\r\n\tfor (var n = c.contextNode; n != null && n.nodeType != 9 /*Node.DOCUMENT_NODE*/; n = n.parentNode) {\r\n\t\tvar a = n.getAttributeNS(XPath.XML_NAMESPACE_URI, \"lang\");\r\n\t\tif (a != null) {\r\n\t\t\tlang = String(a);\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\tif (lang == null) {\r\n\t\treturn XBoolean.false_;\r\n\t}\r\n\tvar s = arguments[1].evaluate(c).stringValue();\r\n\treturn new XBoolean(lang.substring(0, s.length) == s\r\n\t\t\t\t&& (lang.length == s.length || lang.charAt(s.length) == '-'));\r\n};\r\n\r\nFunctions.number = function() {\r\n\tvar c = arguments[0];\r\n\tif (!(arguments.length == 1 || arguments.length == 2)) {\r\n\t\tthrow new Error(\"Function number expects (object?)\");\r\n\t}\r\n\tif (arguments.length == 1) {\r\n\t\treturn new XNumber(XNodeSet.prototype.stringForNode(c.contextNode));\r\n\t}\r\n\treturn arguments[1].evaluate(c).number();\r\n};\r\n\r\nFunctions.sum = function() {\r\n\tvar c = arguments[0];\r\n\tvar ns;\r\n\tif (arguments.length != 2 || !Utilities.instance_of((ns = arguments[1].evaluate(c)), XNodeSet)) {\r\n\t\tthrow new Error(\"Function sum expects (node-set)\");\r\n\t}\r\n\tns = ns.toUnsortedArray();\r\n\tvar n = 0;\r\n\tfor (var i = 0; i < ns.length; i++) {\r\n\t\tn += new XNumber(XNodeSet.prototype.stringForNode(ns[i])).numberValue();\r\n\t}\r\n\treturn new XNumber(n);\r\n};\r\n\r\nFunctions.floor = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 2) {\r\n\t\tthrow new Error(\"Function floor expects (number)\");\r\n\t}\r\n\treturn new XNumber(Math.floor(arguments[1].evaluate(c).numberValue()));\r\n};\r\n\r\nFunctions.ceiling = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 2) {\r\n\t\tthrow new Error(\"Function ceiling expects (number)\");\r\n\t}\r\n\treturn new XNumber(Math.ceil(arguments[1].evaluate(c).numberValue()));\r\n};\r\n\r\nFunctions.round = function() {\r\n\tvar c = arguments[0];\r\n\tif (arguments.length != 2) {\r\n\t\tthrow new Error(\"Function round expects (number)\");\r\n\t}\r\n\treturn new XNumber(Math.round(arguments[1].evaluate(c).numberValue()));\r\n};\r\n\r\n// Utilities /////////////////////////////////////////////////////////////////\r\n\r\nvar Utilities = new Object();\r\n\r\nUtilities.isAttribute = function (val) {\r\n    return val && (val.nodeType === 2 || val.ownerElement);\r\n}\r\n\r\nUtilities.splitQName = function(qn) {\r\n\tvar i = qn.indexOf(\":\");\r\n\tif (i == -1) {\r\n\t\treturn [ null, qn ];\r\n\t}\r\n\treturn [ qn.substring(0, i), qn.substring(i + 1) ];\r\n};\r\n\r\nUtilities.resolveQName = function(qn, nr, n, useDefault) {\r\n\tvar parts = Utilities.splitQName(qn);\r\n\tif (parts[0] != null) {\r\n\t\tparts[0] = nr.getNamespace(parts[0], n);\r\n\t} else {\r\n\t\tif (useDefault) {\r\n\t\t\tparts[0] = nr.getNamespace(\"\", n);\r\n\t\t\tif (parts[0] == null) {\r\n\t\t\t\tparts[0] = \"\";\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tparts[0] = \"\";\r\n\t\t}\r\n\t}\r\n\treturn parts;\r\n};\r\n\r\nUtilities.isSpace = function(c) {\r\n\treturn c == 0x9 || c == 0xd || c == 0xa || c == 0x20;\r\n};\r\n\r\nUtilities.isLetter = function(c) {\r\n\treturn c >= 0x0041 && c <= 0x005A ||\r\n\t\tc >= 0x0061 && c <= 0x007A ||\r\n\t\tc >= 0x00C0 && c <= 0x00D6 ||\r\n\t\tc >= 0x00D8 && c <= 0x00F6 ||\r\n\t\tc >= 0x00F8 && c <= 0x00FF ||\r\n\t\tc >= 0x0100 && c <= 0x0131 ||\r\n\t\tc >= 0x0134 && c <= 0x013E ||\r\n\t\tc >= 0x0141 && c <= 0x0148 ||\r\n\t\tc >= 0x014A && c <= 0x017E ||\r\n\t\tc >= 0x0180 && c <= 0x01C3 ||\r\n\t\tc >= 0x01CD && c <= 0x01F0 ||\r\n\t\tc >= 0x01F4 && c <= 0x01F5 ||\r\n\t\tc >= 0x01FA && c <= 0x0217 ||\r\n\t\tc >= 0x0250 && c <= 0x02A8 ||\r\n\t\tc >= 0x02BB && c <= 0x02C1 ||\r\n\t\tc == 0x0386 ||\r\n\t\tc >= 0x0388 && c <= 0x038A ||\r\n\t\tc == 0x038C ||\r\n\t\tc >= 0x038E && c <= 0x03A1 ||\r\n\t\tc >= 0x03A3 && c <= 0x03CE ||\r\n\t\tc >= 0x03D0 && c <= 0x03D6 ||\r\n\t\tc == 0x03DA ||\r\n\t\tc == 0x03DC ||\r\n\t\tc == 0x03DE ||\r\n\t\tc == 0x03E0 ||\r\n\t\tc >= 0x03E2 && c <= 0x03F3 ||\r\n\t\tc >= 0x0401 && c <= 0x040C ||\r\n\t\tc >= 0x040E && c <= 0x044F ||\r\n\t\tc >= 0x0451 && c <= 0x045C ||\r\n\t\tc >= 0x045E && c <= 0x0481 ||\r\n\t\tc >= 0x0490 && c <= 0x04C4 ||\r\n\t\tc >= 0x04C7 && c <= 0x04C8 ||\r\n\t\tc >= 0x04CB && c <= 0x04CC ||\r\n\t\tc >= 0x04D0 && c <= 0x04EB ||\r\n\t\tc >= 0x04EE && c <= 0x04F5 ||\r\n\t\tc >= 0x04F8 && c <= 0x04F9 ||\r\n\t\tc >= 0x0531 && c <= 0x0556 ||\r\n\t\tc == 0x0559 ||\r\n\t\tc >= 0x0561 && c <= 0x0586 ||\r\n\t\tc >= 0x05D0 && c <= 0x05EA ||\r\n\t\tc >= 0x05F0 && c <= 0x05F2 ||\r\n\t\tc >= 0x0621 && c <= 0x063A ||\r\n\t\tc >= 0x0641 && c <= 0x064A ||\r\n\t\tc >= 0x0671 && c <= 0x06B7 ||\r\n\t\tc >= 0x06BA && c <= 0x06BE ||\r\n\t\tc >= 0x06C0 && c <= 0x06CE ||\r\n\t\tc >= 0x06D0 && c <= 0x06D3 ||\r\n\t\tc == 0x06D5 ||\r\n\t\tc >= 0x06E5 && c <= 0x06E6 ||\r\n\t\tc >= 0x0905 && c <= 0x0939 ||\r\n\t\tc == 0x093D ||\r\n\t\tc >= 0x0958 && c <= 0x0961 ||\r\n\t\tc >= 0x0985 && c <= 0x098C ||\r\n\t\tc >= 0x098F && c <= 0x0990 ||\r\n\t\tc >= 0x0993 && c <= 0x09A8 ||\r\n\t\tc >= 0x09AA && c <= 0x09B0 ||\r\n\t\tc == 0x09B2 ||\r\n\t\tc >= 0x09B6 && c <= 0x09B9 ||\r\n\t\tc >= 0x09DC && c <= 0x09DD ||\r\n\t\tc >= 0x09DF && c <= 0x09E1 ||\r\n\t\tc >= 0x09F0 && c <= 0x09F1 ||\r\n\t\tc >= 0x0A05 && c <= 0x0A0A ||\r\n\t\tc >= 0x0A0F && c <= 0x0A10 ||\r\n\t\tc >= 0x0A13 && c <= 0x0A28 ||\r\n\t\tc >= 0x0A2A && c <= 0x0A30 ||\r\n\t\tc >= 0x0A32 && c <= 0x0A33 ||\r\n\t\tc >= 0x0A35 && c <= 0x0A36 ||\r\n\t\tc >= 0x0A38 && c <= 0x0A39 ||\r\n\t\tc >= 0x0A59 && c <= 0x0A5C ||\r\n\t\tc == 0x0A5E ||\r\n\t\tc >= 0x0A72 && c <= 0x0A74 ||\r\n\t\tc >= 0x0A85 && c <= 0x0A8B ||\r\n\t\tc == 0x0A8D ||\r\n\t\tc >= 0x0A8F && c <= 0x0A91 ||\r\n\t\tc >= 0x0A93 && c <= 0x0AA8 ||\r\n\t\tc >= 0x0AAA && c <= 0x0AB0 ||\r\n\t\tc >= 0x0AB2 && c <= 0x0AB3 ||\r\n\t\tc >= 0x0AB5 && c <= 0x0AB9 ||\r\n\t\tc == 0x0ABD ||\r\n\t\tc == 0x0AE0 ||\r\n\t\tc >= 0x0B05 && c <= 0x0B0C ||\r\n\t\tc >= 0x0B0F && c <= 0x0B10 ||\r\n\t\tc >= 0x0B13 && c <= 0x0B28 ||\r\n\t\tc >= 0x0B2A && c <= 0x0B30 ||\r\n\t\tc >= 0x0B32 && c <= 0x0B33 ||\r\n\t\tc >= 0x0B36 && c <= 0x0B39 ||\r\n\t\tc == 0x0B3D ||\r\n\t\tc >= 0x0B5C && c <= 0x0B5D ||\r\n\t\tc >= 0x0B5F && c <= 0x0B61 ||\r\n\t\tc >= 0x0B85 && c <= 0x0B8A ||\r\n\t\tc >= 0x0B8E && c <= 0x0B90 ||\r\n\t\tc >= 0x0B92 && c <= 0x0B95 ||\r\n\t\tc >= 0x0B99 && c <= 0x0B9A ||\r\n\t\tc == 0x0B9C ||\r\n\t\tc >= 0x0B9E && c <= 0x0B9F ||\r\n\t\tc >= 0x0BA3 && c <= 0x0BA4 ||\r\n\t\tc >= 0x0BA8 && c <= 0x0BAA ||\r\n\t\tc >= 0x0BAE && c <= 0x0BB5 ||\r\n\t\tc >= 0x0BB7 && c <= 0x0BB9 ||\r\n\t\tc >= 0x0C05 && c <= 0x0C0C ||\r\n\t\tc >= 0x0C0E && c <= 0x0C10 ||\r\n\t\tc >= 0x0C12 && c <= 0x0C28 ||\r\n\t\tc >= 0x0C2A && c <= 0x0C33 ||\r\n\t\tc >= 0x0C35 && c <= 0x0C39 ||\r\n\t\tc >= 0x0C60 && c <= 0x0C61 ||\r\n\t\tc >= 0x0C85 && c <= 0x0C8C ||\r\n\t\tc >= 0x0C8E && c <= 0x0C90 ||\r\n\t\tc >= 0x0C92 && c <= 0x0CA8 ||\r\n\t\tc >= 0x0CAA && c <= 0x0CB3 ||\r\n\t\tc >= 0x0CB5 && c <= 0x0CB9 ||\r\n\t\tc == 0x0CDE ||\r\n\t\tc >= 0x0CE0 && c <= 0x0CE1 ||\r\n\t\tc >= 0x0D05 && c <= 0x0D0C ||\r\n\t\tc >= 0x0D0E && c <= 0x0D10 ||\r\n\t\tc >= 0x0D12 && c <= 0x0D28 ||\r\n\t\tc >= 0x0D2A && c <= 0x0D39 ||\r\n\t\tc >= 0x0D60 && c <= 0x0D61 ||\r\n\t\tc >= 0x0E01 && c <= 0x0E2E ||\r\n\t\tc == 0x0E30 ||\r\n\t\tc >= 0x0E32 && c <= 0x0E33 ||\r\n\t\tc >= 0x0E40 && c <= 0x0E45 ||\r\n\t\tc >= 0x0E81 && c <= 0x0E82 ||\r\n\t\tc == 0x0E84 ||\r\n\t\tc >= 0x0E87 && c <= 0x0E88 ||\r\n\t\tc == 0x0E8A ||\r\n\t\tc == 0x0E8D ||\r\n\t\tc >= 0x0E94 && c <= 0x0E97 ||\r\n\t\tc >= 0x0E99 && c <= 0x0E9F ||\r\n\t\tc >= 0x0EA1 && c <= 0x0EA3 ||\r\n\t\tc == 0x0EA5 ||\r\n\t\tc == 0x0EA7 ||\r\n\t\tc >= 0x0EAA && c <= 0x0EAB ||\r\n\t\tc >= 0x0EAD && c <= 0x0EAE ||\r\n\t\tc == 0x0EB0 ||\r\n\t\tc >= 0x0EB2 && c <= 0x0EB3 ||\r\n\t\tc == 0x0EBD ||\r\n\t\tc >= 0x0EC0 && c <= 0x0EC4 ||\r\n\t\tc >= 0x0F40 && c <= 0x0F47 ||\r\n\t\tc >= 0x0F49 && c <= 0x0F69 ||\r\n\t\tc >= 0x10A0 && c <= 0x10C5 ||\r\n\t\tc >= 0x10D0 && c <= 0x10F6 ||\r\n\t\tc == 0x1100 ||\r\n\t\tc >= 0x1102 && c <= 0x1103 ||\r\n\t\tc >= 0x1105 && c <= 0x1107 ||\r\n\t\tc == 0x1109 ||\r\n\t\tc >= 0x110B && c <= 0x110C ||\r\n\t\tc >= 0x110E && c <= 0x1112 ||\r\n\t\tc == 0x113C ||\r\n\t\tc == 0x113E ||\r\n\t\tc == 0x1140 ||\r\n\t\tc == 0x114C ||\r\n\t\tc == 0x114E ||\r\n\t\tc == 0x1150 ||\r\n\t\tc >= 0x1154 && c <= 0x1155 ||\r\n\t\tc == 0x1159 ||\r\n\t\tc >= 0x115F && c <= 0x1161 ||\r\n\t\tc == 0x1163 ||\r\n\t\tc == 0x1165 ||\r\n\t\tc == 0x1167 ||\r\n\t\tc == 0x1169 ||\r\n\t\tc >= 0x116D && c <= 0x116E ||\r\n\t\tc >= 0x1172 && c <= 0x1173 ||\r\n\t\tc == 0x1175 ||\r\n\t\tc == 0x119E ||\r\n\t\tc == 0x11A8 ||\r\n\t\tc == 0x11AB ||\r\n\t\tc >= 0x11AE && c <= 0x11AF ||\r\n\t\tc >= 0x11B7 && c <= 0x11B8 ||\r\n\t\tc == 0x11BA ||\r\n\t\tc >= 0x11BC && c <= 0x11C2 ||\r\n\t\tc == 0x11EB ||\r\n\t\tc == 0x11F0 ||\r\n\t\tc == 0x11F9 ||\r\n\t\tc >= 0x1E00 && c <= 0x1E9B ||\r\n\t\tc >= 0x1EA0 && c <= 0x1EF9 ||\r\n\t\tc >= 0x1F00 && c <= 0x1F15 ||\r\n\t\tc >= 0x1F18 && c <= 0x1F1D ||\r\n\t\tc >= 0x1F20 && c <= 0x1F45 ||\r\n\t\tc >= 0x1F48 && c <= 0x1F4D ||\r\n\t\tc >= 0x1F50 && c <= 0x1F57 ||\r\n\t\tc == 0x1F59 ||\r\n\t\tc == 0x1F5B ||\r\n\t\tc == 0x1F5D ||\r\n\t\tc >= 0x1F5F && c <= 0x1F7D ||\r\n\t\tc >= 0x1F80 && c <= 0x1FB4 ||\r\n\t\tc >= 0x1FB6 && c <= 0x1FBC ||\r\n\t\tc == 0x1FBE ||\r\n\t\tc >= 0x1FC2 && c <= 0x1FC4 ||\r\n\t\tc >= 0x1FC6 && c <= 0x1FCC ||\r\n\t\tc >= 0x1FD0 && c <= 0x1FD3 ||\r\n\t\tc >= 0x1FD6 && c <= 0x1FDB ||\r\n\t\tc >= 0x1FE0 && c <= 0x1FEC ||\r\n\t\tc >= 0x1FF2 && c <= 0x1FF4 ||\r\n\t\tc >= 0x1FF6 && c <= 0x1FFC ||\r\n\t\tc == 0x2126 ||\r\n\t\tc >= 0x212A && c <= 0x212B ||\r\n\t\tc == 0x212E ||\r\n\t\tc >= 0x2180 && c <= 0x2182 ||\r\n\t\tc >= 0x3041 && c <= 0x3094 ||\r\n\t\tc >= 0x30A1 && c <= 0x30FA ||\r\n\t\tc >= 0x3105 && c <= 0x312C ||\r\n\t\tc >= 0xAC00 && c <= 0xD7A3 ||\r\n\t\tc >= 0x4E00 && c <= 0x9FA5 ||\r\n\t\tc == 0x3007 ||\r\n\t\tc >= 0x3021 && c <= 0x3029;\r\n};\r\n\r\nUtilities.isNCNameChar = function(c) {\r\n\treturn c >= 0x0030 && c <= 0x0039\r\n\t\t|| c >= 0x0660 && c <= 0x0669\r\n\t\t|| c >= 0x06F0 && c <= 0x06F9\r\n\t\t|| c >= 0x0966 && c <= 0x096F\r\n\t\t|| c >= 0x09E6 && c <= 0x09EF\r\n\t\t|| c >= 0x0A66 && c <= 0x0A6F\r\n\t\t|| c >= 0x0AE6 && c <= 0x0AEF\r\n\t\t|| c >= 0x0B66 && c <= 0x0B6F\r\n\t\t|| c >= 0x0BE7 && c <= 0x0BEF\r\n\t\t|| c >= 0x0C66 && c <= 0x0C6F\r\n\t\t|| c >= 0x0CE6 && c <= 0x0CEF\r\n\t\t|| c >= 0x0D66 && c <= 0x0D6F\r\n\t\t|| c >= 0x0E50 && c <= 0x0E59\r\n\t\t|| c >= 0x0ED0 && c <= 0x0ED9\r\n\t\t|| c >= 0x0F20 && c <= 0x0F29\r\n\t\t|| c == 0x002E\r\n\t\t|| c == 0x002D\r\n\t\t|| c == 0x005F\r\n\t\t|| Utilities.isLetter(c)\r\n\t\t|| c >= 0x0300 && c <= 0x0345\r\n\t\t|| c >= 0x0360 && c <= 0x0361\r\n\t\t|| c >= 0x0483 && c <= 0x0486\r\n\t\t|| c >= 0x0591 && c <= 0x05A1\r\n\t\t|| c >= 0x05A3 && c <= 0x05B9\r\n\t\t|| c >= 0x05BB && c <= 0x05BD\r\n\t\t|| c == 0x05BF\r\n\t\t|| c >= 0x05C1 && c <= 0x05C2\r\n\t\t|| c == 0x05C4\r\n\t\t|| c >= 0x064B && c <= 0x0652\r\n\t\t|| c == 0x0670\r\n\t\t|| c >= 0x06D6 && c <= 0x06DC\r\n\t\t|| c >= 0x06DD && c <= 0x06DF\r\n\t\t|| c >= 0x06E0 && c <= 0x06E4\r\n\t\t|| c >= 0x06E7 && c <= 0x06E8\r\n\t\t|| c >= 0x06EA && c <= 0x06ED\r\n\t\t|| c >= 0x0901 && c <= 0x0903\r\n\t\t|| c == 0x093C\r\n\t\t|| c >= 0x093E && c <= 0x094C\r\n\t\t|| c == 0x094D\r\n\t\t|| c >= 0x0951 && c <= 0x0954\r\n\t\t|| c >= 0x0962 && c <= 0x0963\r\n\t\t|| c >= 0x0981 && c <= 0x0983\r\n\t\t|| c == 0x09BC\r\n\t\t|| c == 0x09BE\r\n\t\t|| c == 0x09BF\r\n\t\t|| c >= 0x09C0 && c <= 0x09C4\r\n\t\t|| c >= 0x09C7 && c <= 0x09C8\r\n\t\t|| c >= 0x09CB && c <= 0x09CD\r\n\t\t|| c == 0x09D7\r\n\t\t|| c >= 0x09E2 && c <= 0x09E3\r\n\t\t|| c == 0x0A02\r\n\t\t|| c == 0x0A3C\r\n\t\t|| c == 0x0A3E\r\n\t\t|| c == 0x0A3F\r\n\t\t|| c >= 0x0A40 && c <= 0x0A42\r\n\t\t|| c >= 0x0A47 && c <= 0x0A48\r\n\t\t|| c >= 0x0A4B && c <= 0x0A4D\r\n\t\t|| c >= 0x0A70 && c <= 0x0A71\r\n\t\t|| c >= 0x0A81 && c <= 0x0A83\r\n\t\t|| c == 0x0ABC\r\n\t\t|| c >= 0x0ABE && c <= 0x0AC5\r\n\t\t|| c >= 0x0AC7 && c <= 0x0AC9\r\n\t\t|| c >= 0x0ACB && c <= 0x0ACD\r\n\t\t|| c >= 0x0B01 && c <= 0x0B03\r\n\t\t|| c == 0x0B3C\r\n\t\t|| c >= 0x0B3E && c <= 0x0B43\r\n\t\t|| c >= 0x0B47 && c <= 0x0B48\r\n\t\t|| c >= 0x0B4B && c <= 0x0B4D\r\n\t\t|| c >= 0x0B56 && c <= 0x0B57\r\n\t\t|| c >= 0x0B82 && c <= 0x0B83\r\n\t\t|| c >= 0x0BBE && c <= 0x0BC2\r\n\t\t|| c >= 0x0BC6 && c <= 0x0BC8\r\n\t\t|| c >= 0x0BCA && c <= 0x0BCD\r\n\t\t|| c == 0x0BD7\r\n\t\t|| c >= 0x0C01 && c <= 0x0C03\r\n\t\t|| c >= 0x0C3E && c <= 0x0C44\r\n\t\t|| c >= 0x0C46 && c <= 0x0C48\r\n\t\t|| c >= 0x0C4A && c <= 0x0C4D\r\n\t\t|| c >= 0x0C55 && c <= 0x0C56\r\n\t\t|| c >= 0x0C82 && c <= 0x0C83\r\n\t\t|| c >= 0x0CBE && c <= 0x0CC4\r\n\t\t|| c >= 0x0CC6 && c <= 0x0CC8\r\n\t\t|| c >= 0x0CCA && c <= 0x0CCD\r\n\t\t|| c >= 0x0CD5 && c <= 0x0CD6\r\n\t\t|| c >= 0x0D02 && c <= 0x0D03\r\n\t\t|| c >= 0x0D3E && c <= 0x0D43\r\n\t\t|| c >= 0x0D46 && c <= 0x0D48\r\n\t\t|| c >= 0x0D4A && c <= 0x0D4D\r\n\t\t|| c == 0x0D57\r\n\t\t|| c == 0x0E31\r\n\t\t|| c >= 0x0E34 && c <= 0x0E3A\r\n\t\t|| c >= 0x0E47 && c <= 0x0E4E\r\n\t\t|| c == 0x0EB1\r\n\t\t|| c >= 0x0EB4 && c <= 0x0EB9\r\n\t\t|| c >= 0x0EBB && c <= 0x0EBC\r\n\t\t|| c >= 0x0EC8 && c <= 0x0ECD\r\n\t\t|| c >= 0x0F18 && c <= 0x0F19\r\n\t\t|| c == 0x0F35\r\n\t\t|| c == 0x0F37\r\n\t\t|| c == 0x0F39\r\n\t\t|| c == 0x0F3E\r\n\t\t|| c == 0x0F3F\r\n\t\t|| c >= 0x0F71 && c <= 0x0F84\r\n\t\t|| c >= 0x0F86 && c <= 0x0F8B\r\n\t\t|| c >= 0x0F90 && c <= 0x0F95\r\n\t\t|| c == 0x0F97\r\n\t\t|| c >= 0x0F99 && c <= 0x0FAD\r\n\t\t|| c >= 0x0FB1 && c <= 0x0FB7\r\n\t\t|| c == 0x0FB9\r\n\t\t|| c >= 0x20D0 && c <= 0x20DC\r\n\t\t|| c == 0x20E1\r\n\t\t|| c >= 0x302A && c <= 0x302F\r\n\t\t|| c == 0x3099\r\n\t\t|| c == 0x309A\r\n\t\t|| c == 0x00B7\r\n\t\t|| c == 0x02D0\r\n\t\t|| c == 0x02D1\r\n\t\t|| c == 0x0387\r\n\t\t|| c == 0x0640\r\n\t\t|| c == 0x0E46\r\n\t\t|| c == 0x0EC6\r\n\t\t|| c == 0x3005\r\n\t\t|| c >= 0x3031 && c <= 0x3035\r\n\t\t|| c >= 0x309D && c <= 0x309E\r\n\t\t|| c >= 0x30FC && c <= 0x30FE;\r\n};\r\n\r\nUtilities.coalesceText = function(n) {\r\n\tfor (var m = n.firstChild; m != null; m = m.nextSibling) {\r\n\t\tif (m.nodeType == 3 /*Node.TEXT_NODE*/ || m.nodeType == 4 /*Node.CDATA_SECTION_NODE*/) {\r\n\t\t\tvar s = m.nodeValue;\r\n\t\t\tvar first = m;\r\n\t\t\tm = m.nextSibling;\r\n\t\t\twhile (m != null && (m.nodeType == 3 /*Node.TEXT_NODE*/ || m.nodeType == 4 /*Node.CDATA_SECTION_NODE*/)) {\r\n\t\t\t\ts += m.nodeValue;\r\n\t\t\t\tvar del = m;\r\n\t\t\t\tm = m.nextSibling;\r\n\t\t\t\tdel.parentNode.removeChild(del);\r\n\t\t\t}\r\n\t\t\tif (first.nodeType == 4 /*Node.CDATA_SECTION_NODE*/) {\r\n\t\t\t\tvar p = first.parentNode;\r\n\t\t\t\tif (first.nextSibling == null) {\r\n\t\t\t\t\tp.removeChild(first);\r\n\t\t\t\t\tp.appendChild(p.ownerDocument.createTextNode(s));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar next = first.nextSibling;\r\n\t\t\t\t\tp.removeChild(first);\r\n\t\t\t\t\tp.insertBefore(p.ownerDocument.createTextNode(s), next);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfirst.nodeValue = s;\r\n\t\t\t}\r\n\t\t\tif (m == null) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t} else if (m.nodeType == 1 /*Node.ELEMENT_NODE*/) {\r\n\t\t\tUtilities.coalesceText(m);\r\n\t\t}\r\n\t}\r\n};\r\n\r\nUtilities.instance_of = function(o, c) {\r\n\twhile (o != null) {\r\n\t\tif (o.constructor === c) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (o === Object) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\to = o.constructor.superclass;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nUtilities.getElementById = function(n, id) {\r\n\t// Note that this does not check the DTD to check for actual\r\n\t// attributes of type ID, so this may be a bit wrong.\r\n\tif (n.nodeType == 1 /*Node.ELEMENT_NODE*/) {\r\n\t\tif (n.getAttribute(\"id\") == id\r\n\t\t\t\t|| n.getAttributeNS(null, \"id\") == id) {\r\n\t\t\treturn n;\r\n\t\t}\r\n\t}\r\n\tfor (var m = n.firstChild; m != null; m = m.nextSibling) {\r\n\t\tvar res = Utilities.getElementById(m, id);\r\n\t\tif (res != null) {\r\n\t\t\treturn res;\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\n// XPathException ////////////////////////////////////////////////////////////\r\n\r\nvar XPathException = (function () {\r\n    function getMessage(code, exception) {\r\n        var msg = exception ? \": \" + exception.toString() : \"\";\r\n        switch (code) {\r\n            case XPathException.INVALID_EXPRESSION_ERR:\r\n                return \"Invalid expression\" + msg;\r\n            case XPathException.TYPE_ERR:\r\n                return \"Type error\" + msg;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    function XPathException(code, error, message) {\r\n        var err = Error.call(this, getMessage(code, error) || message);\r\n\r\n        err.code = code;\r\n        err.exception = error;\r\n\r\n        return err;\r\n    }\r\n\r\n    XPathException.prototype = Object.create(Error.prototype);\r\n    XPathException.prototype.constructor = XPathException;\r\n    XPathException.superclass = Error;\r\n\r\n    XPathException.prototype.toString = function() {\r\n        return this.message;\r\n    };\r\n\r\n    XPathException.fromMessage = function(message, error) {\r\n        return new XPathException(null, error, message);\r\n    };\r\n\r\n    XPathException.INVALID_EXPRESSION_ERR = 51;\r\n    XPathException.TYPE_ERR = 52;\r\n\r\n    return XPathException;\r\n})();\r\n\r\n// XPathExpression ///////////////////////////////////////////////////////////\r\n\r\nXPathExpression.prototype = {};\r\nXPathExpression.prototype.constructor = XPathExpression;\r\nXPathExpression.superclass = Object.prototype;\r\n\r\nfunction XPathExpression(e, r, p) {\r\n\tthis.xpath = p.parse(e);\r\n\tthis.context = new XPathContext();\r\n\tthis.context.namespaceResolver = new XPathNSResolverWrapper(r);\r\n}\r\n\r\nXPathExpression.getOwnerDocument = function (n) {\r\n\treturn n.nodeType === 9 /*Node.DOCUMENT_NODE*/ ? n : n.ownerDocument;\r\n}\r\n\r\nXPathExpression.detectHtmlDom = function (n) {\r\n\tif (!n) { return false; }\r\n\t\r\n\tvar doc = XPathExpression.getOwnerDocument(n);\r\n\t\r\n\ttry {\r\n\t\treturn doc.implementation.hasFeature(\"HTML\", \"2.0\");\r\n\t} catch (e) {\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nXPathExpression.prototype.evaluate = function(n, t, res) {\r\n\tthis.context.expressionContextNode = n;\r\n\t// backward compatibility - no reliable way to detect whether the DOM is HTML, but\r\n\t// this library has been using this method up until now, so we will continue to use it\r\n\t// ONLY when using an XPathExpression\r\n\tthis.context.caseInsensitive = XPathExpression.detectHtmlDom(n);\r\n\t\r\n\tvar result = this.xpath.evaluate(this.context);\r\n\treturn new XPathResult(result, t);\r\n}\r\n\r\n// XPathNSResolverWrapper ////////////////////////////////////////////////////\r\n\r\nXPathNSResolverWrapper.prototype = {};\r\nXPathNSResolverWrapper.prototype.constructor = XPathNSResolverWrapper;\r\nXPathNSResolverWrapper.superclass = Object.prototype;\r\n\r\nfunction XPathNSResolverWrapper(r) {\r\n\tthis.xpathNSResolver = r;\r\n}\r\n\r\nXPathNSResolverWrapper.prototype.getNamespace = function(prefix, n) {\r\n    if (this.xpathNSResolver == null) {\r\n        return null;\r\n    }\r\n\treturn this.xpathNSResolver.lookupNamespaceURI(prefix);\r\n};\r\n\r\n// NodeXPathNSResolver ///////////////////////////////////////////////////////\r\n\r\nNodeXPathNSResolver.prototype = {};\r\nNodeXPathNSResolver.prototype.constructor = NodeXPathNSResolver;\r\nNodeXPathNSResolver.superclass = Object.prototype;\r\n\r\nfunction NodeXPathNSResolver(n) {\r\n\tthis.node = n;\r\n\tthis.namespaceResolver = new NamespaceResolver();\r\n}\r\n\r\nNodeXPathNSResolver.prototype.lookupNamespaceURI = function(prefix) {\r\n\treturn this.namespaceResolver.getNamespace(prefix, this.node);\r\n};\r\n\r\n// XPathResult ///////////////////////////////////////////////////////////////\r\n\r\nXPathResult.prototype = {};\r\nXPathResult.prototype.constructor = XPathResult;\r\nXPathResult.superclass = Object.prototype;\r\n\r\nfunction XPathResult(v, t) {\r\n\tif (t == XPathResult.ANY_TYPE) {\r\n\t\tif (v.constructor === XString) {\r\n\t\t\tt = XPathResult.STRING_TYPE;\r\n\t\t} else if (v.constructor === XNumber) {\r\n\t\t\tt = XPathResult.NUMBER_TYPE;\r\n\t\t} else if (v.constructor === XBoolean) {\r\n\t\t\tt = XPathResult.BOOLEAN_TYPE;\r\n\t\t} else if (v.constructor === XNodeSet) {\r\n\t\t\tt = XPathResult.UNORDERED_NODE_ITERATOR_TYPE;\r\n\t\t}\r\n\t}\r\n\tthis.resultType = t;\r\n\tswitch (t) {\r\n\t\tcase XPathResult.NUMBER_TYPE:\r\n\t\t\tthis.numberValue = v.numberValue();\r\n\t\t\treturn;\r\n\t\tcase XPathResult.STRING_TYPE:\r\n\t\t\tthis.stringValue = v.stringValue();\r\n\t\t\treturn;\r\n\t\tcase XPathResult.BOOLEAN_TYPE:\r\n\t\t\tthis.booleanValue = v.booleanValue();\r\n\t\t\treturn;\r\n\t\tcase XPathResult.ANY_UNORDERED_NODE_TYPE:\r\n\t\tcase XPathResult.FIRST_ORDERED_NODE_TYPE:\r\n\t\t\tif (v.constructor === XNodeSet) {\r\n\t\t\t\tthis.singleNodeValue = v.first();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase XPathResult.UNORDERED_NODE_ITERATOR_TYPE:\r\n\t\tcase XPathResult.ORDERED_NODE_ITERATOR_TYPE:\r\n\t\t\tif (v.constructor === XNodeSet) {\r\n\t\t\t\tthis.invalidIteratorState = false;\r\n\t\t\t\tthis.nodes = v.toArray();\r\n\t\t\t\tthis.iteratorIndex = 0;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE:\r\n\t\tcase XPathResult.ORDERED_NODE_SNAPSHOT_TYPE:\r\n\t\t\tif (v.constructor === XNodeSet) {\r\n\t\t\t\tthis.nodes = v.toArray();\r\n\t\t\t\tthis.snapshotLength = this.nodes.length;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t}\r\n\tthrow new XPathException(XPathException.TYPE_ERR);\r\n};\r\n\r\nXPathResult.prototype.iterateNext = function() {\r\n\tif (this.resultType != XPathResult.UNORDERED_NODE_ITERATOR_TYPE\r\n\t\t\t&& this.resultType != XPathResult.ORDERED_NODE_ITERATOR_TYPE) {\r\n\t\tthrow new XPathException(XPathException.TYPE_ERR);\r\n\t}\r\n\treturn this.nodes[this.iteratorIndex++];\r\n};\r\n\r\nXPathResult.prototype.snapshotItem = function(i) {\r\n\tif (this.resultType != XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE\r\n\t\t\t&& this.resultType != XPathResult.ORDERED_NODE_SNAPSHOT_TYPE) {\r\n\t\tthrow new XPathException(XPathException.TYPE_ERR);\r\n\t}\r\n\treturn this.nodes[i];\r\n};\r\n\r\nXPathResult.ANY_TYPE = 0;\r\nXPathResult.NUMBER_TYPE = 1;\r\nXPathResult.STRING_TYPE = 2;\r\nXPathResult.BOOLEAN_TYPE = 3;\r\nXPathResult.UNORDERED_NODE_ITERATOR_TYPE = 4;\r\nXPathResult.ORDERED_NODE_ITERATOR_TYPE = 5;\r\nXPathResult.UNORDERED_NODE_SNAPSHOT_TYPE = 6;\r\nXPathResult.ORDERED_NODE_SNAPSHOT_TYPE = 7;\r\nXPathResult.ANY_UNORDERED_NODE_TYPE = 8;\r\nXPathResult.FIRST_ORDERED_NODE_TYPE = 9;\r\n\r\n// DOM 3 XPath support ///////////////////////////////////////////////////////\r\n\r\nfunction installDOM3XPathSupport(doc, p) {\r\n\tdoc.createExpression = function(e, r) {\r\n\t\ttry {\r\n\t\t\treturn new XPathExpression(e, r, p);\r\n\t\t} catch (e) {\r\n\t\t\tthrow new XPathException(XPathException.INVALID_EXPRESSION_ERR, e);\r\n\t\t}\r\n\t};\r\n\tdoc.createNSResolver = function(n) {\r\n\t\treturn new NodeXPathNSResolver(n);\r\n\t};\r\n\tdoc.evaluate = function(e, cn, r, t, res) {\r\n\t\tif (t < 0 || t > 9) {\r\n\t\t\tthrow { code: 0, toString: function() { return \"Request type not supported\"; } };\r\n\t\t}\r\n        return doc.createExpression(e, r, p).evaluate(cn, t, res);\r\n\t};\r\n};\r\n\r\n// ---------------------------------------------------------------------------\r\n\r\n// Install DOM 3 XPath support for the current document.\r\ntry {\r\n\tvar shouldInstall = true;\r\n\ttry {\r\n\t\tif (document.implementation\r\n\t\t\t\t&& document.implementation.hasFeature\r\n\t\t\t\t&& document.implementation.hasFeature(\"XPath\", null)) {\r\n\t\t\tshouldInstall = false;\r\n\t\t}\r\n\t} catch (e) {\r\n\t}\r\n\tif (shouldInstall) {\r\n\t\tinstallDOM3XPathSupport(document, new XPathParser());\r\n\t}\r\n} catch (e) {\r\n}\r\n\r\n// ---------------------------------------------------------------------------\r\n// exports for node.js\r\n\r\ninstallDOM3XPathSupport(exports, new XPathParser());\r\n\r\n(function() {\r\n    var parser = new XPathParser();\r\n\r\n    var defaultNSResolver = new NamespaceResolver();\r\n    var defaultFunctionResolver = new FunctionResolver();\r\n    var defaultVariableResolver = new VariableResolver();\r\n\r\n    function makeNSResolverFromFunction(func) {\r\n        return {\r\n            getNamespace: function (prefix, node) {\r\n                var ns = func(prefix, node);\r\n\r\n                return ns || defaultNSResolver.getNamespace(prefix, node);\r\n            }\r\n        };\r\n    }\r\n\r\n    function makeNSResolverFromObject(obj) {\r\n        return makeNSResolverFromFunction(obj.getNamespace.bind(obj));\r\n    }\r\n\r\n    function makeNSResolverFromMap(map) {\r\n        return makeNSResolverFromFunction(function (prefix) {\r\n            return map[prefix];\r\n        });\r\n    }\r\n\r\n    function makeNSResolver(resolver) {\r\n        if (resolver && typeof resolver.getNamespace === \"function\") {\r\n            return makeNSResolverFromObject(resolver);\r\n        }\r\n\r\n        if (typeof resolver === \"function\") {\r\n            return makeNSResolverFromFunction(resolver);\r\n        }\r\n\r\n        // assume prefix -> uri mapping\r\n        if (typeof resolver === \"object\") {\r\n            return makeNSResolverFromMap(resolver);\r\n        }\r\n\r\n        return defaultNSResolver;\r\n    }\r\n\r\n    /** Converts native JavaScript types to their XPath library equivalent */\r\n    function convertValue(value) {\r\n        if (value === null ||\r\n            typeof value === \"undefined\" ||\r\n            value instanceof XString ||\r\n            value instanceof XBoolean ||\r\n            value instanceof XNumber ||\r\n            value instanceof XNodeSet) {\r\n            return value;\r\n        }\r\n\r\n        switch (typeof value) {\r\n            case \"string\": return new XString(value);\r\n            case \"boolean\": return new XBoolean(value);\r\n            case \"number\": return new XNumber(value);\r\n        }\r\n\r\n        // assume node(s)\r\n        var ns = new XNodeSet();\r\n        ns.addArray([].concat(value));\r\n        return ns;\r\n    }\r\n\r\n    function makeEvaluator(func) {\r\n        return function (context) {\r\n            var args = Array.prototype.slice.call(arguments, 1).map(function (arg) {\r\n                return arg.evaluate(context);\r\n            });\r\n            var result = func.apply(this, [].concat(context, args));\r\n            return convertValue(result);\r\n        };\r\n    }\r\n\r\n    function makeFunctionResolverFromFunction(func) {\r\n        return {\r\n            getFunction: function (name, namespace) {\r\n                var found = func(name, namespace);\r\n                if (found) {\r\n                    return makeEvaluator(found);\r\n                }\r\n                return defaultFunctionResolver.getFunction(name, namespace);\r\n            }\r\n        };\r\n    }\r\n\r\n    function makeFunctionResolverFromObject(obj) {\r\n        return makeFunctionResolverFromFunction(obj.getFunction.bind(obj));\r\n    }\r\n\r\n    function makeFunctionResolverFromMap(map) {\r\n        return makeFunctionResolverFromFunction(function (name) {\r\n            return map[name];\r\n        });\r\n    }\r\n\r\n    function makeFunctionResolver(resolver) {\r\n        if (resolver && typeof resolver.getFunction === \"function\") {\r\n            return makeFunctionResolverFromObject(resolver);\r\n        }\r\n\r\n        if (typeof resolver === \"function\") {\r\n            return makeFunctionResolverFromFunction(resolver);\r\n        }\r\n\r\n        // assume map\r\n        if (typeof resolver === \"object\") {\r\n            return makeFunctionResolverFromMap(resolver);\r\n        }\r\n\r\n        return defaultFunctionResolver;\r\n    }\r\n\r\n    function makeVariableResolverFromFunction(func) {\r\n        return {\r\n            getVariable: function (name, namespace) {\r\n                var value = func(name, namespace);\r\n                return convertValue(value);\r\n            }\r\n        };\r\n    }\r\n\r\n    function makeVariableResolver(resolver) {\r\n        if (resolver) {\r\n            if (typeof resolver.getVariable === \"function\") {\r\n                return makeVariableResolverFromFunction(resolver.getVariable.bind(resolver));\r\n            }\r\n\r\n            if (typeof resolver === \"function\") {\r\n                return makeVariableResolverFromFunction(resolver);\r\n            }\r\n\r\n            // assume map\r\n            if (typeof resolver === \"object\") {\r\n                return makeVariableResolverFromFunction(function (name) {\r\n                    return resolver[name];\r\n                });\r\n            }\r\n        }\r\n\r\n        return defaultVariableResolver;\r\n    }\r\n\t\r\n\tfunction copyIfPresent(prop, dest, source) {\r\n\t\tif (prop in source) { dest[prop] = source[prop]; }\r\n\t}\r\n\r\n    function makeContext(options) {\r\n        var context = new XPathContext();\r\n\r\n        if (options) {\r\n            context.namespaceResolver = makeNSResolver(options.namespaces);\r\n            context.functionResolver = makeFunctionResolver(options.functions);\r\n            context.variableResolver = makeVariableResolver(options.variables);\r\n\t\t\tcontext.expressionContextNode = options.node;\r\n\t\t\tcopyIfPresent('allowAnyNamespaceForNoPrefix', context, options);\r\n\t\t\tcopyIfPresent('isHtml', context, options);\r\n        } else {\r\n            context.namespaceResolver = defaultNSResolver;\r\n        }\r\n\r\n        return context;\r\n    }\r\n\r\n    function evaluate(parsedExpression, options) {\r\n        var context = makeContext(options);\r\n\r\n        return parsedExpression.evaluate(context);\r\n    }\r\n\r\n    var evaluatorPrototype = {\r\n        evaluate: function (options) {\r\n            return evaluate(this.expression, options);\r\n        }\r\n\r\n        ,evaluateNumber: function (options) {\r\n            return this.evaluate(options).numberValue();\r\n        }\r\n\r\n        ,evaluateString: function (options) {\r\n            return this.evaluate(options).stringValue();\r\n        }\r\n\r\n        ,evaluateBoolean: function (options) {\r\n            return this.evaluate(options).booleanValue();\r\n        }\r\n\r\n        ,evaluateNodeSet: function (options) {\r\n            return this.evaluate(options).nodeset();\r\n        }\r\n\r\n        ,select: function (options) {\r\n            return this.evaluateNodeSet(options).toArray()\r\n        }\r\n\r\n        ,select1: function (options) {\r\n            return this.select(options)[0];\r\n        }\r\n    };\r\n\r\n    function parse(xpath) {\r\n        var parsed = parser.parse(xpath);\r\n\r\n        return Object.create(evaluatorPrototype, {\r\n            expression: {\r\n                value: parsed\r\n            }\r\n        });\r\n    }\r\n\r\n    exports.parse = parse;\r\n})();\r\n\r\nexports.XPath = XPath;\r\nexports.XPathParser = XPathParser;\r\nexports.XPathResult = XPathResult;\r\n\r\nexports.Step = Step;\r\nexports.NodeTest = NodeTest;\r\nexports.BarOperation = BarOperation;\r\n\r\nexports.NamespaceResolver = NamespaceResolver;\r\nexports.FunctionResolver = FunctionResolver;\r\nexports.VariableResolver = VariableResolver;\r\n\r\nexports.Utilities = Utilities;\r\n\r\nexports.XPathContext = XPathContext;\r\nexports.XNodeSet = XNodeSet;\r\nexports.XBoolean = XBoolean;\r\nexports.XString = XString;\r\nexports.XNumber = XNumber;\r\n\r\n// helper\r\nexports.select = function(e, doc, single) {\r\n\treturn exports.selectWithResolver(e, doc, null, single);\r\n};\r\n\r\nexports.useNamespaces = function(mappings) {\r\n\tvar resolver = {\r\n\t\tmappings: mappings || {},\r\n\t\tlookupNamespaceURI: function(prefix) {\r\n\t\t\treturn this.mappings[prefix];\r\n\t\t}\r\n\t};\r\n\r\n\treturn function(e, doc, single) {\r\n\t\treturn exports.selectWithResolver(e, doc, resolver, single);\r\n\t};\r\n};\r\n\r\nexports.selectWithResolver = function(e, doc, resolver, single) {\r\n\tvar expression = new XPathExpression(e, resolver, new XPathParser());\r\n\tvar type = XPathResult.ANY_TYPE;\r\n\r\n\tvar result = expression.evaluate(doc, type, null);\r\n\r\n\tif (result.resultType == XPathResult.STRING_TYPE) {\r\n\t\tresult = result.stringValue;\r\n\t}\r\n\telse if (result.resultType == XPathResult.NUMBER_TYPE) {\r\n\t\tresult = result.numberValue;\r\n\t}\r\n\telse if (result.resultType == XPathResult.BOOLEAN_TYPE) {\r\n\t\tresult = result.booleanValue;\r\n\t}\r\n\telse {\r\n\t\tresult = result.nodes;\r\n\t\tif (single) {\r\n\t\t\tresult = result[0];\r\n\t\t}\r\n\t}\r\n\r\n\treturn result;\r\n};\r\n\r\nexports.select1 = function(e, doc) {\r\n\treturn exports.select(e, doc, true);\r\n};\r\n\r\n// end non-node wrapper\r\n})(xpath);\r\n"]},"metadata":{},"sourceType":"script"}